(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();const eb="modulepreload",tb=function(t){return"/"+t},Nh={},Gi=function(e,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=tb(c),c in Nh)return;Nh[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":eb,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((g,y)=>{m.addEventListener("load",g),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&r(l.reason);return e().catch(r)})};/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function gu(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const qe={},Li=[],Cn=()=>{},nb=()=>!1,il=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),_u=t=>t.startsWith("onUpdate:"),ct=Object.assign,yu=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},sb=Object.prototype.hasOwnProperty,Ue=(t,e)=>sb.call(t,e),he=Array.isArray,$i=t=>wo(t)==="[object Map]",rr=t=>wo(t)==="[object Set]",Mh=t=>wo(t)==="[object Date]",we=t=>typeof t=="function",tt=t=>typeof t=="string",gn=t=>typeof t=="symbol",je=t=>t!==null&&typeof t=="object",tp=t=>(je(t)||we(t))&&we(t.then)&&we(t.catch),np=Object.prototype.toString,wo=t=>np.call(t),ib=t=>wo(t).slice(8,-1),sp=t=>wo(t)==="[object Object]",vu=t=>tt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Ur=gu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),rl=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},rb=/-(\w)/g,cn=rl(t=>t.replace(rb,(e,n)=>n?n.toUpperCase():"")),ob=/\B([A-Z])/g,Us=rl(t=>t.replace(ob,"-$1").toLowerCase()),ol=rl(t=>t.charAt(0).toUpperCase()+t.slice(1)),rc=rl(t=>t?`on${ol(t)}`:""),Rs=(t,e)=>!Object.is(t,e),pa=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Pc=(t,e,n,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:n})},Ra=t=>{const e=parseFloat(t);return isNaN(e)?t:e},ab=t=>{const e=tt(t)?Number(t):NaN;return isNaN(e)?t:e};let xh;const al=()=>xh||(xh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function fn(t){if(he(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],i=tt(s)?db(s):fn(s);if(i)for(const r in i)e[r]=i[r]}return e}else if(tt(t)||je(t))return t}const lb=/;(?![^(]*\))/g,cb=/:([^]+)/,ub=/\/\*[^]*?\*\//g;function db(t){const e={};return t.replace(ub,"").split(lb).forEach(n=>{if(n){const s=n.split(cb);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Se(t){let e="";if(tt(t))e=t;else if(he(t))for(let n=0;n<t.length;n++){const s=Se(t[n]);s&&(e+=s+" ")}else if(je(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const hb="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",fb=gu(hb);function ip(t){return!!t||t===""}function mb(t,e){if(t.length!==e.length)return!1;let n=!0;for(let s=0;n&&s<t.length;s++)n=ci(t[s],e[s]);return n}function ci(t,e){if(t===e)return!0;let n=Mh(t),s=Mh(e);if(n||s)return n&&s?t.getTime()===e.getTime():!1;if(n=gn(t),s=gn(e),n||s)return t===e;if(n=he(t),s=he(e),n||s)return n&&s?mb(t,e):!1;if(n=je(t),s=je(e),n||s){if(!n||!s)return!1;const i=Object.keys(t).length,r=Object.keys(e).length;if(i!==r)return!1;for(const o in t){const l=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(l&&!c||!l&&c||!ci(t[o],e[o]))return!1}}return String(t)===String(e)}function bu(t,e){return t.findIndex(n=>ci(n,e))}const rp=t=>!!(t&&t.__v_isRef===!0),j=t=>tt(t)?t:t==null?"":he(t)||je(t)&&(t.toString===np||!we(t.toString))?rp(t)?j(t.value):JSON.stringify(t,op,2):String(t),op=(t,e)=>rp(e)?op(t,e.value):$i(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,i],r)=>(n[oc(s,r)+" =>"]=i,n),{})}:rr(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>oc(n))}:gn(e)?oc(e):je(e)&&!he(e)&&!sp(e)?String(e):e,oc=(t,e="")=>{var n;return gn(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ot;class ap{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ot,!e&&Ot&&(this.index=(Ot.scopes||(Ot.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Ot;try{return Ot=this,e()}finally{Ot=n}}}on(){++this._on===1&&(this.prevScope=Ot,Ot=this)}off(){this._on>0&&--this._on===0&&(Ot=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function lp(t){return new ap(t)}function cp(){return Ot}function pb(t,e=!1){Ot&&Ot.cleanups.push(t)}let Ke;const ac=new WeakSet;class up{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ot&&Ot.active&&Ot.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,ac.has(this)&&(ac.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||hp(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Vh(this),fp(this);const e=Ke,n=mn;Ke=this,mn=!0;try{return this.fn()}finally{mp(this),Ke=e,mn=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)wu(e);this.deps=this.depsTail=void 0,Vh(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?ac.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Dc(this)&&this.run()}get dirty(){return Dc(this)}}let dp=0,Br,jr;function hp(t,e=!1){if(t.flags|=8,e){t.next=jr,jr=t;return}t.next=Br,Br=t}function Eu(){dp++}function ku(){if(--dp>0)return;if(jr){let e=jr;for(jr=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Br;){let e=Br;for(Br=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=n}}if(t)throw t}function fp(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function mp(t){let e,n=t.depsTail,s=n;for(;s;){const i=s.prevDep;s.version===-1?(s===n&&(n=i),wu(s),gb(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=i}t.deps=e,t.depsTail=n}function Dc(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(pp(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function pp(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===io)||(t.globalVersion=io,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Dc(t))))return;t.flags|=2;const e=t.dep,n=Ke,s=mn;Ke=t,mn=!0;try{fp(t);const i=t.fn(t._value);(e.version===0||Rs(i,t._value))&&(t.flags|=128,t._value=i,e.version++)}catch(i){throw e.version++,i}finally{Ke=n,mn=s,mp(t),t.flags&=-3}}function wu(t,e=!1){const{dep:n,prevSub:s,nextSub:i}=t;if(s&&(s.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=s,t.nextSub=void 0),n.subs===t&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let r=n.computed.deps;r;r=r.nextDep)wu(r,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function gb(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let mn=!0;const gp=[];function Zn(){gp.push(mn),mn=!1}function es(){const t=gp.pop();mn=t===void 0?!0:t}function Vh(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Ke;Ke=void 0;try{e()}finally{Ke=n}}}let io=0;class _b{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Iu{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Ke||!mn||Ke===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Ke)n=this.activeLink=new _b(Ke,this),Ke.deps?(n.prevDep=Ke.depsTail,Ke.depsTail.nextDep=n,Ke.depsTail=n):Ke.deps=Ke.depsTail=n,_p(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=Ke.depsTail,n.nextDep=void 0,Ke.depsTail.nextDep=n,Ke.depsTail=n,Ke.deps===n&&(Ke.deps=s)}return n}trigger(e){this.version++,io++,this.notify(e)}notify(e){Eu();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{ku()}}}function _p(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)_p(s)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Ca=new WeakMap,ii=Symbol(""),Oc=Symbol(""),ro=Symbol("");function Mt(t,e,n){if(mn&&Ke){let s=Ca.get(t);s||Ca.set(t,s=new Map);let i=s.get(n);i||(s.set(n,i=new Iu),i.map=s,i.key=n),i.track()}}function Hn(t,e,n,s,i,r){const o=Ca.get(t);if(!o){io++;return}const l=c=>{c&&c.trigger()};if(Eu(),e==="clear")o.forEach(l);else{const c=he(t),u=c&&vu(n);if(c&&n==="length"){const d=Number(s);o.forEach((m,g)=>{(g==="length"||g===ro||!gn(g)&&g>=d)&&l(m)})}else switch((n!==void 0||o.has(void 0))&&l(o.get(n)),u&&l(o.get(ro)),e){case"add":c?u&&l(o.get("length")):(l(o.get(ii)),$i(t)&&l(o.get(Oc)));break;case"delete":c||(l(o.get(ii)),$i(t)&&l(o.get(Oc)));break;case"set":$i(t)&&l(o.get(ii));break}}ku()}function yb(t,e){const n=Ca.get(t);return n&&n.get(e)}function Ci(t){const e=Pe(t);return e===t?e:(Mt(e,"iterate",ro),on(t)?e:e.map(kt))}function ll(t){return Mt(t=Pe(t),"iterate",ro),t}const vb={__proto__:null,[Symbol.iterator](){return lc(this,Symbol.iterator,kt)},concat(...t){return Ci(this).concat(...t.map(e=>he(e)?Ci(e):e))},entries(){return lc(this,"entries",t=>(t[1]=kt(t[1]),t))},every(t,e){return Un(this,"every",t,e,void 0,arguments)},filter(t,e){return Un(this,"filter",t,e,n=>n.map(kt),arguments)},find(t,e){return Un(this,"find",t,e,kt,arguments)},findIndex(t,e){return Un(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Un(this,"findLast",t,e,kt,arguments)},findLastIndex(t,e){return Un(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Un(this,"forEach",t,e,void 0,arguments)},includes(...t){return cc(this,"includes",t)},indexOf(...t){return cc(this,"indexOf",t)},join(t){return Ci(this).join(t)},lastIndexOf(...t){return cc(this,"lastIndexOf",t)},map(t,e){return Un(this,"map",t,e,void 0,arguments)},pop(){return Cr(this,"pop")},push(...t){return Cr(this,"push",t)},reduce(t,...e){return Lh(this,"reduce",t,e)},reduceRight(t,...e){return Lh(this,"reduceRight",t,e)},shift(){return Cr(this,"shift")},some(t,e){return Un(this,"some",t,e,void 0,arguments)},splice(...t){return Cr(this,"splice",t)},toReversed(){return Ci(this).toReversed()},toSorted(t){return Ci(this).toSorted(t)},toSpliced(...t){return Ci(this).toSpliced(...t)},unshift(...t){return Cr(this,"unshift",t)},values(){return lc(this,"values",kt)}};function lc(t,e,n){const s=ll(t),i=s[e]();return s!==t&&!on(t)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.value&&(r.value=n(r.value)),r}),i}const bb=Array.prototype;function Un(t,e,n,s,i,r){const o=ll(t),l=o!==t&&!on(t),c=o[e];if(c!==bb[e]){const m=c.apply(t,r);return l?kt(m):m}let u=n;o!==t&&(l?u=function(m,g){return n.call(this,kt(m),g,t)}:n.length>2&&(u=function(m,g){return n.call(this,m,g,t)}));const d=c.call(o,u,s);return l&&i?i(d):d}function Lh(t,e,n,s){const i=ll(t);let r=n;return i!==t&&(on(t)?n.length>3&&(r=function(o,l,c){return n.call(this,o,l,c,t)}):r=function(o,l,c){return n.call(this,o,kt(l),c,t)}),i[e](r,...s)}function cc(t,e,n){const s=Pe(t);Mt(s,"iterate",ro);const i=s[e](...n);return(i===-1||i===!1)&&Au(n[0])?(n[0]=Pe(n[0]),s[e](...n)):i}function Cr(t,e,n=[]){Zn(),Eu();const s=Pe(t)[e].apply(t,n);return ku(),es(),s}const Eb=gu("__proto__,__v_isRef,__isVue"),yp=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(gn));function kb(t){gn(t)||(t=String(t));const e=Pe(this);return Mt(e,"has",t),e.hasOwnProperty(t)}class vp{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,s){if(n==="__v_skip")return e.__v_skip;const i=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!i;if(n==="__v_isReadonly")return i;if(n==="__v_isShallow")return r;if(n==="__v_raw")return s===(i?r?Ob:wp:r?kp:Ep).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=he(e);if(!i){let c;if(o&&(c=vb[n]))return c;if(n==="hasOwnProperty")return kb}const l=Reflect.get(e,n,Xe(e)?e:s);return(gn(n)?yp.has(n):Eb(n))||(i||Mt(e,"get",n),r)?l:Xe(l)?o&&vu(n)?l:l.value:je(l)?i?Sp(l):Cs(l):l}}class bp extends vp{constructor(e=!1){super(!1,e)}set(e,n,s,i){let r=e[n];if(!this._isShallow){const c=Ns(r);if(!on(s)&&!Ns(s)&&(r=Pe(r),s=Pe(s)),!he(e)&&Xe(r)&&!Xe(s))return c?!1:(r.value=s,!0)}const o=he(e)&&vu(n)?Number(n)<e.length:Ue(e,n),l=Reflect.set(e,n,s,Xe(e)?e:i);return e===Pe(i)&&(o?Rs(s,r)&&Hn(e,"set",n,s):Hn(e,"add",n,s)),l}deleteProperty(e,n){const s=Ue(e,n);e[n];const i=Reflect.deleteProperty(e,n);return i&&s&&Hn(e,"delete",n,void 0),i}has(e,n){const s=Reflect.has(e,n);return(!gn(n)||!yp.has(n))&&Mt(e,"has",n),s}ownKeys(e){return Mt(e,"iterate",he(e)?"length":ii),Reflect.ownKeys(e)}}class wb extends vp{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const Ib=new bp,Sb=new wb,Tb=new bp(!0);const Nc=t=>t,ia=t=>Reflect.getPrototypeOf(t);function Ab(t,e,n){return function(...s){const i=this.__v_raw,r=Pe(i),o=$i(r),l=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,u=i[t](...s),d=n?Nc:e?Pa:kt;return!e&&Mt(r,"iterate",c?Oc:ii),{next(){const{value:m,done:g}=u.next();return g?{value:m,done:g}:{value:l?[d(m[0]),d(m[1])]:d(m),done:g}},[Symbol.iterator](){return this}}}}function ra(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Rb(t,e){const n={get(i){const r=this.__v_raw,o=Pe(r),l=Pe(i);t||(Rs(i,l)&&Mt(o,"get",i),Mt(o,"get",l));const{has:c}=ia(o),u=e?Nc:t?Pa:kt;if(c.call(o,i))return u(r.get(i));if(c.call(o,l))return u(r.get(l));r!==o&&r.get(i)},get size(){const i=this.__v_raw;return!t&&Mt(Pe(i),"iterate",ii),Reflect.get(i,"size",i)},has(i){const r=this.__v_raw,o=Pe(r),l=Pe(i);return t||(Rs(i,l)&&Mt(o,"has",i),Mt(o,"has",l)),i===l?r.has(i):r.has(i)||r.has(l)},forEach(i,r){const o=this,l=o.__v_raw,c=Pe(l),u=e?Nc:t?Pa:kt;return!t&&Mt(c,"iterate",ii),l.forEach((d,m)=>i.call(r,u(d),u(m),o))}};return ct(n,t?{add:ra("add"),set:ra("set"),delete:ra("delete"),clear:ra("clear")}:{add(i){!e&&!on(i)&&!Ns(i)&&(i=Pe(i));const r=Pe(this);return ia(r).has.call(r,i)||(r.add(i),Hn(r,"add",i,i)),this},set(i,r){!e&&!on(r)&&!Ns(r)&&(r=Pe(r));const o=Pe(this),{has:l,get:c}=ia(o);let u=l.call(o,i);u||(i=Pe(i),u=l.call(o,i));const d=c.call(o,i);return o.set(i,r),u?Rs(r,d)&&Hn(o,"set",i,r):Hn(o,"add",i,r),this},delete(i){const r=Pe(this),{has:o,get:l}=ia(r);let c=o.call(r,i);c||(i=Pe(i),c=o.call(r,i)),l&&l.call(r,i);const u=r.delete(i);return c&&Hn(r,"delete",i,void 0),u},clear(){const i=Pe(this),r=i.size!==0,o=i.clear();return r&&Hn(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=Ab(i,t,e)}),n}function Su(t,e){const n=Rb(t,e);return(s,i,r)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?s:Reflect.get(Ue(n,i)&&i in s?n:s,i,r)}const Cb={get:Su(!1,!1)},Pb={get:Su(!1,!0)},Db={get:Su(!0,!1)};const Ep=new WeakMap,kp=new WeakMap,wp=new WeakMap,Ob=new WeakMap;function Nb(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Mb(t){return t.__v_skip||!Object.isExtensible(t)?0:Nb(ib(t))}function Cs(t){return Ns(t)?t:Tu(t,!1,Ib,Cb,Ep)}function Ip(t){return Tu(t,!1,Tb,Pb,kp)}function Sp(t){return Tu(t,!0,Sb,Db,wp)}function Tu(t,e,n,s,i){if(!je(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=Mb(t);if(r===0)return t;const o=i.get(t);if(o)return o;const l=new Proxy(t,r===2?s:n);return i.set(t,l),l}function Yn(t){return Ns(t)?Yn(t.__v_raw):!!(t&&t.__v_isReactive)}function Ns(t){return!!(t&&t.__v_isReadonly)}function on(t){return!!(t&&t.__v_isShallow)}function Au(t){return t?!!t.__v_raw:!1}function Pe(t){const e=t&&t.__v_raw;return e?Pe(e):t}function Ru(t){return!Ue(t,"__v_skip")&&Object.isExtensible(t)&&Pc(t,"__v_skip",!0),t}const kt=t=>je(t)?Cs(t):t,Pa=t=>je(t)?Sp(t):t;function Xe(t){return t?t.__v_isRef===!0:!1}function ge(t){return Tp(t,!1)}function xb(t){return Tp(t,!0)}function Tp(t,e){return Xe(t)?t:new Vb(t,e)}class Vb{constructor(e,n){this.dep=new Iu,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:Pe(e),this._value=n?e:kt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,s=this.__v_isShallow||on(e)||Ns(e);e=s?e:Pe(e),Rs(e,n)&&(this._rawValue=e,this._value=s?e:kt(e),this.dep.trigger())}}function de(t){return Xe(t)?t.value:t}const Lb={get:(t,e,n)=>e==="__v_raw"?t:de(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const i=t[e];return Xe(i)&&!Xe(n)?(i.value=n,!0):Reflect.set(t,e,n,s)}};function Ap(t){return Yn(t)?t:new Proxy(t,Lb)}function $b(t){const e=he(t)?new Array(t.length):{};for(const n in t)e[n]=Rp(t,n);return e}class Fb{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return yb(Pe(this._object),this._key)}}class Ub{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function Bb(t,e,n){return Xe(t)?t:we(t)?new Ub(t):je(t)&&arguments.length>1?Rp(t,e,n):ge(t)}function Rp(t,e,n){const s=t[e];return Xe(s)?s:new Fb(t,e,n)}class jb{constructor(e,n,s){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Iu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=io-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Ke!==this)return hp(this,!0),!0}get value(){const e=this.dep.track();return pp(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Hb(t,e,n=!1){let s,i;return we(t)?s=t:(s=t.get,i=t.set),new jb(s,i,n)}const oa={},Da=new WeakMap;let Js;function qb(t,e=!1,n=Js){if(n){let s=Da.get(n);s||Da.set(n,s=[]),s.push(t)}}function Kb(t,e,n=qe){const{immediate:s,deep:i,once:r,scheduler:o,augmentJob:l,call:c}=n,u=D=>i?D:on(D)||i===!1||i===0?qn(D,1):qn(D);let d,m,g,y,A=!1,F=!1;if(Xe(t)?(m=()=>t.value,A=on(t)):Yn(t)?(m=()=>u(t),A=!0):he(t)?(F=!0,A=t.some(D=>Yn(D)||on(D)),m=()=>t.map(D=>{if(Xe(D))return D.value;if(Yn(D))return u(D);if(we(D))return c?c(D,2):D()})):we(t)?e?m=c?()=>c(t,2):t:m=()=>{if(g){Zn();try{g()}finally{es()}}const D=Js;Js=d;try{return c?c(t,3,[y]):t(y)}finally{Js=D}}:m=Cn,e&&i){const D=m,P=i===!0?1/0:i;m=()=>qn(D(),P)}const N=cp(),x=()=>{d.stop(),N&&N.active&&yu(N.effects,d)};if(r&&e){const D=e;e=(...P)=>{D(...P),x()}}let V=F?new Array(t.length).fill(oa):oa;const R=D=>{if(!(!(d.flags&1)||!d.dirty&&!D))if(e){const P=d.run();if(i||A||(F?P.some((H,k)=>Rs(H,V[k])):Rs(P,V))){g&&g();const H=Js;Js=d;try{const k=[P,V===oa?void 0:F&&V[0]===oa?[]:V,y];V=P,c?c(e,3,k):e(...k)}finally{Js=H}}}else d.run()};return l&&l(R),d=new up(m),d.scheduler=o?()=>o(R,!1):R,y=D=>qb(D,!1,d),g=d.onStop=()=>{const D=Da.get(d);if(D){if(c)c(D,4);else for(const P of D)P();Da.delete(d)}},e?s?R(!0):V=d.run():o?o(R.bind(null,!0),!0):d.run(),x.pause=d.pause.bind(d),x.resume=d.resume.bind(d),x.stop=x,x}function qn(t,e=1/0,n){if(e<=0||!je(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,Xe(t))qn(t.value,e,n);else if(he(t))for(let s=0;s<t.length;s++)qn(t[s],e,n);else if(rr(t)||$i(t))t.forEach(s=>{qn(s,e,n)});else if(sp(t)){for(const s in t)qn(t[s],e,n);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&qn(t[s],e,n)}return t}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Io(t,e,n,s){try{return s?t(...s):t()}catch(i){cl(i,e,n)}}function _n(t,e,n,s){if(we(t)){const i=Io(t,e,n,s);return i&&tp(i)&&i.catch(r=>{cl(r,e,n)}),i}if(he(t)){const i=[];for(let r=0;r<t.length;r++)i.push(_n(t[r],e,n,s));return i}}function cl(t,e,n,s=!0){const i=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||qe;if(e){let l=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;l;){const d=l.ec;if(d){for(let m=0;m<d.length;m++)if(d[m](t,c,u)===!1)return}l=l.parent}if(r){Zn(),Io(r,null,10,[t,c,u]),es();return}}Gb(t,n,i,s,o)}function Gb(t,e,n,s=!0,i=!1){if(i)throw t;console.error(t)}const Ut=[];let Sn=-1;const Fi=[];let _s=null,Di=0;const Cp=Promise.resolve();let Oa=null;function ul(t){const e=Oa||Cp;return t?e.then(this?t.bind(this):t):e}function zb(t){let e=Sn+1,n=Ut.length;for(;e<n;){const s=e+n>>>1,i=Ut[s],r=oo(i);r<t||r===t&&i.flags&2?e=s+1:n=s}return e}function Cu(t){if(!(t.flags&1)){const e=oo(t),n=Ut[Ut.length-1];!n||!(t.flags&2)&&e>=oo(n)?Ut.push(t):Ut.splice(zb(e),0,t),t.flags|=1,Pp()}}function Pp(){Oa||(Oa=Cp.then(Op))}function Wb(t){he(t)?Fi.push(...t):_s&&t.id===-1?_s.splice(Di+1,0,t):t.flags&1||(Fi.push(t),t.flags|=1),Pp()}function $h(t,e,n=Sn+1){for(;n<Ut.length;n++){const s=Ut[n];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;Ut.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function Dp(t){if(Fi.length){const e=[...new Set(Fi)].sort((n,s)=>oo(n)-oo(s));if(Fi.length=0,_s){_s.push(...e);return}for(_s=e,Di=0;Di<_s.length;Di++){const n=_s[Di];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}_s=null,Di=0}}const oo=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Op(t){try{for(Sn=0;Sn<Ut.length;Sn++){const e=Ut[Sn];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Io(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Sn<Ut.length;Sn++){const e=Ut[Sn];e&&(e.flags&=-2)}Sn=-1,Ut.length=0,Dp(),Oa=null,(Ut.length||Fi.length)&&Op()}}let lt=null,Np=null;function Na(t){const e=lt;return lt=t,Np=t&&t.type.__scopeId||null,e}function Ht(t,e=lt,n){if(!e||t._n)return t;const s=(...i)=>{s._d&&Qh(-1);const r=Na(e);let o;try{o=t(...i)}finally{Na(r),s._d&&Qh(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function nt(t,e){if(lt===null)return t;const n=gl(lt),s=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[r,o,l,c=qe]=e[i];r&&(we(r)&&(r={mounted:r,updated:r}),r.deep&&qn(o),s.push({dir:r,instance:n,value:o,oldValue:void 0,arg:l,modifiers:c}))}return t}function Ws(t,e,n,s){const i=t.dirs,r=e&&e.dirs;for(let o=0;o<i.length;o++){const l=i[o];r&&(l.oldValue=r[o].value);let c=l.dir[s];c&&(Zn(),_n(c,n,8,[t.el,l,t,e]),es())}}const Qb=Symbol("_vte"),Mp=t=>t.__isTeleport,ys=Symbol("_leaveCb"),aa=Symbol("_enterCb");function xp(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return En(()=>{t.isMounted=!0}),qp(()=>{t.isUnmounting=!0}),t}const rn=[Function,Array],Vp={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:rn,onEnter:rn,onAfterEnter:rn,onEnterCancelled:rn,onBeforeLeave:rn,onLeave:rn,onAfterLeave:rn,onLeaveCancelled:rn,onBeforeAppear:rn,onAppear:rn,onAfterAppear:rn,onAppearCancelled:rn},Lp=t=>{const e=t.subTree;return e.component?Lp(e.component):e},Yb={name:"BaseTransition",props:Vp,setup(t,{slots:e}){const n=pg(),s=xp();return()=>{const i=e.default&&Pu(e.default(),!0);if(!i||!i.length)return;const r=$p(i),o=Pe(t),{mode:l}=o;if(s.isLeaving)return uc(r);const c=Fh(r);if(!c)return uc(r);let u=ao(c,o,s,n,m=>u=m);c.type!==xt&&ui(c,u);let d=n.subTree&&Fh(n.subTree);if(d&&d.type!==xt&&!Zs(c,d)&&Lp(n).type!==xt){let m=ao(d,o,s,n);if(ui(d,m),l==="out-in"&&c.type!==xt)return s.isLeaving=!0,m.afterLeave=()=>{s.isLeaving=!1,n.job.flags&8||n.update(),delete m.afterLeave,d=void 0},uc(r);l==="in-out"&&c.type!==xt?m.delayLeave=(g,y,A)=>{const F=Fp(s,d);F[String(d.key)]=d,g[ys]=()=>{y(),g[ys]=void 0,delete u.delayedLeave,d=void 0},u.delayedLeave=()=>{A(),delete u.delayedLeave,d=void 0}}:d=void 0}else d&&(d=void 0);return r}}};function $p(t){let e=t[0];if(t.length>1){for(const n of t)if(n.type!==xt){e=n;break}}return e}const Jb=Yb;function Fp(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function ao(t,e,n,s,i){const{appear:r,mode:o,persisted:l=!1,onBeforeEnter:c,onEnter:u,onAfterEnter:d,onEnterCancelled:m,onBeforeLeave:g,onLeave:y,onAfterLeave:A,onLeaveCancelled:F,onBeforeAppear:N,onAppear:x,onAfterAppear:V,onAppearCancelled:R}=e,D=String(t.key),P=Fp(n,t),H=(E,S)=>{E&&_n(E,s,9,S)},k=(E,S)=>{const C=S[1];H(E,S),he(E)?E.every(w=>w.length<=1)&&C():E.length<=1&&C()},b={mode:o,persisted:l,beforeEnter(E){let S=c;if(!n.isMounted)if(r)S=N||c;else return;E[ys]&&E[ys](!0);const C=P[D];C&&Zs(t,C)&&C.el[ys]&&C.el[ys](),H(S,[E])},enter(E){let S=u,C=d,w=m;if(!n.isMounted)if(r)S=x||u,C=V||d,w=R||m;else return;let _=!1;const Te=E[aa]=ae=>{_||(_=!0,ae?H(w,[E]):H(C,[E]),b.delayedLeave&&b.delayedLeave(),E[aa]=void 0)};S?k(S,[E,Te]):Te()},leave(E,S){const C=String(t.key);if(E[aa]&&E[aa](!0),n.isUnmounting)return S();H(g,[E]);let w=!1;const _=E[ys]=Te=>{w||(w=!0,S(),Te?H(F,[E]):H(A,[E]),E[ys]=void 0,P[C]===t&&delete P[C])};P[C]=t,y?k(y,[E,_]):_()},clone(E){const S=ao(E,e,n,s,i);return i&&i(S),S}};return b}function uc(t){if(dl(t))return t=Ms(t),t.children=null,t}function Fh(t){if(!dl(t))return Mp(t.type)&&t.children?$p(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:n}=t;if(n){if(e&16)return n[0];if(e&32&&we(n.default))return n.default()}}function ui(t,e){t.shapeFlag&6&&t.component?(t.transition=e,ui(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Pu(t,e=!1,n){let s=[],i=0;for(let r=0;r<t.length;r++){let o=t[r];const l=n==null?o.key:String(n)+String(o.key!=null?o.key:r);o.type===Ae?(o.patchFlag&128&&i++,s=s.concat(Pu(o.children,e,l))):(e||o.type!==xt)&&s.push(l!=null?Ms(o,{key:l}):o)}if(i>1)for(let r=0;r<s.length;r++)s[r].patchFlag=-2;return s}/*! #__NO_SIDE_EFFECTS__ */function Up(t,e){return we(t)?ct({name:t.name},e,{setup:t}):t}function Bp(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Hr(t,e,n,s,i=!1){if(he(t)){t.forEach((A,F)=>Hr(A,e&&(he(e)?e[F]:e),n,s,i));return}if(Ui(s)&&!i){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Hr(t,e,n,s.component.subTree);return}const r=s.shapeFlag&4?gl(s.component):s.el,o=i?null:r,{i:l,r:c}=t,u=e&&e.r,d=l.refs===qe?l.refs={}:l.refs,m=l.setupState,g=Pe(m),y=m===qe?()=>!1:A=>Ue(g,A);if(u!=null&&u!==c&&(tt(u)?(d[u]=null,y(u)&&(m[u]=null)):Xe(u)&&(u.value=null)),we(c))Io(c,l,12,[o,d]);else{const A=tt(c),F=Xe(c);if(A||F){const N=()=>{if(t.f){const x=A?y(c)?m[c]:d[c]:c.value;i?he(x)&&yu(x,r):he(x)?x.includes(r)||x.push(r):A?(d[c]=[r],y(c)&&(m[c]=d[c])):(c.value=[r],t.k&&(d[t.k]=c.value))}else A?(d[c]=o,y(c)&&(m[c]=o)):F&&(c.value=o,t.k&&(d[t.k]=o))};o?(N.id=-1,Xt(N,n)):N()}}}al().requestIdleCallback;al().cancelIdleCallback;const Ui=t=>!!t.type.__asyncLoader,dl=t=>t.type.__isKeepAlive;function Xb(t,e){jp(t,"a",e)}function Zb(t,e){jp(t,"da",e)}function jp(t,e,n=ft){const s=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(hl(e,s,n),n){let i=n.parent;for(;i&&i.parent;)dl(i.parent.vnode)&&eE(s,e,n,i),i=i.parent}}function eE(t,e,n,s){const i=hl(e,t,s,!0);So(()=>{yu(s[e],i)},n)}function hl(t,e,n=ft,s=!1){if(n){const i=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{Zn();const l=To(n),c=_n(e,n,t,o);return l(),es(),c});return s?i.unshift(r):i.push(r),r}}const is=t=>(e,n=ft)=>{(!uo||t==="sp")&&hl(t,(...s)=>e(...s),n)},tE=is("bm"),En=is("m"),nE=is("bu"),Hp=is("u"),qp=is("bum"),So=is("um"),sE=is("sp"),iE=is("rtg"),rE=is("rtc");function oE(t,e=ft){hl("ec",t,e)}const Kp="components";function fl(t,e){return zp(Kp,t,!0,e)||t}const Gp=Symbol.for("v-ndc");function aE(t){return tt(t)?zp(Kp,t,!1)||t:t||Gp}function zp(t,e,n=!0,s=!1){const i=lt||ft;if(i){const r=i.type;{const l=WE(r,!1);if(l&&(l===e||l===cn(e)||l===ol(cn(e))))return r}const o=Uh(i[t]||r[t],e)||Uh(i.appContext[t],e);return!o&&s?r:o}}function Uh(t,e){return t&&(t[e]||t[cn(e)]||t[ol(cn(e))])}function ze(t,e,n,s){let i;const r=n,o=he(t);if(o||tt(t)){const l=o&&Yn(t);let c=!1,u=!1;l&&(c=!on(t),u=Ns(t),t=ll(t)),i=new Array(t.length);for(let d=0,m=t.length;d<m;d++)i[d]=e(c?u?Pa(kt(t[d])):kt(t[d]):t[d],d,void 0,r)}else if(typeof t=="number"){i=new Array(t);for(let l=0;l<t;l++)i[l]=e(l+1,l,void 0,r)}else if(je(t))if(t[Symbol.iterator])i=Array.from(t,(l,c)=>e(l,c,void 0,r));else{const l=Object.keys(t);i=new Array(l.length);for(let c=0,u=l.length;c<u;c++){const d=l[c];i[c]=e(t[d],d,c,r)}}else i=[];return i}function Wp(t,e,n={},s,i){if(lt.ce||lt.parent&&Ui(lt.parent)&&lt.parent.ce)return O(),Wt(Ae,null,[xe("slot",n,s)],64);let r=t[e];r&&r._c&&(r._d=!1),O();const o=r&&Qp(r(n)),l=n.key||o&&o.key,c=Wt(Ae,{key:(l&&!gn(l)?l:`_${e}`)+""},o||[],o&&t._===1?64:-2);return r&&r._c&&(r._d=!0),c}function Qp(t){return t.some(e=>co(e)?!(e.type===xt||e.type===Ae&&!Qp(e.children)):!0)?t:null}const Mc=t=>t?gg(t)?gl(t):Mc(t.parent):null,qr=ct(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Mc(t.parent),$root:t=>Mc(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Jp(t),$forceUpdate:t=>t.f||(t.f=()=>{Cu(t.update)}),$nextTick:t=>t.n||(t.n=ul.bind(t.proxy)),$watch:t=>CE.bind(t)}),dc=(t,e)=>t!==qe&&!t.__isScriptSetup&&Ue(t,e),lE={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:s,data:i,props:r,accessCache:o,type:l,appContext:c}=t;let u;if(e[0]!=="$"){const y=o[e];if(y!==void 0)switch(y){case 1:return s[e];case 2:return i[e];case 4:return n[e];case 3:return r[e]}else{if(dc(s,e))return o[e]=1,s[e];if(i!==qe&&Ue(i,e))return o[e]=2,i[e];if((u=t.propsOptions[0])&&Ue(u,e))return o[e]=3,r[e];if(n!==qe&&Ue(n,e))return o[e]=4,n[e];xc&&(o[e]=0)}}const d=qr[e];let m,g;if(d)return e==="$attrs"&&Mt(t.attrs,"get",""),d(t);if((m=l.__cssModules)&&(m=m[e]))return m;if(n!==qe&&Ue(n,e))return o[e]=4,n[e];if(g=c.config.globalProperties,Ue(g,e))return g[e]},set({_:t},e,n){const{data:s,setupState:i,ctx:r}=t;return dc(i,e)?(i[e]=n,!0):s!==qe&&Ue(s,e)?(s[e]=n,!0):Ue(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:i,propsOptions:r}},o){let l;return!!n[o]||t!==qe&&Ue(t,o)||dc(e,o)||(l=r[0])&&Ue(l,o)||Ue(s,o)||Ue(qr,o)||Ue(i.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Ue(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Bh(t){return he(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let xc=!0;function cE(t){const e=Jp(t),n=t.proxy,s=t.ctx;xc=!1,e.beforeCreate&&jh(e.beforeCreate,t,"bc");const{data:i,computed:r,methods:o,watch:l,provide:c,inject:u,created:d,beforeMount:m,mounted:g,beforeUpdate:y,updated:A,activated:F,deactivated:N,beforeDestroy:x,beforeUnmount:V,destroyed:R,unmounted:D,render:P,renderTracked:H,renderTriggered:k,errorCaptured:b,serverPrefetch:E,expose:S,inheritAttrs:C,components:w,directives:_,filters:Te}=e;if(u&&uE(u,s,null),o)for(const _e in o){const le=o[_e];we(le)&&(s[_e]=le.bind(n))}if(i){const _e=i.call(n,n);je(_e)&&(t.data=Cs(_e))}if(xc=!0,r)for(const _e in r){const le=r[_e],Vt=we(le)?le.bind(n,n):we(le.get)?le.get.bind(n,n):Cn,Yt=!we(le)&&we(le.set)?le.set.bind(n):Cn,Gt=Ie({get:Vt,set:Yt});Object.defineProperty(s,_e,{enumerable:!0,configurable:!0,get:()=>Gt.value,set:We=>Gt.value=We})}if(l)for(const _e in l)Yp(l[_e],s,n,_e);if(c){const _e=we(c)?c.call(n):c;Reflect.ownKeys(_e).forEach(le=>{ga(le,_e[le])})}d&&jh(d,t,"c");function Ce(_e,le){he(le)?le.forEach(Vt=>_e(Vt.bind(n))):le&&_e(le.bind(n))}if(Ce(tE,m),Ce(En,g),Ce(nE,y),Ce(Hp,A),Ce(Xb,F),Ce(Zb,N),Ce(oE,b),Ce(rE,H),Ce(iE,k),Ce(qp,V),Ce(So,D),Ce(sE,E),he(S))if(S.length){const _e=t.exposed||(t.exposed={});S.forEach(le=>{Object.defineProperty(_e,le,{get:()=>n[le],set:Vt=>n[le]=Vt})})}else t.exposed||(t.exposed={});P&&t.render===Cn&&(t.render=P),C!=null&&(t.inheritAttrs=C),w&&(t.components=w),_&&(t.directives=_),E&&Bp(t)}function uE(t,e,n=Cn){he(t)&&(t=Vc(t));for(const s in t){const i=t[s];let r;je(i)?"default"in i?r=an(i.from||s,i.default,!0):r=an(i.from||s):r=an(i),Xe(r)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[s]=r}}function jh(t,e,n){_n(he(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function Yp(t,e,n,s){let i=s.includes(".")?ug(n,s):()=>n[s];if(tt(t)){const r=e[t];we(r)&&Pn(i,r)}else if(we(t))Pn(i,t.bind(n));else if(je(t))if(he(t))t.forEach(r=>Yp(r,e,n,s));else{const r=we(t.handler)?t.handler.bind(n):e[t.handler];we(r)&&Pn(i,r,t)}}function Jp(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,l=r.get(e);let c;return l?c=l:!i.length&&!n&&!s?c=e:(c={},i.length&&i.forEach(u=>Ma(c,u,o,!0)),Ma(c,e,o)),je(e)&&r.set(e,c),c}function Ma(t,e,n,s=!1){const{mixins:i,extends:r}=e;r&&Ma(t,r,n,!0),i&&i.forEach(o=>Ma(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const l=dE[o]||n&&n[o];t[o]=l?l(t[o],e[o]):e[o]}return t}const dE={data:Hh,props:qh,emits:qh,methods:Mr,computed:Mr,beforeCreate:$t,created:$t,beforeMount:$t,mounted:$t,beforeUpdate:$t,updated:$t,beforeDestroy:$t,beforeUnmount:$t,destroyed:$t,unmounted:$t,activated:$t,deactivated:$t,errorCaptured:$t,serverPrefetch:$t,components:Mr,directives:Mr,watch:fE,provide:Hh,inject:hE};function Hh(t,e){return e?t?function(){return ct(we(t)?t.call(this,this):t,we(e)?e.call(this,this):e)}:e:t}function hE(t,e){return Mr(Vc(t),Vc(e))}function Vc(t){if(he(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function $t(t,e){return t?[...new Set([].concat(t,e))]:e}function Mr(t,e){return t?ct(Object.create(null),t,e):e}function qh(t,e){return t?he(t)&&he(e)?[...new Set([...t,...e])]:ct(Object.create(null),Bh(t),Bh(e??{})):e}function fE(t,e){if(!t)return e;if(!e)return t;const n=ct(Object.create(null),t);for(const s in e)n[s]=$t(t[s],e[s]);return n}function Xp(){return{app:null,config:{isNativeTag:nb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let mE=0;function pE(t,e){return function(s,i=null){we(s)||(s=ct({},s)),i!=null&&!je(i)&&(i=null);const r=Xp(),o=new WeakSet,l=[];let c=!1;const u=r.app={_uid:mE++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:YE,get config(){return r.config},set config(d){},use(d,...m){return o.has(d)||(d&&we(d.install)?(o.add(d),d.install(u,...m)):we(d)&&(o.add(d),d(u,...m))),u},mixin(d){return r.mixins.includes(d)||r.mixins.push(d),u},component(d,m){return m?(r.components[d]=m,u):r.components[d]},directive(d,m){return m?(r.directives[d]=m,u):r.directives[d]},mount(d,m,g){if(!c){const y=u._ceVNode||xe(s,i);return y.appContext=r,g===!0?g="svg":g===!1&&(g=void 0),t(y,d,g),c=!0,u._container=d,d.__vue_app__=u,gl(y.component)}},onUnmount(d){l.push(d)},unmount(){c&&(_n(l,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(d,m){return r.provides[d]=m,u},runWithContext(d){const m=ri;ri=u;try{return d()}finally{ri=m}}};return u}}let ri=null;function ga(t,e){if(ft){let n=ft.provides;const s=ft.parent&&ft.parent.provides;s===n&&(n=ft.provides=Object.create(s)),n[t]=e}}function an(t,e,n=!1){const s=ft||lt;if(s||ri){let i=ri?ri._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return n&&we(e)?e.call(s&&s.proxy):e}}function gE(){return!!(ft||lt||ri)}const Zp={},eg=()=>Object.create(Zp),tg=t=>Object.getPrototypeOf(t)===Zp;function _E(t,e,n,s=!1){const i={},r=eg();t.propsDefaults=Object.create(null),ng(t,e,i,r);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=s?i:Ip(i):t.type.props?t.props=i:t.props=r,t.attrs=r}function yE(t,e,n,s){const{props:i,attrs:r,vnode:{patchFlag:o}}=t,l=Pe(i),[c]=t.propsOptions;let u=!1;if((s||o>0)&&!(o&16)){if(o&8){const d=t.vnode.dynamicProps;for(let m=0;m<d.length;m++){let g=d[m];if(ml(t.emitsOptions,g))continue;const y=e[g];if(c)if(Ue(r,g))y!==r[g]&&(r[g]=y,u=!0);else{const A=cn(g);i[A]=Lc(c,l,A,y,t,!1)}else y!==r[g]&&(r[g]=y,u=!0)}}}else{ng(t,e,i,r)&&(u=!0);let d;for(const m in l)(!e||!Ue(e,m)&&((d=Us(m))===m||!Ue(e,d)))&&(c?n&&(n[m]!==void 0||n[d]!==void 0)&&(i[m]=Lc(c,l,m,void 0,t,!0)):delete i[m]);if(r!==l)for(const m in r)(!e||!Ue(e,m))&&(delete r[m],u=!0)}u&&Hn(t.attrs,"set","")}function ng(t,e,n,s){const[i,r]=t.propsOptions;let o=!1,l;if(e)for(let c in e){if(Ur(c))continue;const u=e[c];let d;i&&Ue(i,d=cn(c))?!r||!r.includes(d)?n[d]=u:(l||(l={}))[d]=u:ml(t.emitsOptions,c)||(!(c in s)||u!==s[c])&&(s[c]=u,o=!0)}if(r){const c=Pe(n),u=l||qe;for(let d=0;d<r.length;d++){const m=r[d];n[m]=Lc(i,c,m,u[m],t,!Ue(u,m))}}return o}function Lc(t,e,n,s,i,r){const o=t[n];if(o!=null){const l=Ue(o,"default");if(l&&s===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&we(c)){const{propsDefaults:u}=i;if(n in u)s=u[n];else{const d=To(i);s=u[n]=c.call(null,e),d()}}else s=c;i.ce&&i.ce._setProp(n,s)}o[0]&&(r&&!l?s=!1:o[1]&&(s===""||s===Us(n))&&(s=!0))}return s}const vE=new WeakMap;function sg(t,e,n=!1){const s=n?vE:e.propsCache,i=s.get(t);if(i)return i;const r=t.props,o={},l=[];let c=!1;if(!we(t)){const d=m=>{c=!0;const[g,y]=sg(m,e,!0);ct(o,g),y&&l.push(...y)};!n&&e.mixins.length&&e.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}if(!r&&!c)return je(t)&&s.set(t,Li),Li;if(he(r))for(let d=0;d<r.length;d++){const m=cn(r[d]);Kh(m)&&(o[m]=qe)}else if(r)for(const d in r){const m=cn(d);if(Kh(m)){const g=r[d],y=o[m]=he(g)||we(g)?{type:g}:ct({},g),A=y.type;let F=!1,N=!0;if(he(A))for(let x=0;x<A.length;++x){const V=A[x],R=we(V)&&V.name;if(R==="Boolean"){F=!0;break}else R==="String"&&(N=!1)}else F=we(A)&&A.name==="Boolean";y[0]=F,y[1]=N,(F||Ue(y,"default"))&&l.push(m)}}const u=[o,l];return je(t)&&s.set(t,u),u}function Kh(t){return t[0]!=="$"&&!Ur(t)}const Du=t=>t[0]==="_"||t==="$stable",Ou=t=>he(t)?t.map(Tn):[Tn(t)],bE=(t,e,n)=>{if(e._n)return e;const s=Ht((...i)=>Ou(e(...i)),n);return s._c=!1,s},ig=(t,e,n)=>{const s=t._ctx;for(const i in t){if(Du(i))continue;const r=t[i];if(we(r))e[i]=bE(i,r,s);else if(r!=null){const o=Ou(r);e[i]=()=>o}}},rg=(t,e)=>{const n=Ou(e);t.slots.default=()=>n},og=(t,e,n)=>{for(const s in e)(n||!Du(s))&&(t[s]=e[s])},EE=(t,e,n)=>{const s=t.slots=eg();if(t.vnode.shapeFlag&32){const i=e.__;i&&Pc(s,"__",i,!0);const r=e._;r?(og(s,e,n),n&&Pc(s,"_",r,!0)):ig(e,s)}else e&&rg(t,e)},kE=(t,e,n)=>{const{vnode:s,slots:i}=t;let r=!0,o=qe;if(s.shapeFlag&32){const l=e._;l?n&&l===1?r=!1:og(i,e,n):(r=!e.$stable,ig(e,i)),o=e}else e&&(rg(t,e),o={default:1});if(r)for(const l in i)!Du(l)&&o[l]==null&&delete i[l]},Xt=VE;function wE(t){return IE(t)}function IE(t,e){const n=al();n.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:o,createText:l,createComment:c,setText:u,setElementText:d,parentNode:m,nextSibling:g,setScopeId:y=Cn,insertStaticContent:A}=t,F=(I,T,$,z=null,Q=null,W=null,te=void 0,Z=null,B=!!T.dynamicChildren)=>{if(I===T)return;I&&!Zs(I,T)&&(z=G(I),We(I,Q,W,!0),I=null),T.patchFlag===-2&&(B=!1,T.dynamicChildren=null);const{type:L,ref:oe,shapeFlag:K}=T;switch(L){case pl:N(I,T,$,z);break;case xt:x(I,T,$,z);break;case _a:I==null&&V(T,$,z,te);break;case Ae:w(I,T,$,z,Q,W,te,Z,B);break;default:K&1?P(I,T,$,z,Q,W,te,Z,B):K&6?_(I,T,$,z,Q,W,te,Z,B):(K&64||K&128)&&L.process(I,T,$,z,Q,W,te,Z,B,ce)}oe!=null&&Q?Hr(oe,I&&I.ref,W,T||I,!T):oe==null&&I&&I.ref!=null&&Hr(I.ref,null,W,I,!0)},N=(I,T,$,z)=>{if(I==null)s(T.el=l(T.children),$,z);else{const Q=T.el=I.el;T.children!==I.children&&u(Q,T.children)}},x=(I,T,$,z)=>{I==null?s(T.el=c(T.children||""),$,z):T.el=I.el},V=(I,T,$,z)=>{[I.el,I.anchor]=A(I.children,T,$,z,I.el,I.anchor)},R=({el:I,anchor:T},$,z)=>{let Q;for(;I&&I!==T;)Q=g(I),s(I,$,z),I=Q;s(T,$,z)},D=({el:I,anchor:T})=>{let $;for(;I&&I!==T;)$=g(I),i(I),I=$;i(T)},P=(I,T,$,z,Q,W,te,Z,B)=>{T.type==="svg"?te="svg":T.type==="math"&&(te="mathml"),I==null?H(T,$,z,Q,W,te,Z,B):E(I,T,Q,W,te,Z,B)},H=(I,T,$,z,Q,W,te,Z)=>{let B,L;const{props:oe,shapeFlag:K,transition:re,dirs:pe}=I;if(B=I.el=o(I.type,W,oe&&oe.is,oe),K&8?d(B,I.children):K&16&&b(I.children,B,null,z,Q,hc(I,W),te,Z),pe&&Ws(I,null,z,"created"),k(B,I,I.scopeId,te,z),oe){for(const ve in oe)ve!=="value"&&!Ur(ve)&&r(B,ve,null,oe[ve],W,z);"value"in oe&&r(B,"value",null,oe.value,W),(L=oe.onVnodeBeforeMount)&&wn(L,z,I)}pe&&Ws(I,null,z,"beforeMount");const fe=SE(Q,re);fe&&re.beforeEnter(B),s(B,T,$),((L=oe&&oe.onVnodeMounted)||fe||pe)&&Xt(()=>{L&&wn(L,z,I),fe&&re.enter(B),pe&&Ws(I,null,z,"mounted")},Q)},k=(I,T,$,z,Q)=>{if($&&y(I,$),z)for(let W=0;W<z.length;W++)y(I,z[W]);if(Q){let W=Q.subTree;if(T===W||hg(W.type)&&(W.ssContent===T||W.ssFallback===T)){const te=Q.vnode;k(I,te,te.scopeId,te.slotScopeIds,Q.parent)}}},b=(I,T,$,z,Q,W,te,Z,B=0)=>{for(let L=B;L<I.length;L++){const oe=I[L]=Z?vs(I[L]):Tn(I[L]);F(null,oe,T,$,z,Q,W,te,Z)}},E=(I,T,$,z,Q,W,te)=>{const Z=T.el=I.el;let{patchFlag:B,dynamicChildren:L,dirs:oe}=T;B|=I.patchFlag&16;const K=I.props||qe,re=T.props||qe;let pe;if($&&Qs($,!1),(pe=re.onVnodeBeforeUpdate)&&wn(pe,$,T,I),oe&&Ws(T,I,$,"beforeUpdate"),$&&Qs($,!0),(K.innerHTML&&re.innerHTML==null||K.textContent&&re.textContent==null)&&d(Z,""),L?S(I.dynamicChildren,L,Z,$,z,hc(T,Q),W):te||le(I,T,Z,null,$,z,hc(T,Q),W,!1),B>0){if(B&16)C(Z,K,re,$,Q);else if(B&2&&K.class!==re.class&&r(Z,"class",null,re.class,Q),B&4&&r(Z,"style",K.style,re.style,Q),B&8){const fe=T.dynamicProps;for(let ve=0;ve<fe.length;ve++){const Ne=fe[ve],_t=K[Ne],yt=re[Ne];(yt!==_t||Ne==="value")&&r(Z,Ne,_t,yt,Q,$)}}B&1&&I.children!==T.children&&d(Z,T.children)}else!te&&L==null&&C(Z,K,re,$,Q);((pe=re.onVnodeUpdated)||oe)&&Xt(()=>{pe&&wn(pe,$,T,I),oe&&Ws(T,I,$,"updated")},z)},S=(I,T,$,z,Q,W,te)=>{for(let Z=0;Z<T.length;Z++){const B=I[Z],L=T[Z],oe=B.el&&(B.type===Ae||!Zs(B,L)||B.shapeFlag&198)?m(B.el):$;F(B,L,oe,null,z,Q,W,te,!0)}},C=(I,T,$,z,Q)=>{if(T!==$){if(T!==qe)for(const W in T)!Ur(W)&&!(W in $)&&r(I,W,T[W],null,Q,z);for(const W in $){if(Ur(W))continue;const te=$[W],Z=T[W];te!==Z&&W!=="value"&&r(I,W,Z,te,Q,z)}"value"in $&&r(I,"value",T.value,$.value,Q)}},w=(I,T,$,z,Q,W,te,Z,B)=>{const L=T.el=I?I.el:l(""),oe=T.anchor=I?I.anchor:l("");let{patchFlag:K,dynamicChildren:re,slotScopeIds:pe}=T;pe&&(Z=Z?Z.concat(pe):pe),I==null?(s(L,$,z),s(oe,$,z),b(T.children||[],$,oe,Q,W,te,Z,B)):K>0&&K&64&&re&&I.dynamicChildren?(S(I.dynamicChildren,re,$,Q,W,te,Z),(T.key!=null||Q&&T===Q.subTree)&&ag(I,T,!0)):le(I,T,$,oe,Q,W,te,Z,B)},_=(I,T,$,z,Q,W,te,Z,B)=>{T.slotScopeIds=Z,I==null?T.shapeFlag&512?Q.ctx.activate(T,$,z,te,B):Te(T,$,z,Q,W,te,B):ae(I,T,B)},Te=(I,T,$,z,Q,W,te)=>{const Z=I.component=HE(I,z,Q);if(dl(I)&&(Z.ctx.renderer=ce),qE(Z,!1,te),Z.asyncDep){if(Q&&Q.registerDep(Z,Ce,te),!I.el){const B=Z.subTree=xe(xt);x(null,B,T,$)}}else Ce(Z,I,T,$,Q,W,te)},ae=(I,T,$)=>{const z=T.component=I.component;if(ME(I,T,$))if(z.asyncDep&&!z.asyncResolved){_e(z,T,$);return}else z.next=T,z.update();else T.el=I.el,z.vnode=T},Ce=(I,T,$,z,Q,W,te)=>{const Z=()=>{if(I.isMounted){let{next:K,bu:re,u:pe,parent:fe,vnode:ve}=I;{const At=lg(I);if(At){K&&(K.el=ve.el,_e(I,K,te)),At.asyncDep.then(()=>{I.isUnmounted||Z()});return}}let Ne=K,_t;Qs(I,!1),K?(K.el=ve.el,_e(I,K,te)):K=ve,re&&pa(re),(_t=K.props&&K.props.onVnodeBeforeUpdate)&&wn(_t,fe,K,ve),Qs(I,!0);const yt=zh(I),nn=I.subTree;I.subTree=yt,F(nn,yt,m(nn.el),G(nn),I,Q,W),K.el=yt.el,Ne===null&&xE(I,yt.el),pe&&Xt(pe,Q),(_t=K.props&&K.props.onVnodeUpdated)&&Xt(()=>wn(_t,fe,K,ve),Q)}else{let K;const{el:re,props:pe}=T,{bm:fe,m:ve,parent:Ne,root:_t,type:yt}=I,nn=Ui(T);Qs(I,!1),fe&&pa(fe),!nn&&(K=pe&&pe.onVnodeBeforeMount)&&wn(K,Ne,T),Qs(I,!0);{_t.ce&&_t.ce._def.shadowRoot!==!1&&_t.ce._injectChildStyle(yt);const At=I.subTree=zh(I);F(null,At,$,z,I,Q,W),T.el=At.el}if(ve&&Xt(ve,Q),!nn&&(K=pe&&pe.onVnodeMounted)){const At=T;Xt(()=>wn(K,Ne,At),Q)}(T.shapeFlag&256||Ne&&Ui(Ne.vnode)&&Ne.vnode.shapeFlag&256)&&I.a&&Xt(I.a,Q),I.isMounted=!0,T=$=z=null}};I.scope.on();const B=I.effect=new up(Z);I.scope.off();const L=I.update=B.run.bind(B),oe=I.job=B.runIfDirty.bind(B);oe.i=I,oe.id=I.uid,B.scheduler=()=>Cu(oe),Qs(I,!0),L()},_e=(I,T,$)=>{T.component=I;const z=I.vnode.props;I.vnode=T,I.next=null,yE(I,T.props,z,$),kE(I,T.children,$),Zn(),$h(I),es()},le=(I,T,$,z,Q,W,te,Z,B=!1)=>{const L=I&&I.children,oe=I?I.shapeFlag:0,K=T.children,{patchFlag:re,shapeFlag:pe}=T;if(re>0){if(re&128){Yt(L,K,$,z,Q,W,te,Z,B);return}else if(re&256){Vt(L,K,$,z,Q,W,te,Z,B);return}}pe&8?(oe&16&&ut(L,Q,W),K!==L&&d($,K)):oe&16?pe&16?Yt(L,K,$,z,Q,W,te,Z,B):ut(L,Q,W,!0):(oe&8&&d($,""),pe&16&&b(K,$,z,Q,W,te,Z,B))},Vt=(I,T,$,z,Q,W,te,Z,B)=>{I=I||Li,T=T||Li;const L=I.length,oe=T.length,K=Math.min(L,oe);let re;for(re=0;re<K;re++){const pe=T[re]=B?vs(T[re]):Tn(T[re]);F(I[re],pe,$,null,Q,W,te,Z,B)}L>oe?ut(I,Q,W,!0,!1,K):b(T,$,z,Q,W,te,Z,B,K)},Yt=(I,T,$,z,Q,W,te,Z,B)=>{let L=0;const oe=T.length;let K=I.length-1,re=oe-1;for(;L<=K&&L<=re;){const pe=I[L],fe=T[L]=B?vs(T[L]):Tn(T[L]);if(Zs(pe,fe))F(pe,fe,$,null,Q,W,te,Z,B);else break;L++}for(;L<=K&&L<=re;){const pe=I[K],fe=T[re]=B?vs(T[re]):Tn(T[re]);if(Zs(pe,fe))F(pe,fe,$,null,Q,W,te,Z,B);else break;K--,re--}if(L>K){if(L<=re){const pe=re+1,fe=pe<oe?T[pe].el:z;for(;L<=re;)F(null,T[L]=B?vs(T[L]):Tn(T[L]),$,fe,Q,W,te,Z,B),L++}}else if(L>re)for(;L<=K;)We(I[L],Q,W,!0),L++;else{const pe=L,fe=L,ve=new Map;for(L=fe;L<=re;L++){const vt=T[L]=B?vs(T[L]):Tn(T[L]);vt.key!=null&&ve.set(vt.key,L)}let Ne,_t=0;const yt=re-fe+1;let nn=!1,At=0;const ls=new Array(yt);for(L=0;L<yt;L++)ls[L]=0;for(L=pe;L<=K;L++){const vt=I[L];if(_t>=yt){We(vt,Q,W,!0);continue}let sn;if(vt.key!=null)sn=ve.get(vt.key);else for(Ne=fe;Ne<=re;Ne++)if(ls[Ne-fe]===0&&Zs(vt,T[Ne])){sn=Ne;break}sn===void 0?We(vt,Q,W,!0):(ls[sn-fe]=L+1,sn>=At?At=sn:nn=!0,F(vt,T[sn],$,null,Q,W,te,Z,B),_t++)}const pr=nn?TE(ls):Li;for(Ne=pr.length-1,L=yt-1;L>=0;L--){const vt=fe+L,sn=T[vt],Ho=vt+1<oe?T[vt+1].el:z;ls[L]===0?F(null,sn,$,Ho,Q,W,te,Z,B):nn&&(Ne<0||L!==pr[Ne]?Gt(sn,$,Ho,2):Ne--)}}},Gt=(I,T,$,z,Q=null)=>{const{el:W,type:te,transition:Z,children:B,shapeFlag:L}=I;if(L&6){Gt(I.component.subTree,T,$,z);return}if(L&128){I.suspense.move(T,$,z);return}if(L&64){te.move(I,T,$,ce);return}if(te===Ae){s(W,T,$);for(let K=0;K<B.length;K++)Gt(B[K],T,$,z);s(I.anchor,T,$);return}if(te===_a){R(I,T,$);return}if(z!==2&&L&1&&Z)if(z===0)Z.beforeEnter(W),s(W,T,$),Xt(()=>Z.enter(W),Q);else{const{leave:K,delayLeave:re,afterLeave:pe}=Z,fe=()=>{I.ctx.isUnmounted?i(W):s(W,T,$)},ve=()=>{K(W,()=>{fe(),pe&&pe()})};re?re(W,fe,ve):ve()}else s(W,T,$)},We=(I,T,$,z=!1,Q=!1)=>{const{type:W,props:te,ref:Z,children:B,dynamicChildren:L,shapeFlag:oe,patchFlag:K,dirs:re,cacheIndex:pe}=I;if(K===-2&&(Q=!1),Z!=null&&(Zn(),Hr(Z,null,$,I,!0),es()),pe!=null&&(T.renderCache[pe]=void 0),oe&256){T.ctx.deactivate(I);return}const fe=oe&1&&re,ve=!Ui(I);let Ne;if(ve&&(Ne=te&&te.onVnodeBeforeUnmount)&&wn(Ne,T,I),oe&6)Tt(I.component,$,z);else{if(oe&128){I.suspense.unmount($,z);return}fe&&Ws(I,null,T,"beforeUnmount"),oe&64?I.type.remove(I,T,$,ce,z):L&&!L.hasOnce&&(W!==Ae||K>0&&K&64)?ut(L,T,$,!1,!0):(W===Ae&&K&384||!Q&&oe&16)&&ut(B,T,$),z&&Qe(I)}(ve&&(Ne=te&&te.onVnodeUnmounted)||fe)&&Xt(()=>{Ne&&wn(Ne,T,I),fe&&Ws(I,null,T,"unmounted")},$)},Qe=I=>{const{type:T,el:$,anchor:z,transition:Q}=I;if(T===Ae){kn($,z);return}if(T===_a){D(I);return}const W=()=>{i($),Q&&!Q.persisted&&Q.afterLeave&&Q.afterLeave()};if(I.shapeFlag&1&&Q&&!Q.persisted){const{leave:te,delayLeave:Z}=Q,B=()=>te($,W);Z?Z(I.el,W,B):B()}else W()},kn=(I,T)=>{let $;for(;I!==T;)$=g(I),i(I),I=$;i(T)},Tt=(I,T,$)=>{const{bum:z,scope:Q,job:W,subTree:te,um:Z,m:B,a:L,parent:oe,slots:{__:K}}=I;Gh(B),Gh(L),z&&pa(z),oe&&he(K)&&K.forEach(re=>{oe.renderCache[re]=void 0}),Q.stop(),W&&(W.flags|=8,We(te,I,T,$)),Z&&Xt(Z,T),Xt(()=>{I.isUnmounted=!0},T),T&&T.pendingBranch&&!T.isUnmounted&&I.asyncDep&&!I.asyncResolved&&I.suspenseId===T.pendingId&&(T.deps--,T.deps===0&&T.resolve())},ut=(I,T,$,z=!1,Q=!1,W=0)=>{for(let te=W;te<I.length;te++)We(I[te],T,$,z,Q)},G=I=>{if(I.shapeFlag&6)return G(I.component.subTree);if(I.shapeFlag&128)return I.suspense.next();const T=g(I.anchor||I.el),$=T&&T[Qb];return $?g($):T};let ie=!1;const ne=(I,T,$)=>{I==null?T._vnode&&We(T._vnode,null,null,!0):F(T._vnode||null,I,T,null,null,null,$),T._vnode=I,ie||(ie=!0,$h(),Dp(),ie=!1)},ce={p:F,um:We,m:Gt,r:Qe,mt:Te,mc:b,pc:le,pbc:S,n:G,o:t};return{render:ne,hydrate:void 0,createApp:pE(ne)}}function hc({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Qs({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function SE(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function ag(t,e,n=!1){const s=t.children,i=e.children;if(he(s)&&he(i))for(let r=0;r<s.length;r++){const o=s[r];let l=i[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=i[r]=vs(i[r]),l.el=o.el),!n&&l.patchFlag!==-2&&ag(o,l)),l.type===pl&&(l.el=o.el),l.type===xt&&!l.el&&(l.el=o.el)}}function TE(t){const e=t.slice(),n=[0];let s,i,r,o,l;const c=t.length;for(s=0;s<c;s++){const u=t[s];if(u!==0){if(i=n[n.length-1],t[i]<u){e[s]=i,n.push(s);continue}for(r=0,o=n.length-1;r<o;)l=r+o>>1,t[n[l]]<u?r=l+1:o=l;u<t[n[r]]&&(r>0&&(e[s]=n[r-1]),n[r]=s)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}function lg(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:lg(e)}function Gh(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const AE=Symbol.for("v-scx"),RE=()=>an(AE);function Pn(t,e,n){return cg(t,e,n)}function cg(t,e,n=qe){const{immediate:s,deep:i,flush:r,once:o}=n,l=ct({},n),c=e&&s||!e&&r!=="post";let u;if(uo){if(r==="sync"){const y=RE();u=y.__watcherHandles||(y.__watcherHandles=[])}else if(!c){const y=()=>{};return y.stop=Cn,y.resume=Cn,y.pause=Cn,y}}const d=ft;l.call=(y,A,F)=>_n(y,d,A,F);let m=!1;r==="post"?l.scheduler=y=>{Xt(y,d&&d.suspense)}:r!=="sync"&&(m=!0,l.scheduler=(y,A)=>{A?y():Cu(y)}),l.augmentJob=y=>{e&&(y.flags|=4),m&&(y.flags|=2,d&&(y.id=d.uid,y.i=d))};const g=Kb(t,e,l);return uo&&(u?u.push(g):c&&g()),g}function CE(t,e,n){const s=this.proxy,i=tt(t)?t.includes(".")?ug(s,t):()=>s[t]:t.bind(s,s);let r;we(e)?r=e:(r=e.handler,n=e);const o=To(this),l=cg(i,r.bind(s),n);return o(),l}function ug(t,e){const n=e.split(".");return()=>{let s=t;for(let i=0;i<n.length&&s;i++)s=s[n[i]];return s}}const PE=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${cn(e)}Modifiers`]||t[`${Us(e)}Modifiers`];function DE(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||qe;let i=n;const r=e.startsWith("update:"),o=r&&PE(s,e.slice(7));o&&(o.trim&&(i=n.map(d=>tt(d)?d.trim():d)),o.number&&(i=n.map(Ra)));let l,c=s[l=rc(e)]||s[l=rc(cn(e))];!c&&r&&(c=s[l=rc(Us(e))]),c&&_n(c,t,6,i);const u=s[l+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[l])return;t.emitted[l]=!0,_n(u,t,6,i)}}function dg(t,e,n=!1){const s=e.emitsCache,i=s.get(t);if(i!==void 0)return i;const r=t.emits;let o={},l=!1;if(!we(t)){const c=u=>{const d=dg(u,e,!0);d&&(l=!0,ct(o,d))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!r&&!l?(je(t)&&s.set(t,null),null):(he(r)?r.forEach(c=>o[c]=null):ct(o,r),je(t)&&s.set(t,o),o)}function ml(t,e){return!t||!il(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ue(t,e[0].toLowerCase()+e.slice(1))||Ue(t,Us(e))||Ue(t,e))}function zh(t){const{type:e,vnode:n,proxy:s,withProxy:i,propsOptions:[r],slots:o,attrs:l,emit:c,render:u,renderCache:d,props:m,data:g,setupState:y,ctx:A,inheritAttrs:F}=t,N=Na(t);let x,V;try{if(n.shapeFlag&4){const D=i||s,P=D;x=Tn(u.call(P,D,d,m,y,g,A)),V=l}else{const D=e;x=Tn(D.length>1?D(m,{attrs:l,slots:o,emit:c}):D(m,null)),V=e.props?l:OE(l)}}catch(D){Kr.length=0,cl(D,t,1),x=xe(xt)}let R=x;if(V&&F!==!1){const D=Object.keys(V),{shapeFlag:P}=R;D.length&&P&7&&(r&&D.some(_u)&&(V=NE(V,r)),R=Ms(R,V,!1,!0))}return n.dirs&&(R=Ms(R,null,!1,!0),R.dirs=R.dirs?R.dirs.concat(n.dirs):n.dirs),n.transition&&ui(R,n.transition),x=R,Na(N),x}const OE=t=>{let e;for(const n in t)(n==="class"||n==="style"||il(n))&&((e||(e={}))[n]=t[n]);return e},NE=(t,e)=>{const n={};for(const s in t)(!_u(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function ME(t,e,n){const{props:s,children:i,component:r}=t,{props:o,children:l,patchFlag:c}=e,u=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return s?Wh(s,o,u):!!o;if(c&8){const d=e.dynamicProps;for(let m=0;m<d.length;m++){const g=d[m];if(o[g]!==s[g]&&!ml(u,g))return!0}}}else return(i||l)&&(!l||!l.$stable)?!0:s===o?!1:s?o?Wh(s,o,u):!0:!!o;return!1}function Wh(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(e[r]!==t[r]&&!ml(n,r))return!0}return!1}function xE({vnode:t,parent:e},n){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=n,e=e.parent;else break}}const hg=t=>t.__isSuspense;function VE(t,e){e&&e.pendingBranch?he(t)?e.effects.push(...t):e.effects.push(t):Wb(t)}const Ae=Symbol.for("v-fgt"),pl=Symbol.for("v-txt"),xt=Symbol.for("v-cmt"),_a=Symbol.for("v-stc"),Kr=[];let Zt=null;function O(t=!1){Kr.push(Zt=t?null:[])}function LE(){Kr.pop(),Zt=Kr[Kr.length-1]||null}let lo=1;function Qh(t,e=!1){lo+=t,t<0&&Zt&&e&&(Zt.hasOnce=!0)}function fg(t){return t.dynamicChildren=lo>0?Zt||Li:null,LE(),lo>0&&Zt&&Zt.push(t),t}function M(t,e,n,s,i,r){return fg(f(t,e,n,s,i,r,!0))}function Wt(t,e,n,s,i){return fg(xe(t,e,n,s,i,!0))}function co(t){return t?t.__v_isVNode===!0:!1}function Zs(t,e){return t.type===e.type&&t.key===e.key}const mg=({key:t})=>t??null,ya=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?tt(t)||Xe(t)||we(t)?{i:lt,r:t,k:e,f:!!n}:t:null);function f(t,e=null,n=null,s=0,i=null,r=t===Ae?0:1,o=!1,l=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&mg(e),ref:e&&ya(e),scopeId:Np,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:lt};return l?(Nu(c,n),r&128&&t.normalize(c)):n&&(c.shapeFlag|=tt(n)?8:16),lo>0&&!o&&Zt&&(c.patchFlag>0||r&6)&&c.patchFlag!==32&&Zt.push(c),c}const xe=$E;function $E(t,e=null,n=null,s=0,i=null,r=!1){if((!t||t===Gp)&&(t=xt),co(t)){const l=Ms(t,e,!0);return n&&Nu(l,n),lo>0&&!r&&Zt&&(l.shapeFlag&6?Zt[Zt.indexOf(t)]=l:Zt.push(l)),l.patchFlag=-2,l}if(QE(t)&&(t=t.__vccOpts),e){e=FE(e);let{class:l,style:c}=e;l&&!tt(l)&&(e.class=Se(l)),je(c)&&(Au(c)&&!he(c)&&(c=ct({},c)),e.style=fn(c))}const o=tt(t)?1:hg(t)?128:Mp(t)?64:je(t)?4:we(t)?2:0;return f(t,e,n,s,i,o,r,!0)}function FE(t){return t?Au(t)||tg(t)?ct({},t):t:null}function Ms(t,e,n=!1,s=!1){const{props:i,ref:r,patchFlag:o,children:l,transition:c}=t,u=e?UE(i||{},e):i,d={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&mg(u),ref:e&&e.ref?n&&r?he(r)?r.concat(ya(e)):[r,ya(e)]:ya(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Ae?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ms(t.ssContent),ssFallback:t.ssFallback&&Ms(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&s&&ui(d,c.clone(d)),d}function Be(t=" ",e=0){return xe(pl,null,t,e)}function An(t,e){const n=xe(_a,null,t);return n.staticCount=e,n}function X(t="",e=!1){return e?(O(),Wt(xt,null,t)):xe(xt,null,t)}function Tn(t){return t==null||typeof t=="boolean"?xe(xt):he(t)?xe(Ae,null,t.slice()):co(t)?vs(t):xe(pl,null,String(t))}function vs(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Ms(t)}function Nu(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(he(e))n=16;else if(typeof e=="object")if(s&65){const i=e.default;i&&(i._c&&(i._d=!1),Nu(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!tg(e)?e._ctx=lt:i===3&&lt&&(lt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else we(e)?(e={default:e,_ctx:lt},n=32):(e=String(e),s&64?(n=16,e=[Be(e)]):n=8);t.children=e,t.shapeFlag|=n}function UE(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const i in s)if(i==="class")e.class!==s.class&&(e.class=Se([e.class,s.class]));else if(i==="style")e.style=fn([e.style,s.style]);else if(il(i)){const r=e[i],o=s[i];o&&r!==o&&!(he(r)&&r.includes(o))&&(e[i]=r?[].concat(r,o):o)}else i!==""&&(e[i]=s[i])}return e}function wn(t,e,n,s=null){_n(t,e,7,[n,s])}const BE=Xp();let jE=0;function HE(t,e,n){const s=t.type,i=(e?e.appContext:t.appContext)||BE,r={uid:jE++,vnode:t,type:s,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ap(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:sg(s,i),emitsOptions:dg(s,i),emit:null,emitted:null,propsDefaults:qe,inheritAttrs:s.inheritAttrs,ctx:qe,data:qe,props:qe,attrs:qe,slots:qe,refs:qe,setupState:qe,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=DE.bind(null,r),t.ce&&t.ce(r),r}let ft=null;const pg=()=>ft||lt;let xa,$c;{const t=al(),e=(n,s)=>{let i;return(i=t[n])||(i=t[n]=[]),i.push(s),r=>{i.length>1?i.forEach(o=>o(r)):i[0](r)}};xa=e("__VUE_INSTANCE_SETTERS__",n=>ft=n),$c=e("__VUE_SSR_SETTERS__",n=>uo=n)}const To=t=>{const e=ft;return xa(t),t.scope.on(),()=>{t.scope.off(),xa(e)}},Yh=()=>{ft&&ft.scope.off(),xa(null)};function gg(t){return t.vnode.shapeFlag&4}let uo=!1;function qE(t,e=!1,n=!1){e&&$c(e);const{props:s,children:i}=t.vnode,r=gg(t);_E(t,s,r,e),EE(t,i,n||e);const o=r?KE(t,e):void 0;return e&&$c(!1),o}function KE(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,lE);const{setup:s}=n;if(s){Zn();const i=t.setupContext=s.length>1?zE(t):null,r=To(t),o=Io(s,t,0,[t.props,i]),l=tp(o);if(es(),r(),(l||t.sp)&&!Ui(t)&&Bp(t),l){if(o.then(Yh,Yh),e)return o.then(c=>{Jh(t,c)}).catch(c=>{cl(c,t,0)});t.asyncDep=o}else Jh(t,o)}else _g(t)}function Jh(t,e,n){we(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:je(e)&&(t.setupState=Ap(e)),_g(t)}function _g(t,e,n){const s=t.type;t.render||(t.render=s.render||Cn);{const i=To(t);Zn();try{cE(t)}finally{es(),i()}}}const GE={get(t,e){return Mt(t,"get",""),t[e]}};function zE(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,GE),slots:t.slots,emit:t.emit,expose:e}}function gl(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Ap(Ru(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in qr)return qr[n](t)},has(e,n){return n in e||n in qr}})):t.proxy}function WE(t,e=!0){return we(t)?t.displayName||t.name:t.name||e&&t.__name}function QE(t){return we(t)&&"__vccOpts"in t}const Ie=(t,e)=>Hb(t,e,uo);function Mu(t,e,n){const s=arguments.length;return s===2?je(e)&&!he(e)?co(e)?xe(t,null,[e]):xe(t,e):xe(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&co(n)&&(n=[n]),xe(t,e,n))}const YE="3.5.17";/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Fc;const Xh=typeof window<"u"&&window.trustedTypes;if(Xh)try{Fc=Xh.createPolicy("vue",{createHTML:t=>t})}catch{}const yg=Fc?t=>Fc.createHTML(t):t=>t,JE="http://www.w3.org/2000/svg",XE="http://www.w3.org/1998/Math/MathML",jn=typeof document<"u"?document:null,Zh=jn&&jn.createElement("template"),ZE={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const i=e==="svg"?jn.createElementNS(JE,t):e==="mathml"?jn.createElementNS(XE,t):n?jn.createElement(t,{is:n}):jn.createElement(t);return t==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:t=>jn.createTextNode(t),createComment:t=>jn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>jn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,i,r){const o=n?n.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===r||!(i=i.nextSibling)););else{Zh.innerHTML=yg(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const l=Zh.content;if(s==="svg"||s==="mathml"){const c=l.firstChild;for(;c.firstChild;)l.appendChild(c.firstChild);l.removeChild(c)}e.insertBefore(l,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},hs="transition",Pr="animation",zi=Symbol("_vtc"),vg={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},bg=ct({},Vp,vg),ek=t=>(t.displayName="Transition",t.props=bg,t),tk=ek((t,{slots:e})=>Mu(Jb,Eg(t),e)),Ys=(t,e=[])=>{he(t)?t.forEach(n=>n(...e)):t&&t(...e)},ef=t=>t?he(t)?t.some(e=>e.length>1):t.length>1:!1;function Eg(t){const e={};for(const w in t)w in vg||(e[w]=t[w]);if(t.css===!1)return e;const{name:n="v",type:s,duration:i,enterFromClass:r=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:l=`${n}-enter-to`,appearFromClass:c=r,appearActiveClass:u=o,appearToClass:d=l,leaveFromClass:m=`${n}-leave-from`,leaveActiveClass:g=`${n}-leave-active`,leaveToClass:y=`${n}-leave-to`}=t,A=nk(i),F=A&&A[0],N=A&&A[1],{onBeforeEnter:x,onEnter:V,onEnterCancelled:R,onLeave:D,onLeaveCancelled:P,onBeforeAppear:H=x,onAppear:k=V,onAppearCancelled:b=R}=e,E=(w,_,Te,ae)=>{w._enterCancelled=ae,ps(w,_?d:l),ps(w,_?u:o),Te&&Te()},S=(w,_)=>{w._isLeaving=!1,ps(w,m),ps(w,y),ps(w,g),_&&_()},C=w=>(_,Te)=>{const ae=w?k:V,Ce=()=>E(_,w,Te);Ys(ae,[_,Ce]),tf(()=>{ps(_,w?c:r),In(_,w?d:l),ef(ae)||nf(_,s,F,Ce)})};return ct(e,{onBeforeEnter(w){Ys(x,[w]),In(w,r),In(w,o)},onBeforeAppear(w){Ys(H,[w]),In(w,c),In(w,u)},onEnter:C(!1),onAppear:C(!0),onLeave(w,_){w._isLeaving=!0;const Te=()=>S(w,_);In(w,m),w._enterCancelled?(In(w,g),Uc()):(Uc(),In(w,g)),tf(()=>{w._isLeaving&&(ps(w,m),In(w,y),ef(D)||nf(w,s,N,Te))}),Ys(D,[w,Te])},onEnterCancelled(w){E(w,!1,void 0,!0),Ys(R,[w])},onAppearCancelled(w){E(w,!0,void 0,!0),Ys(b,[w])},onLeaveCancelled(w){S(w),Ys(P,[w])}})}function nk(t){if(t==null)return null;if(je(t))return[fc(t.enter),fc(t.leave)];{const e=fc(t);return[e,e]}}function fc(t){return ab(t)}function In(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[zi]||(t[zi]=new Set)).add(e)}function ps(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const n=t[zi];n&&(n.delete(e),n.size||(t[zi]=void 0))}function tf(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let sk=0;function nf(t,e,n,s){const i=t._endId=++sk,r=()=>{i===t._endId&&s()};if(n!=null)return setTimeout(r,n);const{type:o,timeout:l,propCount:c}=kg(t,e);if(!o)return s();const u=o+"end";let d=0;const m=()=>{t.removeEventListener(u,g),r()},g=y=>{y.target===t&&++d>=c&&m()};setTimeout(()=>{d<c&&m()},l+1),t.addEventListener(u,g)}function kg(t,e){const n=window.getComputedStyle(t),s=A=>(n[A]||"").split(", "),i=s(`${hs}Delay`),r=s(`${hs}Duration`),o=sf(i,r),l=s(`${Pr}Delay`),c=s(`${Pr}Duration`),u=sf(l,c);let d=null,m=0,g=0;e===hs?o>0&&(d=hs,m=o,g=r.length):e===Pr?u>0&&(d=Pr,m=u,g=c.length):(m=Math.max(o,u),d=m>0?o>u?hs:Pr:null,g=d?d===hs?r.length:c.length:0);const y=d===hs&&/\b(transform|all)(,|$)/.test(s(`${hs}Property`).toString());return{type:d,timeout:m,propCount:g,hasTransform:y}}function sf(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>rf(n)+rf(t[s])))}function rf(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function Uc(){return document.body.offsetHeight}function ik(t,e,n){const s=t[zi];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const of=Symbol("_vod"),rk=Symbol("_vsh"),ok=Symbol(""),ak=/(^|;)\s*display\s*:/;function lk(t,e,n){const s=t.style,i=tt(n);let r=!1;if(n&&!i){if(e)if(tt(e))for(const o of e.split(";")){const l=o.slice(0,o.indexOf(":")).trim();n[l]==null&&va(s,l,"")}else for(const o in e)n[o]==null&&va(s,o,"");for(const o in n)o==="display"&&(r=!0),va(s,o,n[o])}else if(i){if(e!==n){const o=s[ok];o&&(n+=";"+o),s.cssText=n,r=ak.test(n)}}else e&&t.removeAttribute("style");of in t&&(t[of]=r?s.display:"",t[rk]&&(s.display="none"))}const af=/\s*!important$/;function va(t,e,n){if(he(n))n.forEach(s=>va(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=ck(t,e);af.test(n)?t.setProperty(Us(s),n.replace(af,""),"important"):t[s]=n}}const lf=["Webkit","Moz","ms"],mc={};function ck(t,e){const n=mc[e];if(n)return n;let s=cn(e);if(s!=="filter"&&s in t)return mc[e]=s;s=ol(s);for(let i=0;i<lf.length;i++){const r=lf[i]+s;if(r in t)return mc[e]=r}return e}const cf="http://www.w3.org/1999/xlink";function uf(t,e,n,s,i,r=fb(e)){s&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(cf,e.slice(6,e.length)):t.setAttributeNS(cf,e,n):n==null||r&&!ip(n)?t.removeAttribute(e):t.setAttribute(e,r?"":gn(n)?String(n):n)}function df(t,e,n,s,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?yg(n):n);return}const r=t.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const l=r==="OPTION"?t.getAttribute("value")||"":t.value,c=n==null?t.type==="checkbox"?"on":"":String(n);(l!==c||!("_value"in t))&&(t.value=c),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=ip(n):n==null&&l==="string"?(n="",o=!0):l==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(i||e)}function Kn(t,e,n,s){t.addEventListener(e,n,s)}function uk(t,e,n,s){t.removeEventListener(e,n,s)}const hf=Symbol("_vei");function dk(t,e,n,s,i=null){const r=t[hf]||(t[hf]={}),o=r[e];if(s&&o)o.value=s;else{const[l,c]=hk(e);if(s){const u=r[e]=pk(s,i);Kn(t,l,u,c)}else o&&(uk(t,l,o,c),r[e]=void 0)}}const ff=/(?:Once|Passive|Capture)$/;function hk(t){let e;if(ff.test(t)){e={};let s;for(;s=t.match(ff);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Us(t.slice(2)),e]}let pc=0;const fk=Promise.resolve(),mk=()=>pc||(fk.then(()=>pc=0),pc=Date.now());function pk(t,e){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;_n(gk(s,n.value),e,5,[s])};return n.value=t,n.attached=mk(),n}function gk(t,e){if(he(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>i=>!i._stopped&&s&&s(i))}else return e}const mf=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,_k=(t,e,n,s,i,r)=>{const o=i==="svg";e==="class"?ik(t,s,o):e==="style"?lk(t,n,s):il(e)?_u(e)||dk(t,e,n,s,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):yk(t,e,s,o))?(df(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&uf(t,e,s,o,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!tt(s))?df(t,cn(e),s,r,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),uf(t,e,s,o))};function yk(t,e,n,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&mf(e)&&we(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return mf(e)&&tt(n)?!1:e in t}const wg=new WeakMap,Ig=new WeakMap,Va=Symbol("_moveCb"),pf=Symbol("_enterCb"),vk=t=>(delete t.props.mode,t),bk=vk({name:"TransitionGroup",props:ct({},bg,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=pg(),s=xp();let i,r;return Hp(()=>{if(!i.length)return;const o=t.moveClass||`${t.name||"v"}-move`;if(!Sk(i[0].el,n.vnode.el,o)){i=[];return}i.forEach(kk),i.forEach(wk);const l=i.filter(Ik);Uc(),l.forEach(c=>{const u=c.el,d=u.style;In(u,o),d.transform=d.webkitTransform=d.transitionDuration="";const m=u[Va]=g=>{g&&g.target!==u||(!g||/transform$/.test(g.propertyName))&&(u.removeEventListener("transitionend",m),u[Va]=null,ps(u,o))};u.addEventListener("transitionend",m)}),i=[]}),()=>{const o=Pe(t),l=Eg(o);let c=o.tag||Ae;if(i=[],r)for(let u=0;u<r.length;u++){const d=r[u];d.el&&d.el instanceof Element&&(i.push(d),ui(d,ao(d,l,s,n)),wg.set(d,d.el.getBoundingClientRect()))}r=e.default?Pu(e.default()):[];for(let u=0;u<r.length;u++){const d=r[u];d.key!=null&&ui(d,ao(d,l,s,n))}return xe(c,null,r)}}}),Ek=bk;function kk(t){const e=t.el;e[Va]&&e[Va](),e[pf]&&e[pf]()}function wk(t){Ig.set(t,t.el.getBoundingClientRect())}function Ik(t){const e=wg.get(t),n=Ig.get(t),s=e.left-n.left,i=e.top-n.top;if(s||i){const r=t.el.style;return r.transform=r.webkitTransform=`translate(${s}px,${i}px)`,r.transitionDuration="0s",t}}function Sk(t,e,n){const s=t.cloneNode(),i=t[zi];i&&i.forEach(l=>{l.split(/\s+/).forEach(c=>c&&s.classList.remove(c))}),n.split(/\s+/).forEach(l=>l&&s.classList.add(l)),s.style.display="none";const r=e.nodeType===1?e:e.parentNode;r.appendChild(s);const{hasTransform:o}=kg(s);return r.removeChild(s),o}const xs=t=>{const e=t.props["onUpdate:modelValue"]||!1;return he(e)?n=>pa(e,n):e};function Tk(t){t.target.composing=!0}function gf(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ln=Symbol("_assign"),qt={created(t,{modifiers:{lazy:e,trim:n,number:s}},i){t[ln]=xs(i);const r=s||i.props&&i.props.type==="number";Kn(t,e?"change":"input",o=>{if(o.target.composing)return;let l=t.value;n&&(l=l.trim()),r&&(l=Ra(l)),t[ln](l)}),n&&Kn(t,"change",()=>{t.value=t.value.trim()}),e||(Kn(t,"compositionstart",Tk),Kn(t,"compositionend",gf),Kn(t,"change",gf))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:s,trim:i,number:r}},o){if(t[ln]=xs(o),t.composing)return;const l=(r||t.type==="number")&&!/^0\d/.test(t.value)?Ra(t.value):t.value,c=e??"";l!==c&&(document.activeElement===t&&t.type!=="range"&&(s&&e===n||i&&t.value.trim()===c)||(t.value=c))}},Ak={deep:!0,created(t,e,n){t[ln]=xs(n),Kn(t,"change",()=>{const s=t._modelValue,i=Wi(t),r=t.checked,o=t[ln];if(he(s)){const l=bu(s,i),c=l!==-1;if(r&&!c)o(s.concat(i));else if(!r&&c){const u=[...s];u.splice(l,1),o(u)}}else if(rr(s)){const l=new Set(s);r?l.add(i):l.delete(i),o(l)}else o(Tg(t,r))})},mounted:_f,beforeUpdate(t,e,n){t[ln]=xs(n),_f(t,e,n)}};function _f(t,{value:e,oldValue:n},s){t._modelValue=e;let i;if(he(e))i=bu(e,s.props.value)>-1;else if(rr(e))i=e.has(s.props.value);else{if(e===n)return;i=ci(e,Tg(t,!0))}t.checked!==i&&(t.checked=i)}const Sg={created(t,{value:e},n){t.checked=ci(e,n.props.value),t[ln]=xs(n),Kn(t,"change",()=>{t[ln](Wi(t))})},beforeUpdate(t,{value:e,oldValue:n},s){t[ln]=xs(s),e!==n&&(t.checked=ci(e,s.props.value))}},ei={deep:!0,created(t,{value:e,modifiers:{number:n}},s){const i=rr(e);Kn(t,"change",()=>{const r=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?Ra(Wi(o)):Wi(o));t[ln](t.multiple?i?new Set(r):r:r[0]),t._assigning=!0,ul(()=>{t._assigning=!1})}),t[ln]=xs(s)},mounted(t,{value:e}){yf(t,e)},beforeUpdate(t,e,n){t[ln]=xs(n)},updated(t,{value:e}){t._assigning||yf(t,e)}};function yf(t,e){const n=t.multiple,s=he(e);if(!(n&&!s&&!rr(e))){for(let i=0,r=t.options.length;i<r;i++){const o=t.options[i],l=Wi(o);if(n)if(s){const c=typeof l;c==="string"||c==="number"?o.selected=e.some(u=>String(u)===String(l)):o.selected=bu(e,l)>-1}else o.selected=e.has(l);else if(ci(Wi(o),e)){t.selectedIndex!==i&&(t.selectedIndex=i);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Wi(t){return"_value"in t?t._value:t.value}function Tg(t,e){const n=e?"_trueValue":"_falseValue";return n in t?t[n]:e}const Rk={created(t,e,n){la(t,e,n,null,"created")},mounted(t,e,n){la(t,e,n,null,"mounted")},beforeUpdate(t,e,n,s){la(t,e,n,s,"beforeUpdate")},updated(t,e,n,s){la(t,e,n,s,"updated")}};function Ck(t,e){switch(t){case"SELECT":return ei;case"TEXTAREA":return qt;default:switch(e){case"checkbox":return Ak;case"radio":return Sg;default:return qt}}}function la(t,e,n,s,i){const o=Ck(t.tagName,n.props&&n.props.type)[i];o&&o(t,e,n,s)}const Pk=["ctrl","shift","alt","meta"],Dk={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Pk.some(n=>t[`${n}Key`]&&!e.includes(n))},ts=(t,e)=>{const n=t._withMods||(t._withMods={}),s=e.join(".");return n[s]||(n[s]=(i,...r)=>{for(let o=0;o<e.length;o++){const l=Dk[e[o]];if(l&&l(i,e))return}return t(i,...r)})},Ok={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Ag=(t,e)=>{const n=t._withKeys||(t._withKeys={}),s=e.join(".");return n[s]||(n[s]=i=>{if(!("key"in i))return;const r=Us(i.key);if(e.some(o=>o===r||Ok[o]===r))return t(i)})},Nk=ct({patchProp:_k},ZE);let vf;function Mk(){return vf||(vf=wE(Nk))}const xk=(...t)=>{const e=Mk().createApp(...t),{mount:n}=e;return e.mount=s=>{const i=Lk(s);if(!i)return;const r=e._component;!we(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=n(i,!1,Vk(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function Vk(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Lk(t){return tt(t)?document.querySelector(t):t}/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let Rg;const _l=t=>Rg=t,Cg=Symbol();function Bc(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Gr;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Gr||(Gr={}));function $k(){const t=lp(!0),e=t.run(()=>ge({}));let n=[],s=[];const i=Ru({install(r){_l(i),i._a=r,r.provide(Cg,i),r.config.globalProperties.$pinia=i,s.forEach(o=>n.push(o)),s=[]},use(r){return this._a?n.push(r):s.push(r),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return i}const Pg=()=>{};function bf(t,e,n,s=Pg){t.push(e);const i=()=>{const r=t.indexOf(e);r>-1&&(t.splice(r,1),s())};return!n&&cp()&&pb(i),i}function Pi(t,...e){t.slice().forEach(n=>{n(...e)})}const Fk=t=>t(),Ef=Symbol(),gc=Symbol();function jc(t,e){t instanceof Map&&e instanceof Map?e.forEach((n,s)=>t.set(s,n)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const s=e[n],i=t[n];Bc(i)&&Bc(s)&&t.hasOwnProperty(n)&&!Xe(s)&&!Yn(s)?t[n]=jc(i,s):t[n]=s}return t}const Uk=Symbol();function Bk(t){return!Bc(t)||!t.hasOwnProperty(Uk)}const{assign:gs}=Object;function jk(t){return!!(Xe(t)&&t.effect)}function Hk(t,e,n,s){const{state:i,actions:r,getters:o}=e,l=n.state.value[t];let c;function u(){l||(n.state.value[t]=i?i():{});const d=$b(n.state.value[t]);return gs(d,r,Object.keys(o||{}).reduce((m,g)=>(m[g]=Ru(Ie(()=>{_l(n);const y=n._s.get(t);return o[g].call(y,y)})),m),{}))}return c=Dg(t,u,e,n,s,!0),c}function Dg(t,e,n={},s,i,r){let o;const l=gs({actions:{}},n),c={deep:!0};let u,d,m=[],g=[],y;const A=s.state.value[t];!r&&!A&&(s.state.value[t]={}),ge({});let F;function N(b){let E;u=d=!1,typeof b=="function"?(b(s.state.value[t]),E={type:Gr.patchFunction,storeId:t,events:y}):(jc(s.state.value[t],b),E={type:Gr.patchObject,payload:b,storeId:t,events:y});const S=F=Symbol();ul().then(()=>{F===S&&(u=!0)}),d=!0,Pi(m,E,s.state.value[t])}const x=r?function(){const{state:E}=n,S=E?E():{};this.$patch(C=>{gs(C,S)})}:Pg;function V(){o.stop(),m=[],g=[],s._s.delete(t)}const R=(b,E="")=>{if(Ef in b)return b[gc]=E,b;const S=function(){_l(s);const C=Array.from(arguments),w=[],_=[];function Te(_e){w.push(_e)}function ae(_e){_.push(_e)}Pi(g,{args:C,name:S[gc],store:P,after:Te,onError:ae});let Ce;try{Ce=b.apply(this&&this.$id===t?this:P,C)}catch(_e){throw Pi(_,_e),_e}return Ce instanceof Promise?Ce.then(_e=>(Pi(w,_e),_e)).catch(_e=>(Pi(_,_e),Promise.reject(_e))):(Pi(w,Ce),Ce)};return S[Ef]=!0,S[gc]=E,S},D={_p:s,$id:t,$onAction:bf.bind(null,g),$patch:N,$reset:x,$subscribe(b,E={}){const S=bf(m,b,E.detached,()=>C()),C=o.run(()=>Pn(()=>s.state.value[t],w=>{(E.flush==="sync"?d:u)&&b({storeId:t,type:Gr.direct,events:y},w)},gs({},c,E)));return S},$dispose:V},P=Cs(D);s._s.set(t,P);const k=(s._a&&s._a.runWithContext||Fk)(()=>s._e.run(()=>(o=lp()).run(()=>e({action:R}))));for(const b in k){const E=k[b];if(Xe(E)&&!jk(E)||Yn(E))r||(A&&Bk(E)&&(Xe(E)?E.value=A[b]:jc(E,A[b])),s.state.value[t][b]=E);else if(typeof E=="function"){const S=R(E,b);k[b]=S,l.actions[b]=E}}return gs(P,k),gs(Pe(P),k),Object.defineProperty(P,"$state",{get:()=>s.state.value[t],set:b=>{N(E=>{gs(E,b)})}}),s._p.forEach(b=>{gs(P,o.run(()=>b({store:P,app:s._a,pinia:s,options:l})))}),A&&r&&n.hydrate&&n.hydrate(P.$state,A),u=!0,d=!0,P}/*! #__NO_SIDE_EFFECTS__ */function xu(t,e,n){let s,i;const r=typeof e=="function";typeof t=="string"?(s=t,i=r?n:e):(i=t,s=t.id);function o(l,c){const u=gE();return l=l||(u?an(Cg,null):null),l&&_l(l),l=Rg,l._s.has(s)||(r?Dg(s,e,i,l):Hk(s,i,l)),l._s.get(s)}return o.$id=s,o}function qk(t){{const e=Pe(t),n={};for(const s in e){const i=e[s];i.effect?n[s]=Ie({get:()=>t[s],set(r){t[s]=r}}):(Xe(i)||Yn(i))&&(n[s]=Bb(t,s))}return n}}/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const Oi=typeof document<"u";function Og(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Kk(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&Og(t.default)}const Fe=Object.assign;function _c(t,e){const n={};for(const s in e){const i=e[s];n[s]=yn(i)?i.map(t):t(i)}return n}const zr=()=>{},yn=Array.isArray,Ng=/#/g,Gk=/&/g,zk=/\//g,Wk=/=/g,Qk=/\?/g,Mg=/\+/g,Yk=/%5B/g,Jk=/%5D/g,xg=/%5E/g,Xk=/%60/g,Vg=/%7B/g,Zk=/%7C/g,Lg=/%7D/g,ew=/%20/g;function Vu(t){return encodeURI(""+t).replace(Zk,"|").replace(Yk,"[").replace(Jk,"]")}function tw(t){return Vu(t).replace(Vg,"{").replace(Lg,"}").replace(xg,"^")}function Hc(t){return Vu(t).replace(Mg,"%2B").replace(ew,"+").replace(Ng,"%23").replace(Gk,"%26").replace(Xk,"`").replace(Vg,"{").replace(Lg,"}").replace(xg,"^")}function nw(t){return Hc(t).replace(Wk,"%3D")}function sw(t){return Vu(t).replace(Ng,"%23").replace(Qk,"%3F")}function iw(t){return t==null?"":sw(t).replace(zk,"%2F")}function ho(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const rw=/\/$/,ow=t=>t.replace(rw,"");function yc(t,e,n="/"){let s,i={},r="",o="";const l=e.indexOf("#");let c=e.indexOf("?");return l<c&&l>=0&&(c=-1),c>-1&&(s=e.slice(0,c),r=e.slice(c+1,l>-1?l:e.length),i=t(r)),l>-1&&(s=s||e.slice(0,l),o=e.slice(l,e.length)),s=uw(s??e,n),{fullPath:s+(r&&"?")+r+o,path:s,query:i,hash:ho(o)}}function aw(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function kf(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function lw(t,e,n){const s=e.matched.length-1,i=n.matched.length-1;return s>-1&&s===i&&Qi(e.matched[s],n.matched[i])&&$g(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Qi(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function $g(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!cw(t[n],e[n]))return!1;return!0}function cw(t,e){return yn(t)?wf(t,e):yn(e)?wf(e,t):t===e}function wf(t,e){return yn(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function uw(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/"),i=s[s.length-1];(i===".."||i===".")&&s.push("");let r=n.length-1,o,l;for(o=0;o<s.length;o++)if(l=s[o],l!==".")if(l==="..")r>1&&r--;else break;return n.slice(0,r).join("/")+"/"+s.slice(o).join("/")}const fs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var fo;(function(t){t.pop="pop",t.push="push"})(fo||(fo={}));var Wr;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Wr||(Wr={}));function dw(t){if(!t)if(Oi){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),ow(t)}const hw=/^[^#]+#/;function fw(t,e){return t.replace(hw,"#")+e}function mw(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const yl=()=>({left:window.scrollX,top:window.scrollY});function pw(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),i=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!i)return;e=mw(i,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function If(t,e){return(history.state?history.state.position-e:-1)+t}const qc=new Map;function gw(t,e){qc.set(t,e)}function _w(t){const e=qc.get(t);return qc.delete(t),e}let yw=()=>location.protocol+"//"+location.host;function Fg(t,e){const{pathname:n,search:s,hash:i}=e,r=t.indexOf("#");if(r>-1){let l=i.includes(t.slice(r))?t.slice(r).length:1,c=i.slice(l);return c[0]!=="/"&&(c="/"+c),kf(c,"")}return kf(n,t)+s+i}function vw(t,e,n,s){let i=[],r=[],o=null;const l=({state:g})=>{const y=Fg(t,location),A=n.value,F=e.value;let N=0;if(g){if(n.value=y,e.value=g,o&&o===A){o=null;return}N=F?g.position-F.position:0}else s(y);i.forEach(x=>{x(n.value,A,{delta:N,type:fo.pop,direction:N?N>0?Wr.forward:Wr.back:Wr.unknown})})};function c(){o=n.value}function u(g){i.push(g);const y=()=>{const A=i.indexOf(g);A>-1&&i.splice(A,1)};return r.push(y),y}function d(){const{history:g}=window;g.state&&g.replaceState(Fe({},g.state,{scroll:yl()}),"")}function m(){for(const g of r)g();r=[],window.removeEventListener("popstate",l),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",l),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:c,listen:u,destroy:m}}function Sf(t,e,n,s=!1,i=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:i?yl():null}}function bw(t){const{history:e,location:n}=window,s={value:Fg(t,n)},i={value:e.state};i.value||r(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function r(c,u,d){const m=t.indexOf("#"),g=m>-1?(n.host&&document.querySelector("base")?t:t.slice(m))+c:yw()+t+c;try{e[d?"replaceState":"pushState"](u,"",g),i.value=u}catch(y){console.error(y),n[d?"replace":"assign"](g)}}function o(c,u){const d=Fe({},e.state,Sf(i.value.back,c,i.value.forward,!0),u,{position:i.value.position});r(c,d,!0),s.value=c}function l(c,u){const d=Fe({},i.value,e.state,{forward:c,scroll:yl()});r(d.current,d,!0);const m=Fe({},Sf(s.value,c,null),{position:d.position+1},u);r(c,m,!1),s.value=c}return{location:s,state:i,push:l,replace:o}}function Ew(t){t=dw(t);const e=bw(t),n=vw(t,e.state,e.location,e.replace);function s(r,o=!0){o||n.pauseListeners(),history.go(r)}const i=Fe({location:"",base:t,go:s,createHref:fw.bind(null,t)},e,n);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function kw(t){return typeof t=="string"||t&&typeof t=="object"}function Ug(t){return typeof t=="string"||typeof t=="symbol"}const Bg=Symbol("");var Tf;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Tf||(Tf={}));function Yi(t,e){return Fe(new Error,{type:t,[Bg]:!0},e)}function Bn(t,e){return t instanceof Error&&Bg in t&&(e==null||!!(t.type&e))}const Af="[^/]+?",ww={sensitive:!1,strict:!1,start:!0,end:!0},Iw=/[.+*?^${}()[\]/\\]/g;function Sw(t,e){const n=Fe({},ww,e),s=[];let i=n.start?"^":"";const r=[];for(const u of t){const d=u.length?[]:[90];n.strict&&!u.length&&(i+="/");for(let m=0;m<u.length;m++){const g=u[m];let y=40+(n.sensitive?.25:0);if(g.type===0)m||(i+="/"),i+=g.value.replace(Iw,"\\$&"),y+=40;else if(g.type===1){const{value:A,repeatable:F,optional:N,regexp:x}=g;r.push({name:A,repeatable:F,optional:N});const V=x||Af;if(V!==Af){y+=10;try{new RegExp(`(${V})`)}catch(D){throw new Error(`Invalid custom RegExp for param "${A}" (${V}): `+D.message)}}let R=F?`((?:${V})(?:/(?:${V}))*)`:`(${V})`;m||(R=N&&u.length<2?`(?:/${R})`:"/"+R),N&&(R+="?"),i+=R,y+=20,N&&(y+=-8),F&&(y+=-20),V===".*"&&(y+=-50)}d.push(y)}s.push(d)}if(n.strict&&n.end){const u=s.length-1;s[u][s[u].length-1]+=.7000000000000001}n.strict||(i+="/?"),n.end?i+="$":n.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const o=new RegExp(i,n.sensitive?"":"i");function l(u){const d=u.match(o),m={};if(!d)return null;for(let g=1;g<d.length;g++){const y=d[g]||"",A=r[g-1];m[A.name]=y&&A.repeatable?y.split("/"):y}return m}function c(u){let d="",m=!1;for(const g of t){(!m||!d.endsWith("/"))&&(d+="/"),m=!1;for(const y of g)if(y.type===0)d+=y.value;else if(y.type===1){const{value:A,repeatable:F,optional:N}=y,x=A in u?u[A]:"";if(yn(x)&&!F)throw new Error(`Provided param "${A}" is an array but it is not repeatable (* or + modifiers)`);const V=yn(x)?x.join("/"):x;if(!V)if(N)g.length<2&&(d.endsWith("/")?d=d.slice(0,-1):m=!0);else throw new Error(`Missing required param "${A}"`);d+=V}}return d||"/"}return{re:o,score:s,keys:r,parse:l,stringify:c}}function Tw(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function jg(t,e){let n=0;const s=t.score,i=e.score;for(;n<s.length&&n<i.length;){const r=Tw(s[n],i[n]);if(r)return r;n++}if(Math.abs(i.length-s.length)===1){if(Rf(s))return 1;if(Rf(i))return-1}return i.length-s.length}function Rf(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const Aw={type:0,value:""},Rw=/[a-zA-Z0-9_]/;function Cw(t){if(!t)return[[]];if(t==="/")return[[Aw]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(y){throw new Error(`ERR (${n})/"${u}": ${y}`)}let n=0,s=n;const i=[];let r;function o(){r&&i.push(r),r=[]}let l=0,c,u="",d="";function m(){u&&(n===0?r.push({type:0,value:u}):n===1||n===2||n===3?(r.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),r.push({type:1,value:u,regexp:d,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),u="")}function g(){u+=c}for(;l<t.length;){if(c=t[l++],c==="\\"&&n!==2){s=n,n=4;continue}switch(n){case 0:c==="/"?(u&&m(),o()):c===":"?(m(),n=1):g();break;case 4:g(),n=s;break;case 1:c==="("?n=2:Rw.test(c)?g():(m(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&l--);break;case 2:c===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+c:n=3:d+=c;break;case 3:m(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&l--,d="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${u}"`),m(),o(),i}function Pw(t,e,n){const s=Sw(Cw(t.path),n),i=Fe(s,{record:t,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function Dw(t,e){const n=[],s=new Map;e=Of({strict:!1,end:!0,sensitive:!1},e);function i(m){return s.get(m)}function r(m,g,y){const A=!y,F=Pf(m);F.aliasOf=y&&y.record;const N=Of(e,m),x=[F];if("alias"in m){const D=typeof m.alias=="string"?[m.alias]:m.alias;for(const P of D)x.push(Pf(Fe({},F,{components:y?y.record.components:F.components,path:P,aliasOf:y?y.record:F})))}let V,R;for(const D of x){const{path:P}=D;if(g&&P[0]!=="/"){const H=g.record.path,k=H[H.length-1]==="/"?"":"/";D.path=g.record.path+(P&&k+P)}if(V=Pw(D,g,N),y?y.alias.push(V):(R=R||V,R!==V&&R.alias.push(V),A&&m.name&&!Df(V)&&o(m.name)),Hg(V)&&c(V),F.children){const H=F.children;for(let k=0;k<H.length;k++)r(H[k],V,y&&y.children[k])}y=y||V}return R?()=>{o(R)}:zr}function o(m){if(Ug(m)){const g=s.get(m);g&&(s.delete(m),n.splice(n.indexOf(g),1),g.children.forEach(o),g.alias.forEach(o))}else{const g=n.indexOf(m);g>-1&&(n.splice(g,1),m.record.name&&s.delete(m.record.name),m.children.forEach(o),m.alias.forEach(o))}}function l(){return n}function c(m){const g=Mw(m,n);n.splice(g,0,m),m.record.name&&!Df(m)&&s.set(m.record.name,m)}function u(m,g){let y,A={},F,N;if("name"in m&&m.name){if(y=s.get(m.name),!y)throw Yi(1,{location:m});N=y.record.name,A=Fe(Cf(g.params,y.keys.filter(R=>!R.optional).concat(y.parent?y.parent.keys.filter(R=>R.optional):[]).map(R=>R.name)),m.params&&Cf(m.params,y.keys.map(R=>R.name))),F=y.stringify(A)}else if(m.path!=null)F=m.path,y=n.find(R=>R.re.test(F)),y&&(A=y.parse(F),N=y.record.name);else{if(y=g.name?s.get(g.name):n.find(R=>R.re.test(g.path)),!y)throw Yi(1,{location:m,currentLocation:g});N=y.record.name,A=Fe({},g.params,m.params),F=y.stringify(A)}const x=[];let V=y;for(;V;)x.unshift(V.record),V=V.parent;return{name:N,path:F,params:A,matched:x,meta:Nw(x)}}t.forEach(m=>r(m));function d(){n.length=0,s.clear()}return{addRoute:r,resolve:u,removeRoute:o,clearRoutes:d,getRoutes:l,getRecordMatcher:i}}function Cf(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function Pf(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:Ow(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function Ow(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="object"?n[s]:n;return e}function Df(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function Nw(t){return t.reduce((e,n)=>Fe(e,n.meta),{})}function Of(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}function Mw(t,e){let n=0,s=e.length;for(;n!==s;){const r=n+s>>1;jg(t,e[r])<0?s=r:n=r+1}const i=xw(t);return i&&(s=e.lastIndexOf(i,s-1)),s}function xw(t){let e=t;for(;e=e.parent;)if(Hg(e)&&jg(t,e)===0)return e}function Hg({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function Vw(t){const e={};if(t===""||t==="?")return e;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let i=0;i<s.length;++i){const r=s[i].replace(Mg," "),o=r.indexOf("="),l=ho(o<0?r:r.slice(0,o)),c=o<0?null:ho(r.slice(o+1));if(l in e){let u=e[l];yn(u)||(u=e[l]=[u]),u.push(c)}else e[l]=c}return e}function Nf(t){let e="";for(let n in t){const s=t[n];if(n=nw(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(yn(s)?s.map(r=>r&&Hc(r)):[s&&Hc(s)]).forEach(r=>{r!==void 0&&(e+=(e.length?"&":"")+n,r!=null&&(e+="="+r))})}return e}function Lw(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=yn(s)?s.map(i=>i==null?null:""+i):s==null?s:""+s)}return e}const $w=Symbol(""),Mf=Symbol(""),vl=Symbol(""),Lu=Symbol(""),Kc=Symbol("");function Dr(){let t=[];function e(s){return t.push(s),()=>{const i=t.indexOf(s);i>-1&&t.splice(i,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function bs(t,e,n,s,i,r=o=>o()){const o=s&&(s.enterCallbacks[i]=s.enterCallbacks[i]||[]);return()=>new Promise((l,c)=>{const u=g=>{g===!1?c(Yi(4,{from:n,to:e})):g instanceof Error?c(g):kw(g)?c(Yi(2,{from:e,to:g})):(o&&s.enterCallbacks[i]===o&&typeof g=="function"&&o.push(g),l())},d=r(()=>t.call(s&&s.instances[i],e,n,u));let m=Promise.resolve(d);t.length<3&&(m=m.then(u)),m.catch(g=>c(g))})}function vc(t,e,n,s,i=r=>r()){const r=[];for(const o of t)for(const l in o.components){let c=o.components[l];if(!(e!=="beforeRouteEnter"&&!o.instances[l]))if(Og(c)){const d=(c.__vccOpts||c)[e];d&&r.push(bs(d,n,s,o,l,i))}else{let u=c();r.push(()=>u.then(d=>{if(!d)throw new Error(`Couldn't resolve component "${l}" at "${o.path}"`);const m=Kk(d)?d.default:d;o.mods[l]=d,o.components[l]=m;const y=(m.__vccOpts||m)[e];return y&&bs(y,n,s,o,l,i)()}))}}return r}function xf(t){const e=an(vl),n=an(Lu),s=Ie(()=>{const c=de(t.to);return e.resolve(c)}),i=Ie(()=>{const{matched:c}=s.value,{length:u}=c,d=c[u-1],m=n.matched;if(!d||!m.length)return-1;const g=m.findIndex(Qi.bind(null,d));if(g>-1)return g;const y=Vf(c[u-2]);return u>1&&Vf(d)===y&&m[m.length-1].path!==y?m.findIndex(Qi.bind(null,c[u-2])):g}),r=Ie(()=>i.value>-1&&Hw(n.params,s.value.params)),o=Ie(()=>i.value>-1&&i.value===n.matched.length-1&&$g(n.params,s.value.params));function l(c={}){if(jw(c)){const u=e[de(t.replace)?"replace":"push"](de(t.to)).catch(zr);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:s,href:Ie(()=>s.value.href),isActive:r,isExactActive:o,navigate:l}}function Fw(t){return t.length===1?t[0]:t}const Uw=Up({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:xf,setup(t,{slots:e}){const n=Cs(xf(t)),{options:s}=an(vl),i=Ie(()=>({[Lf(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[Lf(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const r=e.default&&Fw(e.default(n));return t.custom?r:Mu("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:i.value},r)}}}),Bw=Uw;function jw(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Hw(t,e){for(const n in e){const s=e[n],i=t[n];if(typeof s=="string"){if(s!==i)return!1}else if(!yn(i)||i.length!==s.length||s.some((r,o)=>r!==i[o]))return!1}return!0}function Vf(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Lf=(t,e,n)=>t??e??n,qw=Up({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const s=an(Kc),i=Ie(()=>t.route||s.value),r=an(Mf,0),o=Ie(()=>{let u=de(r);const{matched:d}=i.value;let m;for(;(m=d[u])&&!m.components;)u++;return u}),l=Ie(()=>i.value.matched[o.value]);ga(Mf,Ie(()=>o.value+1)),ga($w,l),ga(Kc,i);const c=ge();return Pn(()=>[c.value,l.value,t.name],([u,d,m],[g,y,A])=>{d&&(d.instances[m]=u,y&&y!==d&&u&&u===g&&(d.leaveGuards.size||(d.leaveGuards=y.leaveGuards),d.updateGuards.size||(d.updateGuards=y.updateGuards))),u&&d&&(!y||!Qi(d,y)||!g)&&(d.enterCallbacks[m]||[]).forEach(F=>F(u))},{flush:"post"}),()=>{const u=i.value,d=t.name,m=l.value,g=m&&m.components[d];if(!g)return $f(n.default,{Component:g,route:u});const y=m.props[d],A=y?y===!0?u.params:typeof y=="function"?y(u):y:null,N=Mu(g,Fe({},A,e,{onVnodeUnmounted:x=>{x.component.isUnmounted&&(m.instances[d]=null)},ref:c}));return $f(n.default,{Component:N,route:u})||N}}});function $f(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const qg=qw;function Kw(t){const e=Dw(t.routes,t),n=t.parseQuery||Vw,s=t.stringifyQuery||Nf,i=t.history,r=Dr(),o=Dr(),l=Dr(),c=xb(fs);let u=fs;Oi&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=_c.bind(null,G=>""+G),m=_c.bind(null,iw),g=_c.bind(null,ho);function y(G,ie){let ne,ce;return Ug(G)?(ne=e.getRecordMatcher(G),ce=ie):ce=G,e.addRoute(ce,ne)}function A(G){const ie=e.getRecordMatcher(G);ie&&e.removeRoute(ie)}function F(){return e.getRoutes().map(G=>G.record)}function N(G){return!!e.getRecordMatcher(G)}function x(G,ie){if(ie=Fe({},ie||c.value),typeof G=="string"){const $=yc(n,G,ie.path),z=e.resolve({path:$.path},ie),Q=i.createHref($.fullPath);return Fe($,z,{params:g(z.params),hash:ho($.hash),redirectedFrom:void 0,href:Q})}let ne;if(G.path!=null)ne=Fe({},G,{path:yc(n,G.path,ie.path).path});else{const $=Fe({},G.params);for(const z in $)$[z]==null&&delete $[z];ne=Fe({},G,{params:m($)}),ie.params=m(ie.params)}const ce=e.resolve(ne,ie),Oe=G.hash||"";ce.params=d(g(ce.params));const I=aw(s,Fe({},G,{hash:tw(Oe),path:ce.path})),T=i.createHref(I);return Fe({fullPath:I,hash:Oe,query:s===Nf?Lw(G.query):G.query||{}},ce,{redirectedFrom:void 0,href:T})}function V(G){return typeof G=="string"?yc(n,G,c.value.path):Fe({},G)}function R(G,ie){if(u!==G)return Yi(8,{from:ie,to:G})}function D(G){return k(G)}function P(G){return D(Fe(V(G),{replace:!0}))}function H(G){const ie=G.matched[G.matched.length-1];if(ie&&ie.redirect){const{redirect:ne}=ie;let ce=typeof ne=="function"?ne(G):ne;return typeof ce=="string"&&(ce=ce.includes("?")||ce.includes("#")?ce=V(ce):{path:ce},ce.params={}),Fe({query:G.query,hash:G.hash,params:ce.path!=null?{}:G.params},ce)}}function k(G,ie){const ne=u=x(G),ce=c.value,Oe=G.state,I=G.force,T=G.replace===!0,$=H(ne);if($)return k(Fe(V($),{state:typeof $=="object"?Fe({},Oe,$.state):Oe,force:I,replace:T}),ie||ne);const z=ne;z.redirectedFrom=ie;let Q;return!I&&lw(s,ce,ne)&&(Q=Yi(16,{to:z,from:ce}),Gt(ce,ce,!0,!1)),(Q?Promise.resolve(Q):S(z,ce)).catch(W=>Bn(W)?Bn(W,2)?W:Yt(W):le(W,z,ce)).then(W=>{if(W){if(Bn(W,2))return k(Fe({replace:T},V(W.to),{state:typeof W.to=="object"?Fe({},Oe,W.to.state):Oe,force:I}),ie||z)}else W=w(z,ce,!0,T,Oe);return C(z,ce,W),W})}function b(G,ie){const ne=R(G,ie);return ne?Promise.reject(ne):Promise.resolve()}function E(G){const ie=kn.values().next().value;return ie&&typeof ie.runWithContext=="function"?ie.runWithContext(G):G()}function S(G,ie){let ne;const[ce,Oe,I]=Gw(G,ie);ne=vc(ce.reverse(),"beforeRouteLeave",G,ie);for(const $ of ce)$.leaveGuards.forEach(z=>{ne.push(bs(z,G,ie))});const T=b.bind(null,G,ie);return ne.push(T),ut(ne).then(()=>{ne=[];for(const $ of r.list())ne.push(bs($,G,ie));return ne.push(T),ut(ne)}).then(()=>{ne=vc(Oe,"beforeRouteUpdate",G,ie);for(const $ of Oe)$.updateGuards.forEach(z=>{ne.push(bs(z,G,ie))});return ne.push(T),ut(ne)}).then(()=>{ne=[];for(const $ of I)if($.beforeEnter)if(yn($.beforeEnter))for(const z of $.beforeEnter)ne.push(bs(z,G,ie));else ne.push(bs($.beforeEnter,G,ie));return ne.push(T),ut(ne)}).then(()=>(G.matched.forEach($=>$.enterCallbacks={}),ne=vc(I,"beforeRouteEnter",G,ie,E),ne.push(T),ut(ne))).then(()=>{ne=[];for(const $ of o.list())ne.push(bs($,G,ie));return ne.push(T),ut(ne)}).catch($=>Bn($,8)?$:Promise.reject($))}function C(G,ie,ne){l.list().forEach(ce=>E(()=>ce(G,ie,ne)))}function w(G,ie,ne,ce,Oe){const I=R(G,ie);if(I)return I;const T=ie===fs,$=Oi?history.state:{};ne&&(ce||T?i.replace(G.fullPath,Fe({scroll:T&&$&&$.scroll},Oe)):i.push(G.fullPath,Oe)),c.value=G,Gt(G,ie,ne,T),Yt()}let _;function Te(){_||(_=i.listen((G,ie,ne)=>{if(!Tt.listening)return;const ce=x(G),Oe=H(ce);if(Oe){k(Fe(Oe,{replace:!0,force:!0}),ce).catch(zr);return}u=ce;const I=c.value;Oi&&gw(If(I.fullPath,ne.delta),yl()),S(ce,I).catch(T=>Bn(T,12)?T:Bn(T,2)?(k(Fe(V(T.to),{force:!0}),ce).then($=>{Bn($,20)&&!ne.delta&&ne.type===fo.pop&&i.go(-1,!1)}).catch(zr),Promise.reject()):(ne.delta&&i.go(-ne.delta,!1),le(T,ce,I))).then(T=>{T=T||w(ce,I,!1),T&&(ne.delta&&!Bn(T,8)?i.go(-ne.delta,!1):ne.type===fo.pop&&Bn(T,20)&&i.go(-1,!1)),C(ce,I,T)}).catch(zr)}))}let ae=Dr(),Ce=Dr(),_e;function le(G,ie,ne){Yt(G);const ce=Ce.list();return ce.length?ce.forEach(Oe=>Oe(G,ie,ne)):console.error(G),Promise.reject(G)}function Vt(){return _e&&c.value!==fs?Promise.resolve():new Promise((G,ie)=>{ae.add([G,ie])})}function Yt(G){return _e||(_e=!G,Te(),ae.list().forEach(([ie,ne])=>G?ne(G):ie()),ae.reset()),G}function Gt(G,ie,ne,ce){const{scrollBehavior:Oe}=t;if(!Oi||!Oe)return Promise.resolve();const I=!ne&&_w(If(G.fullPath,0))||(ce||!ne)&&history.state&&history.state.scroll||null;return ul().then(()=>Oe(G,ie,I)).then(T=>T&&pw(T)).catch(T=>le(T,G,ie))}const We=G=>i.go(G);let Qe;const kn=new Set,Tt={currentRoute:c,listening:!0,addRoute:y,removeRoute:A,clearRoutes:e.clearRoutes,hasRoute:N,getRoutes:F,resolve:x,options:t,push:D,replace:P,go:We,back:()=>We(-1),forward:()=>We(1),beforeEach:r.add,beforeResolve:o.add,afterEach:l.add,onError:Ce.add,isReady:Vt,install(G){const ie=this;G.component("RouterLink",Bw),G.component("RouterView",qg),G.config.globalProperties.$router=ie,Object.defineProperty(G.config.globalProperties,"$route",{enumerable:!0,get:()=>de(c)}),Oi&&!Qe&&c.value===fs&&(Qe=!0,D(i.location).catch(Oe=>{}));const ne={};for(const Oe in fs)Object.defineProperty(ne,Oe,{get:()=>c.value[Oe],enumerable:!0});G.provide(vl,ie),G.provide(Lu,Ip(ne)),G.provide(Kc,c);const ce=G.unmount;kn.add(G),G.unmount=function(){kn.delete(G),kn.size<1&&(u=fs,_&&_(),_=null,c.value=fs,Qe=!1,_e=!1),ce()}}};function ut(G){return G.reduce((ie,ne)=>ie.then(()=>E(ne)),Promise.resolve())}return Tt}function Gw(t,e){const n=[],s=[],i=[],r=Math.max(e.matched.length,t.matched.length);for(let o=0;o<r;o++){const l=e.matched[o];l&&(t.matched.find(u=>Qi(u,l))?s.push(l):n.push(l));const c=t.matched[o];c&&(e.matched.find(u=>Qi(u,c))||i.push(c))}return[n,s,i]}function or(){return an(vl)}function Kg(t){return an(Lu)}const gt=(t,e)=>{const n=t.__vccOpts||t;for(const[s,i]of e)n[s]=i;return n},zw={key:0,class:"connection-status offline"},Ww={key:1,class:"connection-status firestore-error"},Qw={key:2,class:"connection-status checking"},Yw={key:3,class:"connection-status online"},Jw={__name:"ConnectionStatus",setup(t){const e=ge(navigator.onLine),n=ge(!1),s=ge("checking");let i=null;const r=async()=>{try{const{db:u}=await Gi(async()=>{const{db:y}=await Promise.resolve().then(()=>V1);return{db:y}},void 0),{doc:d,getDoc:m}=await Gi(async()=>{const{doc:y,getDoc:A}=await Promise.resolve().then(()=>yv);return{doc:y,getDoc:A}},void 0),g=d(u,"test","connection");await m(g),s.value="connected",console.log("✅ Firestore connection verified")}catch(u){s.value="error",console.warn("⚠️ Firestore connection failed:",u.code||u.message)}},o=()=>{navigator.onLine?setTimeout(r,1e3):s.value="offline"},l=()=>{e.value=!0,n.value=!0,s.value="checking",o(),i&&clearTimeout(i),i=setTimeout(()=>{n.value=!1},3e3)},c=()=>{e.value=!1,n.value=!1,s.value="offline",i&&clearTimeout(i)};return En(()=>{window.addEventListener("online",l),window.addEventListener("offline",c),o()}),So(()=>{window.removeEventListener("online",l),window.removeEventListener("offline",c),i&&clearTimeout(i)}),(u,d)=>e.value?s.value==="error"?(O(),M("div",Ww,d[1]||(d[1]=[An('<div class="status-content" data-v-42d09853><div class="status-icon" data-v-42d09853>⚠️</div><div class="status-text" data-v-42d09853><span class="status-title" data-v-42d09853>Masalah Koneksi Database</span><span class="status-message" data-v-42d09853>Beberapa fitur mungkin tidak tersedia</span></div></div>',1)]))):s.value==="checking"?(O(),M("div",Qw,d[2]||(d[2]=[An('<div class="status-content" data-v-42d09853><div class="status-icon" data-v-42d09853>🔄</div><div class="status-text" data-v-42d09853><span class="status-title" data-v-42d09853>Memeriksa Koneksi</span><span class="status-message" data-v-42d09853>Menguji koneksi database...</span></div></div>',1)]))):n.value?(O(),M("div",Yw,d[3]||(d[3]=[An('<div class="status-content" data-v-42d09853><div class="status-icon" data-v-42d09853>✅</div><div class="status-text" data-v-42d09853><span class="status-title" data-v-42d09853>Terhubung</span><span class="status-message" data-v-42d09853>Semua fitur tersedia</span></div></div>',1)]))):X("",!0):(O(),M("div",zw,d[0]||(d[0]=[An('<div class="status-content" data-v-42d09853><div class="status-icon" data-v-42d09853>📡</div><div class="status-text" data-v-42d09853><span class="status-title" data-v-42d09853>Mode Offline</span><span class="status-message" data-v-42d09853>Tidak ada koneksi internet</span></div></div>',1)])))}},Xw=gt(Jw,[["__scopeId","data-v-42d09853"]]),Zw={__name:"PageTransition",props:{name:{type:String,default:"fade"},mode:{type:String,default:"out-in"},appear:{type:Boolean,default:!0},duration:{type:Number,default:300},delay:{type:Number,default:0}},emits:["before-enter","enter","after-enter","before-leave","leave","after-leave"],setup(t,{emit:e}){const n=t,s=e,i=Ie(()=>n.name),r=m=>{n.delay>0&&(m.style.animationDelay=`${n.delay}ms`),s("before-enter",m)},o=(m,g)=>{s("enter",m,g),setTimeout(g,n.duration)},l=m=>{m.style.animationDelay="",s("after-enter",m)},c=m=>{s("before-leave",m)},u=(m,g)=>{s("leave",m,g),setTimeout(g,n.duration)},d=m=>{s("after-leave",m)};return En(()=>{console.log(`🎬 PageTransition initialized: ${n.name}`)}),(m,g)=>(O(),Wt(tk,{name:i.value,mode:t.mode,appear:t.appear,onBeforeEnter:r,onEnter:o,onAfterEnter:l,onBeforeLeave:c,onLeave:u,onAfterLeave:d},{default:Ht(()=>[Wp(m.$slots,"default",{},void 0,!0)]),_:3},8,["name","mode","appear"]))}},eI=gt(Zw,[["__scopeId","data-v-d647b08b"]]),tI={key:0,class:"error-monitor"},nI={class:"monitor-content"},sI={class:"status-section"},iI={class:"status-grid"},rI={class:"status-value"},oI={class:"status-item"},aI={class:"status-value"},lI={class:"status-item"},cI={class:"status-value"},uI={key:0,class:"status-item"},dI={class:"status-value error-text"},hI={class:"action-buttons"},fI=["disabled"],mI={class:"status-section"},pI={class:"status-grid"},gI={class:"status-value"},_I={class:"status-item"},yI={class:"status-value"},vI={class:"status-item"},bI={class:"status-value"},EI={class:"action-buttons"},kI=["disabled"],wI={class:"status-section"},II={class:"status-grid"},SI={class:"status-item"},TI={class:"status-value"},AI={class:"status-item"},RI={class:"status-value"},CI={class:"status-section"},PI={class:"logs-container"},DI={class:"log-time"},OI={class:"log-message"},NI={__name:"ErrorMonitor",setup(t){const e=Kg(),n=ge(!1),s=ge(!1),i=ge(!1),r=Cs({initialized:!1,retryCount:0,maxRetries:3}),o=Cs({errorCount:0,lastError:null}),l=Cs({enabled:!1,bypassMode:!1,hasApiKey:!1}),c=ge([]),u=ge("Ready"),d=Ie(()=>e),m=()=>{n.value=!n.value},g=async()=>{try{if(window.getFirebaseErrorStats){const R=window.getFirebaseErrorStats();Object.assign(o,R),Object.assign(r,R.firestoreHealth)}}catch(R){console.error("Error updating Firestore status:",R)}},y=()=>{l.enabled=!0,l.bypassMode=!0,l.hasApiKey=!0},A=async()=>{s.value=!0;try{if(window.testFirestoreConnectivity){const R=await window.testFirestoreConnectivity();x(R?"Firestore test passed":"Firestore test failed",R?"info":"error")}else x("Firestore test function not available","warn")}catch(R){x(`Firestore test error: ${R.message}`,"error")}finally{s.value=!1,await g()}},F=async()=>{i.value=!0;try{if(window.quickAITest){const R=await window.quickAITest();x(R.success?"AI test passed":`AI test failed: ${R.error}`,R.success?"info":"error")}else x("AI test function not available","warn")}catch(R){x(`AI test error: ${R.message}`,"error")}finally{i.value=!1}},N=async()=>{try{window.resetFirebaseErrorCount&&(window.resetFirebaseErrorCount(),x("Firebase error count reset","info"),await g())}catch(R){x(`Error resetting: ${R.message}`,"error")}},x=(R,D="info")=>{c.value.unshift({message:R,level:D,timestamp:new Date}),c.value.length>20&&(c.value=c.value.slice(0,20))},V=R=>R.toLocaleTimeString();return En(async()=>{y(),await g(),setInterval(g,5e3);const R=D=>{D.ctrlKey&&D.shiftKey&&D.key==="D"&&m()};return document.addEventListener("keydown",R),()=>{document.removeEventListener("keydown",R)}}),typeof window<"u"&&(window.toggleErrorMonitor=m,console.log("🔧 Error Monitor available: Ctrl+Shift+D or window.toggleErrorMonitor()")),(R,D)=>n.value?(O(),M("div",tI,[f("div",{class:"monitor-header"},[D[0]||(D[0]=f("h3",null,"🔧 System Status Monitor",-1)),f("button",{onClick:m,class:"close-btn"},"×")]),f("div",nI,[f("div",sI,[D[5]||(D[5]=f("h4",null,"🔥 Firestore Status",-1)),f("div",iI,[f("div",{class:Se(["status-item",{healthy:r.initialized,unhealthy:!r.initialized}])},[D[1]||(D[1]=f("span",{class:"status-label"},"Connection:",-1)),f("span",rI,j(r.initialized?"Healthy":"Disconnected"),1)],2),f("div",oI,[D[2]||(D[2]=f("span",{class:"status-label"},"Retry Count:",-1)),f("span",aI,j(r.retryCount)+"/"+j(r.maxRetries),1)]),f("div",lI,[D[3]||(D[3]=f("span",{class:"status-label"},"Error Count:",-1)),f("span",cI,j(o.errorCount),1)]),o.lastError?(O(),M("div",uI,[D[4]||(D[4]=f("span",{class:"status-label"},"Last Error:",-1)),f("span",dI,j(o.lastError.message),1)])):X("",!0)]),f("div",hI,[f("button",{onClick:A,class:"test-btn",disabled:s.value},j(s.value?"Testing...":"🧪 Test Connection"),9,fI),f("button",{onClick:N,class:"reset-btn"}," 🔄 Reset Errors ")])]),f("div",mI,[D[9]||(D[9]=f("h4",null,"🤖 AI System Status",-1)),f("div",pI,[f("div",{class:Se(["status-item",{healthy:l.enabled,unhealthy:!l.enabled}])},[D[6]||(D[6]=f("span",{class:"status-label"},"AI Enabled:",-1)),f("span",gI,j(l.enabled?"Yes":"No"),1)],2),f("div",_I,[D[7]||(D[7]=f("span",{class:"status-label"},"Bypass Mode:",-1)),f("span",yI,j(l.bypassMode?"Active":"Disabled"),1)]),f("div",vI,[D[8]||(D[8]=f("span",{class:"status-label"},"API Key:",-1)),f("span",bI,j(l.hasApiKey?"Configured":"Missing"),1)])]),f("div",EI,[f("button",{onClick:F,class:"test-btn",disabled:i.value},j(i.value?"Testing...":"🧪 Test AI"),9,kI)])]),f("div",wI,[D[12]||(D[12]=f("h4",null,"🛣️ Router Status",-1)),f("div",II,[f("div",SI,[D[10]||(D[10]=f("span",{class:"status-label"},"Current Route:",-1)),f("span",TI,j(d.value.name||d.value.path),1)]),f("div",AI,[D[11]||(D[11]=f("span",{class:"status-label"},"Transition:",-1)),f("span",RI,j(u.value),1)])])]),f("div",CI,[D[13]||(D[13]=f("h4",null,"📝 Recent Logs",-1)),f("div",PI,[(O(!0),M(Ae,null,ze(c.value,(P,H)=>(O(),M("div",{key:H,class:Se(["log-entry",P.level])},[f("span",DI,j(V(P.timestamp)),1),f("span",OI,j(P.message),1)],2))),128))])])])])):X("",!0)}},MI=gt(NI,[["__scopeId","data-v-5a6d651e"]]),xI={id:"app"},VI={__name:"App",setup(t){const e=Kg(),n=ge("fade"),s=(r,o)=>{if(!o.name)return"fade";const l={Login:0,Register:0,Dashboard:1,Diagnosis:2,Recommendations:3},c=l[r.name]||1,u=l[o.name]||1;return c>u?"slide-left":c<u?"slide-right":"fade"};Pn(e,(r,o)=>{n.value=s(r,o)},{flush:"pre"});const i=Ie(()=>!0);return(r,o)=>(O(),M("div",xI,[xe(Xw),xe(de(qg),null,{default:Ht(({Component:l,route:c})=>[xe(eI,{name:n.value,mode:"out-in",duration:300},{default:Ht(()=>[l?(O(),Wt(aE(l),{key:c.path})):X("",!0)]),_:2},1032,["name"])]),_:1}),i.value?(O(),Wt(MI,{key:0})):X("",!0)]))}};var Ff={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gg=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},LI=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],o=t[n++],l=t[n++],c=((i&7)<<18|(r&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const r=t[n++],o=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return e.join("")},zg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],o=i+1<t.length,l=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,d=r>>2,m=(r&3)<<4|l>>4;let g=(l&15)<<2|u>>6,y=u&63;c||(y=64,o||(g=64)),s.push(n[d],n[m],n[g],n[y])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Gg(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):LI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const m=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||l==null||u==null||m==null)throw new $I;const g=r<<2|l>>4;if(s.push(g),u!==64){const y=l<<4&240|u>>2;if(s.push(y),m!==64){const A=u<<6&192|m;s.push(A)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class $I extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const FI=function(t){const e=Gg(t);return zg.encodeByteArray(e,!0)},La=function(t){return FI(t).replace(/\./g,"")},Wg=function(t){try{return zg.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI=()=>UI().__FIREBASE_DEFAULTS__,jI=()=>{if(typeof process>"u"||typeof Ff>"u")return;const t=Ff.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},HI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Wg(t[1]);return e&&JSON.parse(e)},bl=()=>{try{return BI()||jI()||HI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Qg=t=>{var e,n;return(n=(e=bl())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},qI=t=>{const e=Qg(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Yg=()=>{var t;return(t=bl())===null||t===void 0?void 0:t.config},Jg=t=>{var e;return(e=bl())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[La(JSON.stringify(n)),La(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ot())}function WI(){var t;const e=(t=bl())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function QI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function YI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function JI(){const t=ot();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function XI(){return!WI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Xg(){try{return typeof indexedDB=="object"}catch{return!1}}function ZI(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var r;e(((r=i.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS="FirebaseError";class rs extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=eS,Object.setPrototypeOf(this,rs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ao.prototype.create)}}class Ao{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?tS(r,s):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new rs(i,l,s)}}function tS(t,e){return t.replace(nS,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const nS=/\{\$([^}]+)}/g;function sS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function $a(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],o=e[i];if(Uf(r)&&Uf(o)){if(!$a(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function Uf(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ro(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function xr(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[i,r]=s.split("=");e[decodeURIComponent(i)]=decodeURIComponent(r)}}),e}function Vr(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function iS(t,e){const n=new rS(t,e);return n.subscribe.bind(n)}class rS{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let i;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");oS(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:s},i.next===void 0&&(i.next=bc),i.error===void 0&&(i.error=bc),i.complete===void 0&&(i.complete=bc);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function oS(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function bc(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(t){return t&&t._delegate?t._delegate:t}class di{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new KI;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cS(e))try{this.getOrInitializeService({instanceIdentifier:Xs})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=Xs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xs){return this.instances.has(e)}getOptions(e=Xs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(r);s===l&&o.resolve(i)}return i}onInit(e,n){var s;const i=this.normalizeInstanceIdentifier(n),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:lS(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Xs){return this.component?this.component.multipleInstances?e:Xs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lS(t){return t===Xs?void 0:t}function cS(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new aS(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(De||(De={}));const dS={debug:De.DEBUG,verbose:De.VERBOSE,info:De.INFO,warn:De.WARN,error:De.ERROR,silent:De.SILENT},hS=De.INFO,fS={[De.DEBUG]:"log",[De.VERBOSE]:"log",[De.INFO]:"info",[De.WARN]:"warn",[De.ERROR]:"error"},mS=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=fS[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $u{constructor(e){this.name=e,this._logLevel=hS,this._logHandler=mS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in De))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,De.DEBUG,...e),this._logHandler(this,De.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,De.VERBOSE,...e),this._logHandler(this,De.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,De.INFO,...e),this._logHandler(this,De.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,De.WARN,...e),this._logHandler(this,De.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,De.ERROR,...e),this._logHandler(this,De.ERROR,...e)}}const pS=(t,e)=>e.some(n=>t instanceof n);let Bf,jf;function gS(){return Bf||(Bf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _S(){return jf||(jf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Zg=new WeakMap,Gc=new WeakMap,e_=new WeakMap,Ec=new WeakMap,Fu=new WeakMap;function yS(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",o)},r=()=>{n(Ps(t.result)),i()},o=()=>{s(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Zg.set(n,t)}).catch(()=>{}),Fu.set(e,t),e}function vS(t){if(Gc.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",o),t.removeEventListener("abort",o)},r=()=>{n(),i()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",o),t.addEventListener("abort",o)});Gc.set(t,e)}let zc={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Gc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||e_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ps(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function bS(t){zc=t(zc)}function ES(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(kc(this),e,...n);return e_.set(s,e.sort?e.sort():[e]),Ps(s)}:_S().includes(t)?function(...e){return t.apply(kc(this),e),Ps(Zg.get(this))}:function(...e){return Ps(t.apply(kc(this),e))}}function kS(t){return typeof t=="function"?ES(t):(t instanceof IDBTransaction&&vS(t),pS(t,gS())?new Proxy(t,zc):t)}function Ps(t){if(t instanceof IDBRequest)return yS(t);if(Ec.has(t))return Ec.get(t);const e=kS(t);return e!==t&&(Ec.set(t,e),Fu.set(e,t)),e}const kc=t=>Fu.get(t);function wS(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(t,e),l=Ps(o);return s&&o.addEventListener("upgradeneeded",c=>{s(Ps(o.result),c.oldVersion,c.newVersion,Ps(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{r&&c.addEventListener("close",()=>r()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const IS=["get","getKey","getAll","getAllKeys","count"],SS=["put","add","delete","clear"],wc=new Map;function Hf(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(wc.get(e))return wc.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=SS.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||IS.includes(n)))return;const r=async function(o,...l){const c=this.transaction(o,i?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),i&&c.done]))[0]};return wc.set(e,r),r}bS(t=>({...t,get:(e,n,s)=>Hf(e,n)||t.get(e,n,s),has:(e,n)=>!!Hf(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(AS(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function AS(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Wc="@firebase/app",qf="0.10.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=new $u("@firebase/app"),RS="@firebase/app-compat",CS="@firebase/analytics-compat",PS="@firebase/analytics",DS="@firebase/app-check-compat",OS="@firebase/app-check",NS="@firebase/auth",MS="@firebase/auth-compat",xS="@firebase/database",VS="@firebase/database-compat",LS="@firebase/functions",$S="@firebase/functions-compat",FS="@firebase/installations",US="@firebase/installations-compat",BS="@firebase/messaging",jS="@firebase/messaging-compat",HS="@firebase/performance",qS="@firebase/performance-compat",KS="@firebase/remote-config",GS="@firebase/remote-config-compat",zS="@firebase/storage",WS="@firebase/storage-compat",QS="@firebase/firestore",YS="@firebase/vertexai-preview",JS="@firebase/firestore-compat",XS="firebase",ZS="10.12.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fa="[DEFAULT]",eT={[Wc]:"fire-core",[RS]:"fire-core-compat",[PS]:"fire-analytics",[CS]:"fire-analytics-compat",[OS]:"fire-app-check",[DS]:"fire-app-check-compat",[NS]:"fire-auth",[MS]:"fire-auth-compat",[xS]:"fire-rtdb",[VS]:"fire-rtdb-compat",[LS]:"fire-fn",[$S]:"fire-fn-compat",[FS]:"fire-iid",[US]:"fire-iid-compat",[BS]:"fire-fcm",[jS]:"fire-fcm-compat",[HS]:"fire-perf",[qS]:"fire-perf-compat",[KS]:"fire-rc",[GS]:"fire-rc-compat",[zS]:"fire-gcs",[WS]:"fire-gcs-compat",[QS]:"fire-fst",[JS]:"fire-fst-compat",[YS]:"fire-vertex","fire-js":"fire-js",[XS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua=new Map,tT=new Map,Qc=new Map;function Kf(t,e){try{t.container.addComponent(e)}catch(n){hi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ji(t){const e=t.name;if(Qc.has(e))return hi.debug(`There were multiple attempts to register component ${e}.`),!1;Qc.set(e,t);for(const n of Ua.values())Kf(n,t);for(const n of tT.values())Kf(n,t);return!0}function El(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function nT(t,e,n=Fa){El(t,e).clearInstance(n)}function Rn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ds=new Ao("app","Firebase",sT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new di("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ds.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar=ZS;function t_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Fa,automaticDataCollectionEnabled:!1},e),i=s.name;if(typeof i!="string"||!i)throw Ds.create("bad-app-name",{appName:String(i)});if(n||(n=Yg()),!n)throw Ds.create("no-options");const r=Ua.get(i);if(r){if($a(n,r.options)&&$a(s,r.config))return r;throw Ds.create("duplicate-app",{appName:i})}const o=new uS(i);for(const c of Qc.values())o.addComponent(c);const l=new iT(n,s,o);return Ua.set(i,l),l}function n_(t=Fa){const e=Ua.get(t);if(!e&&t===Fa&&Yg())return t_();if(!e)throw Ds.create("no-app",{appName:t});return e}function Os(t,e,n){var s;let i=(s=eT[t])!==null&&s!==void 0?s:t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const l=[`Unable to register library "${i}" with version "${e}":`];r&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),hi.warn(l.join(" "));return}Ji(new di(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT="firebase-heartbeat-database",oT=1,mo="firebase-heartbeat-store";let Ic=null;function s_(){return Ic||(Ic=wS(rT,oT,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(mo)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ds.create("idb-open",{originalErrorMessage:t.message})})),Ic}async function aT(t){try{const n=(await s_()).transaction(mo),s=await n.objectStore(mo).get(i_(t));return await n.done,s}catch(e){if(e instanceof rs)hi.warn(e.message);else{const n=Ds.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});hi.warn(n.message)}}}async function Gf(t,e){try{const s=(await s_()).transaction(mo,"readwrite");await s.objectStore(mo).put(e,i_(t)),await s.done}catch(n){if(n instanceof rs)hi.warn(n.message);else{const s=Ds.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});hi.warn(s.message)}}}function i_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT=1024,cT=30*24*60*60*1e3;class uT{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new hT(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=zf();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=cT}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=zf(),{heartbeatsToSend:s,unsentEntries:i}=dT(this._heartbeatsCache.heartbeats),r=La(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function zf(){return new Date().toISOString().substring(0,10)}function dT(t,e=lT){const n=[];let s=t.slice();for(const i of t){const r=n.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),Wf(n)>e){r.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Wf(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class hT{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Xg()?ZI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await aT(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Gf(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Gf(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Wf(t){return La(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fT(t){Ji(new di("platform-logger",e=>new TS(e),"PRIVATE")),Ji(new di("heartbeat",e=>new uT(e),"PRIVATE")),Os(Wc,qf,t),Os(Wc,qf,"esm2017"),Os("fire-js","")}fT("");function Uu(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n}function r_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const mT=r_,o_=new Ao("auth","Firebase",r_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ba=new $u("@firebase/auth");function pT(t,...e){Ba.logLevel<=De.WARN&&Ba.warn(`Auth (${ar}): ${t}`,...e)}function ba(t,...e){Ba.logLevel<=De.ERROR&&Ba.error(`Auth (${ar}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(t,...e){throw Bu(t,...e)}function Dn(t,...e){return Bu(t,...e)}function a_(t,e,n){const s=Object.assign(Object.assign({},mT()),{[e]:n});return new Ao("auth","Firebase",s).create(e,{appName:t.name})}function Jn(t){return a_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Bu(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return o_.create(t,...e)}function Ee(t,e,...n){if(!t)throw Bu(e,...n)}function Gn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ba(e),new Error(e)}function ns(t,e){t||Gn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yc(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function gT(){return Qf()==="http:"||Qf()==="https:"}function Qf(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(gT()||QI()||"connection"in navigator)?navigator.onLine:!0}function yT(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n){this.shortDelay=e,this.longDelay=n,ns(n>e,"Short delay should be less than long delay!"),this.isMobile=zI()||YI()}get(){return _T()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(t,e){ns(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT=new Co(3e4,6e4);function os(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function as(t,e,n,s,i={}){return c_(t,i,async()=>{let r={},o={};s&&(e==="GET"?o=s:r={body:JSON.stringify(s)});const l=Ro(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),l_.fetch()(u_(t,t.config.apiHost,n,l),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},r))})}async function c_(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},vT),e);try{const i=new kT(t),r=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw ca(t,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const l=r.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw ca(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw ca(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw ca(t,"user-disabled",o);const d=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw a_(t,d,u);vn(t,d)}}catch(i){if(i instanceof rs)throw i;vn(t,"network-request-failed",{message:String(i)})}}async function Po(t,e,n,s,i={}){const r=await as(t,e,n,s,i);return"mfaPendingCredential"in r&&vn(t,"multi-factor-auth-required",{_serverResponse:r}),r}function u_(t,e,n,s){const i=`${e}${n}?${s}`;return t.config.emulator?ju(t.config,i):`${t.config.apiScheme}://${i}`}function ET(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class kT{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Dn(this.auth,"network-request-failed")),bT.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ca(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const i=Dn(t,e,s);return i.customData._tokenResponse=n,i}function Yf(t){return t!==void 0&&t.enterprise!==void 0}class wT{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return ET(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function IT(t,e){return as(t,"GET","/v2/recaptchaConfig",os(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ST(t,e){return as(t,"POST","/v1/accounts:delete",e)}async function d_(t,e){return as(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function TT(t,e=!1){const n=St(t),s=await n.getIdToken(e),i=Hu(s);Ee(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,o=r==null?void 0:r.sign_in_provider;return{claims:i,token:s,authTime:Qr(Sc(i.auth_time)),issuedAtTime:Qr(Sc(i.iat)),expirationTime:Qr(Sc(i.exp)),signInProvider:o||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function Sc(t){return Number(t)*1e3}function Hu(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return ba("JWT malformed, contained fewer than 3 sections"),null;try{const i=Wg(n);return i?JSON.parse(i):(ba("Failed to decode base64 JWT payload"),null)}catch(i){return ba("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Jf(t){const e=Hu(t);return Ee(e,"internal-error"),Ee(typeof e.exp<"u","internal-error"),Ee(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function po(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof rs&&AT(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function AT({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Qr(this.lastLoginAt),this.creationTime=Qr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ja(t){var e;const n=t.auth,s=await t.getIdToken(),i=await po(t,d_(n,{idToken:s}));Ee(i==null?void 0:i.users.length,n,"internal-error");const r=i.users[0];t._notifyReloadListener(r);const o=!((e=r.providerUserInfo)===null||e===void 0)&&e.length?h_(r.providerUserInfo):[],l=PT(t.providerData,o),c=t.isAnonymous,u=!(t.email&&r.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,m={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:l,metadata:new Jc(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(t,m)}async function CT(t){const e=St(t);await ja(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function PT(t,e){return[...t.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function h_(t){return t.map(e=>{var{providerId:n}=e,s=Uu(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DT(t,e){const n=await c_(t,{},async()=>{const s=Ro({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,o=u_(t,i,"/v1/token",`key=${r}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",l_.fetch()(o,{method:"POST",headers:l,body:s})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function OT(t,e){return as(t,"POST","/v2/accounts:revokeToken",os(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ee(e.idToken,"internal-error"),Ee(typeof e.idToken<"u","internal-error"),Ee(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Jf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ee(e.length!==0,"internal-error");const n=Jf(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ee(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:i,expiresIn:r}=await DT(e,n);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:i,expirationTime:r}=n,o=new Bi;return s&&(Ee(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),i&&(Ee(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),r&&(Ee(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bi,this.toJSON())}_performRefresh(){return Gn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ms(t,e){Ee(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class zn{constructor(e){var{uid:n,auth:s,stsTokenManager:i}=e,r=Uu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new RT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Jc(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await po(this,this.stsTokenManager.getToken(this.auth,e));return Ee(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return TT(this,e)}reload(){return CT(this)}_assign(e){this!==e&&(Ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new zn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await ja(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Rn(this.auth.app))return Promise.reject(Jn(this.auth));const e=await this.getIdToken();return await po(this,ST(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,i,r,o,l,c,u,d;const m=(s=n.displayName)!==null&&s!==void 0?s:void 0,g=(i=n.email)!==null&&i!==void 0?i:void 0,y=(r=n.phoneNumber)!==null&&r!==void 0?r:void 0,A=(o=n.photoURL)!==null&&o!==void 0?o:void 0,F=(l=n.tenantId)!==null&&l!==void 0?l:void 0,N=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,x=(u=n.createdAt)!==null&&u!==void 0?u:void 0,V=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:R,emailVerified:D,isAnonymous:P,providerData:H,stsTokenManager:k}=n;Ee(R&&k,e,"internal-error");const b=Bi.fromJSON(this.name,k);Ee(typeof R=="string",e,"internal-error"),ms(m,e.name),ms(g,e.name),Ee(typeof D=="boolean",e,"internal-error"),Ee(typeof P=="boolean",e,"internal-error"),ms(y,e.name),ms(A,e.name),ms(F,e.name),ms(N,e.name),ms(x,e.name),ms(V,e.name);const E=new zn({uid:R,auth:e,email:g,emailVerified:D,displayName:m,isAnonymous:P,photoURL:A,phoneNumber:y,tenantId:F,stsTokenManager:b,createdAt:x,lastLoginAt:V});return H&&Array.isArray(H)&&(E.providerData=H.map(S=>Object.assign({},S))),N&&(E._redirectEventId=N),E}static async _fromIdTokenResponse(e,n,s=!1){const i=new Bi;i.updateFromServerResponse(n);const r=new zn({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await ja(r),r}static async _fromGetAccountInfoResponse(e,n,s){const i=n.users[0];Ee(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?h_(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(r!=null&&r.length),l=new Bi;l.updateFromIdToken(s);const c=new zn({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new Jc(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(r!=null&&r.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xf=new Map;function Wn(t){ns(t instanceof Function,"Expected a class definition");let e=Xf.get(t);return e?(ns(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Xf.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}f_.type="NONE";const Zf=f_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ea(t,e,n){return`firebase:${t}:${e}:${n}`}class ji{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=Ea(this.userKey,i.apiKey,r),this.fullPersistenceKey=Ea("persistence",i.apiKey,r),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?zn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new ji(Wn(Zf),e,s);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let r=i[0]||Wn(Zf);const o=Ea(s,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){const m=zn._fromJSON(e,d);u!==r&&(l=m),r=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!r._shouldAllowMigration||!c.length?new ji(r,e,s):(r=c[0],l&&await r._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==r)try{await u._remove(o)}catch{}})),new ji(r,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function em(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(g_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(m_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(y_(e))return"Blackberry";if(v_(e))return"Webos";if(qu(e))return"Safari";if((e.includes("chrome/")||p_(e))&&!e.includes("edge/"))return"Chrome";if(__(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function m_(t=ot()){return/firefox\//i.test(t)}function qu(t=ot()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function p_(t=ot()){return/crios\//i.test(t)}function g_(t=ot()){return/iemobile/i.test(t)}function __(t=ot()){return/android/i.test(t)}function y_(t=ot()){return/blackberry/i.test(t)}function v_(t=ot()){return/webos/i.test(t)}function kl(t=ot()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function NT(t=ot()){var e;return kl(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function MT(){return JI()&&document.documentMode===10}function b_(t=ot()){return kl(t)||__(t)||v_(t)||y_(t)||/windows phone/i.test(t)||g_(t)}function xT(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E_(t,e=[]){let n;switch(t){case"Browser":n=em(ot());break;case"Worker":n=`${em(ot())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ar}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=r=>new Promise((o,l)=>{try{const c=e(r);o(c)}catch(c){l(c)}});s.onAbort=n,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LT(t,e={}){return as(t,"GET","/v2/passwordPolicy",os(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $T=6;class FT{constructor(e){var n,s,i,r;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:$T,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(r=e.forceUpgradeOnSignin)!==null&&r!==void 0?r:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,s,i,r,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(s=c.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(r=c.containsUppercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(e,n,s,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tm(this),this.idTokenSubscription=new tm(this),this.beforeStateQueue=new VT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=o_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Wn(n)),this._initializationPromise=this.queue(async()=>{var s,i;if(!this._deleted&&(this.persistenceManager=await ji.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await d_(this,{idToken:e}),s=await zn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Rn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let i=s,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(i=c.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await ja(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=yT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Rn(this.app))return Promise.reject(Jn(this));const n=e?St(e):null;return n&&Ee(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Rn(this.app)?Promise.reject(Jn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Rn(this.app)?Promise.reject(Jn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await LT(this),n=new FT(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ao("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await OT(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Wn(e)||this._popupRedirectResolver;Ee(n,this,"argument-error"),this.redirectPersistenceManager=await ji.create(this,[Wn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,i){if(this._deleted)return()=>{};const r=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ee(l,this,"internal-error"),l.then(()=>{o||r(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,s,i);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=E_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(n["X-Firebase-Client"]=s);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&pT(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Bs(t){return St(t)}class tm{constructor(e){this.auth=e,this.observer=null,this.addObserver=iS(n=>this.observer=n)}get next(){return Ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wl={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function BT(t){wl=t}function k_(t){return wl.loadJS(t)}function jT(){return wl.recaptchaEnterpriseScript}function HT(){return wl.gapiScript}function qT(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const KT="recaptcha-enterprise",GT="NO_RECAPTCHA";class zT{constructor(e){this.type=KT,this.auth=Bs(e)}async verify(e="verify",n=!1){async function s(r){if(!n){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(o,l)=>{IT(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new wT(c);return r.tenantId==null?r._agentRecaptchaConfig=u:r._tenantRecaptchaConfigs[r.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function i(r,o,l){const c=window.grecaptcha;Yf(c)?c.enterprise.ready(()=>{c.enterprise.execute(r,{action:e}).then(u=>{o(u)}).catch(()=>{o(GT)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((r,o)=>{s(this.auth).then(l=>{if(!n&&Yf(window.grecaptcha))i(l,r,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=jT();c.length!==0&&(c+=l),k_(c).then(()=>{i(l,r,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function nm(t,e,n,s=!1){const i=new zT(t);let r;try{r=await i.verify(n)}catch{r=await i.verify(n,!0)}const o=Object.assign({},e);return s?Object.assign(o,{captchaResp:r}):Object.assign(o,{captchaResponse:r}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ha(t,e,n,s){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await nm(t,e,n,n==="getOobCode");return s(t,r)}else return s(t,e).catch(async r=>{if(r.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await nm(t,e,n,n==="getOobCode");return s(t,o)}else return Promise.reject(r)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(t,e){const n=El(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),r=n.getOptions();if($a(r,e??{}))return i;vn(i,"already-initialized")}return n.initialize({options:e})}function QT(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(Wn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function YT(t,e,n){const s=Bs(t);Ee(s._canInitEmulator,s,"emulator-config-failed"),Ee(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!1,r=w_(e),{host:o,port:l}=JT(e),c=l===null?"":`:${l}`;s.config.emulator={url:`${r}//${o}${c}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:l,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})}),XT()}function w_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function JT(t){const e=w_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:sm(s.substr(r.length+1))}}else{const[r,o]=s.split(":");return{host:r,port:sm(o)}}}function sm(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function XT(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Gn("not implemented")}_getIdTokenResponse(e){return Gn("not implemented")}_linkToIdToken(e,n){return Gn("not implemented")}_getReauthenticationResolver(e){return Gn("not implemented")}}async function ZT(t,e){return as(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eA(t,e){return Po(t,"POST","/v1/accounts:signInWithPassword",os(t,e))}async function tA(t,e){return as(t,"POST","/v1/accounts:sendOobCode",os(t,e))}async function nA(t,e){return tA(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sA(t,e){return Po(t,"POST","/v1/accounts:signInWithEmailLink",os(t,e))}async function iA(t,e){return Po(t,"POST","/v1/accounts:signInWithEmailLink",os(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go extends Ku{constructor(e,n,s,i=null){super("password",s),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new go(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new go(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ha(e,n,"signInWithPassword",eA);case"emailLink":return sA(e,{email:this._email,oobCode:this._password});default:vn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ha(e,s,"signUpPassword",ZT);case"emailLink":return iA(e,{idToken:n,email:this._email,oobCode:this._password});default:vn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hi(t,e){return Po(t,"POST","/v1/accounts:signInWithIdp",os(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA="http://localhost";class fi extends Ku{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new fi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):vn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i}=n,r=Uu(n,["providerId","signInMethod"]);if(!s||!i)return null;const o=new fi(s,i);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Hi(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,Hi(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Hi(e,n)}buildRequest(){const e={requestUri:rA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ro(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oA(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function aA(t){const e=xr(Vr(t)).link,n=e?xr(Vr(e)).deep_link_id:null,s=xr(Vr(t)).deep_link_id;return(s?xr(Vr(s)).link:null)||s||n||e||t}class Gu{constructor(e){var n,s,i,r,o,l;const c=xr(Vr(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(s=c.oobCode)!==null&&s!==void 0?s:null,m=oA((i=c.mode)!==null&&i!==void 0?i:null);Ee(u&&d&&m,"argument-error"),this.apiKey=u,this.operation=m,this.code=d,this.continueUrl=(r=c.continueUrl)!==null&&r!==void 0?r:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=aA(e);try{return new Gu(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(){this.providerId=lr.PROVIDER_ID}static credential(e,n){return go._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=Gu.parseLink(n);return Ee(s,"argument-error"),go._fromEmailAndCode(e,s.code,s.tenantId)}}lr.PROVIDER_ID="password";lr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";lr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do extends I_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends Do{constructor(){super("facebook.com")}static credential(e){return fi._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Es.credential(e.oauthAccessToken)}catch{return null}}}Es.FACEBOOK_SIGN_IN_METHOD="facebook.com";Es.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks extends Do{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return fi._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return ks.credential(n,s)}catch{return null}}}ks.GOOGLE_SIGN_IN_METHOD="google.com";ks.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws extends Do{constructor(){super("github.com")}static credential(e){return fi._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ws.credential(e.oauthAccessToken)}catch{return null}}}ws.GITHUB_SIGN_IN_METHOD="github.com";ws.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends Do{constructor(){super("twitter.com")}static credential(e,n){return fi._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Is.credential(n,s)}catch{return null}}}Is.TWITTER_SIGN_IN_METHOD="twitter.com";Is.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lA(t,e){return Po(t,"POST","/v1/accounts:signUp",os(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,i=!1){const r=await zn._fromIdTokenResponse(e,s,i),o=im(s);return new mi({user:r,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const i=im(s);return new mi({user:e,providerId:i,_tokenResponse:s,operationType:n})}}function im(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa extends rs{constructor(e,n,s,i){var r;super(n.code,n.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,qa.prototype),this.customData={appName:e.name,tenantId:(r=e.tenantId)!==null&&r!==void 0?r:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,i){return new qa(e,n,s,i)}}function S_(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?qa._fromErrorAndOperation(t,r,e,s):r})}async function cA(t,e,n=!1){const s=await po(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return mi._forOperation(t,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uA(t,e,n=!1){const{auth:s}=t;if(Rn(s.app))return Promise.reject(Jn(s));const i="reauthenticate";try{const r=await po(t,S_(s,i,e,t),n);Ee(r.idToken,s,"internal-error");const o=Hu(r.idToken);Ee(o,s,"internal-error");const{sub:l}=o;return Ee(t.uid===l,s,"user-mismatch"),mi._forOperation(t,i,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&vn(s,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T_(t,e,n=!1){if(Rn(t.app))return Promise.reject(Jn(t));const s="signIn",i=await S_(t,s,e),r=await mi._fromIdTokenResponse(t,s,i);return n||await t._updateCurrentUser(r.user),r}async function dA(t,e){return T_(Bs(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A_(t){const e=Bs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function hA(t,e,n){const s=Bs(t);await Ha(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",nA)}async function fA(t,e,n){if(Rn(t.app))return Promise.reject(Jn(t));const s=Bs(t),o=await Ha(s,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",lA).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&A_(t),c}),l=await mi._fromIdTokenResponse(s,"signIn",o);return await s._updateCurrentUser(l.user),l}function mA(t,e,n){return Rn(t.app)?Promise.reject(Jn(t)):dA(St(t),lr.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&A_(t),s})}function pA(t,e,n,s){return St(t).onIdTokenChanged(e,n,s)}function gA(t,e,n){return St(t).beforeAuthStateChanged(e,n)}function _A(t){return St(t).signOut()}const Ka="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ka,"1"),this.storage.removeItem(Ka),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA(){const t=ot();return qu(t)||kl(t)}const vA=1e3,bA=10;class C_ extends R_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=yA()&&xT(),this.fallbackToPolling=b_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),i=this.localCache[n];s!==i&&e(n,i,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const s=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(s);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!n)return}const i=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},r=this.storage.getItem(s);MT()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,bA):i()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},vA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}C_.type="LOCAL";const EA=C_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_ extends R_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}P_.type="SESSION";const D_=P_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kA(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const s=new Il(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:i,data:r}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const l=Array.from(o).map(async u=>u(n.origin,r)),c=await kA(l);n.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Il.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zu(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,o;return new Promise((l,c)=>{const u=zu("",20);i.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:i,onMessage(m){const g=m;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(d),r=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),l(g.data.response);break;default:clearTimeout(d),clearTimeout(r),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function On(){return window}function IA(t){On().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O_(){return typeof On().WorkerGlobalScope<"u"&&typeof On().importScripts=="function"}async function SA(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function TA(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function AA(){return O_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N_="firebaseLocalStorageDb",RA=1,Ga="firebaseLocalStorage",M_="fbase_key";class Oo{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Sl(t,e){return t.transaction([Ga],e?"readwrite":"readonly").objectStore(Ga)}function CA(){const t=indexedDB.deleteDatabase(N_);return new Oo(t).toPromise()}function Xc(){const t=indexedDB.open(N_,RA);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(Ga,{keyPath:M_})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(Ga)?e(s):(s.close(),await CA(),e(await Xc()))})})}async function rm(t,e,n){const s=Sl(t,!0).put({[M_]:e,value:n});return new Oo(s).toPromise()}async function PA(t,e){const n=Sl(t,!1).get(e),s=await new Oo(n).toPromise();return s===void 0?null:s.value}function om(t,e){const n=Sl(t,!0).delete(e);return new Oo(n).toPromise()}const DA=800,OA=3;class x_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Xc(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>OA)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return O_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Il._getInstance(AA()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await SA(),!this.activeServiceWorker)return;this.sender=new wA(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((n=s[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||TA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Xc();return await rm(e,Ka,"1"),await om(e,Ka),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>rm(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>PA(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>om(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const r=Sl(i,!1).getAll();return new Oo(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:r}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),DA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}x_.type="LOCAL";const NA=x_;new Co(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MA(t,e){return e?Wn(e):(Ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu extends Ku{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Hi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Hi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function xA(t){return T_(t.auth,new Wu(t),t.bypassAuthState)}function VA(t){const{auth:e,user:n}=t;return Ee(n,e,"internal-error"),uA(n,new Wu(t),t.bypassAuthState)}async function LA(t){const{auth:e,user:n}=t;return Ee(n,e,"internal-error"),cA(n,new Wu(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(e,n,s,i,r=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:i,tenantId:r,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xA;case"linkViaPopup":case"linkViaRedirect":return LA;case"reauthViaPopup":case"reauthViaRedirect":return VA;default:vn(this.auth,"internal-error")}}resolve(e){ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A=new Co(2e3,1e4);class Vi extends V_{constructor(e,n,s,i,r){super(e,n,i,r),this.provider=s,this.authWindow=null,this.pollId=null,Vi.currentPopupAction&&Vi.currentPopupAction.cancel(),Vi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ee(e,this.auth,"internal-error"),e}async onExecution(){ns(this.filter.length===1,"Popup operations only handle one event");const e=zu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Dn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Dn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Dn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$A.get())};e()}}Vi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA="pendingRedirect",ka=new Map;class UA extends V_{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=ka.get(this.auth._key());if(!e){try{const s=await BA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}ka.set(this.auth._key(),e)}return this.bypassAuthState||ka.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function BA(t,e){const n=qA(e),s=HA(t);if(!await s._isAvailable())return!1;const i=await s._get(n)==="true";return await s._remove(n),i}function jA(t,e){ka.set(t._key(),e)}function HA(t){return Wn(t._redirectPersistence)}function qA(t){return Ea(FA,t.config.apiKey,t.name)}async function KA(t,e,n=!1){if(Rn(t.app))return Promise.reject(Jn(t));const s=Bs(t),i=MA(s,e),o=await new UA(s,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA=10*60*1e3;class zA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!WA(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!L_(e)){const i=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(Dn(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=GA&&this.cachedEventUids.clear(),this.cachedEventUids.has(am(e))}saveEventToCache(e){this.cachedEventUids.add(am(e)),this.lastProcessedEventTime=Date.now()}}function am(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function L_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function WA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return L_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QA(t,e={}){return as(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,JA=/^https?/;async function XA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await QA(t);for(const n of e)try{if(ZA(n))return}catch{}vn(t,"unauthorized-domain")}function ZA(t){const e=Yc(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!JA.test(n))return!1;if(YA.test(t))return s===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0=new Co(3e4,6e4);function lm(){const t=On().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function t0(t){return new Promise((e,n)=>{var s,i,r;function o(){lm(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{lm(),n(Dn(t,"network-request-failed"))},timeout:e0.get()})}if(!((i=(s=On().gapi)===null||s===void 0?void 0:s.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((r=On().gapi)===null||r===void 0)&&r.load)o();else{const l=qT("iframefcb");return On()[l]=()=>{gapi.load?o():n(Dn(t,"network-request-failed"))},k_(`${HT()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw wa=null,e})}let wa=null;function n0(t){return wa=wa||t0(t),wa}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0=new Co(5e3,15e3),i0="__/auth/iframe",r0="emulator/auth/iframe",o0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},a0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function l0(t){const e=t.config;Ee(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ju(e,r0):`https://${t.config.authDomain}/${i0}`,s={apiKey:e.apiKey,appName:t.name,v:ar},i=a0.get(t.config.apiHost);i&&(s.eid=i);const r=t._getFrameworks();return r.length&&(s.fw=r.join(",")),`${n}?${Ro(s).slice(1)}`}async function c0(t){const e=await n0(t),n=On().gapi;return Ee(n,t,"internal-error"),e.open({where:document.body,url:l0(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:o0,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const o=Dn(t,"network-request-failed"),l=On().setTimeout(()=>{r(o)},s0.get());function c(){On().clearTimeout(l),i(s)}s.ping(c).then(c,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},d0=500,h0=600,f0="_blank",m0="http://localhost";class cm{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function p0(t,e,n,s=d0,i=h0){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let l="";const c=Object.assign(Object.assign({},u0),{width:s.toString(),height:i.toString(),top:r,left:o}),u=ot().toLowerCase();n&&(l=p_(u)?f0:n),m_(u)&&(e=e||m0,c.scrollbars="yes");const d=Object.entries(c).reduce((g,[y,A])=>`${g}${y}=${A},`,"");if(NT(u)&&l!=="_self")return g0(e||"",l),new cm(null);const m=window.open(e||"",l,d);Ee(m,t,"popup-blocked");try{m.focus()}catch{}return new cm(m)}function g0(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0="__/auth/handler",y0="emulator/auth/handler",v0=encodeURIComponent("fac");async function um(t,e,n,s,i,r){Ee(t.config.authDomain,t,"auth-domain-config-required"),Ee(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:ar,eventId:i};if(e instanceof I_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",sS(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries({}))o[d]=m}if(e instanceof Do){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${v0}=${encodeURIComponent(c)}`:"";return`${b0(t)}?${Ro(l).slice(1)}${u}`}function b0({config:t}){return t.emulator?ju(t,y0):`https://${t.authDomain}/${_0}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tc="webStorageSupport";class E0{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=D_,this._completeRedirectFn=KA,this._overrideRedirectResult=jA}async _openPopup(e,n,s,i){var r;ns((r=this.eventManagers[e._key()])===null||r===void 0?void 0:r.manager,"_initialize() not called before _openPopup()");const o=await um(e,n,s,Yc(),i);return p0(e,o,zu())}async _openRedirect(e,n,s,i){await this._originValidation(e);const r=await um(e,n,s,Yc(),i);return IA(r),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:r}=this.eventManagers[n];return i?Promise.resolve(i):(ns(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await c0(e),s=new zA(e);return n.register("authEvent",i=>(Ee(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Tc,{type:Tc},i=>{var r;const o=(r=i==null?void 0:i[0])===null||r===void 0?void 0:r[Tc];o!==void 0&&n(!!o),vn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=XA(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return b_()||qu()||kl()}}const k0=E0;var dm="@firebase/auth",hm="1.7.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function S0(t){Ji(new di("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=s.options;Ee(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:E_(t)},u=new UT(s,i,r,c);return QT(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),Ji(new di("auth-internal",e=>{const n=Bs(e.getProvider("auth").getImmediate());return(s=>new w0(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Os(dm,hm,I0(t)),Os(dm,hm,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T0=5*60,A0=Jg("authIdTokenMaxAge")||T0;let fm=null;const R0=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>A0)return;const i=n==null?void 0:n.token;fm!==i&&(fm=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function $_(t=n_()){const e=El(t,"auth");if(e.isInitialized())return e.getImmediate();const n=WT(t,{popupRedirectResolver:k0,persistence:[NA,EA,D_]}),s=Jg("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const o=R0(r.toString());gA(n,o,()=>o(n.currentUser)),pA(n,l=>o(l))}}const i=Qg("auth");return i&&YT(n,`http://${i}`),n}function C0(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}BT({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=i=>{const r=Dn("internal-error");r.customData=i,n(r)},s.type="text/javascript",s.charset="UTF-8",C0().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});S0("Browser");var mm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var oi,F_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,b){function E(){}E.prototype=b.prototype,k.D=b.prototype,k.prototype=new E,k.prototype.constructor=k,k.C=function(S,C,w){for(var _=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)_[Te-2]=arguments[Te];return b.prototype[C].apply(S,_)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,n),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(k,b,E){E||(E=0);var S=Array(16);if(typeof b=="string")for(var C=0;16>C;++C)S[C]=b.charCodeAt(E++)|b.charCodeAt(E++)<<8|b.charCodeAt(E++)<<16|b.charCodeAt(E++)<<24;else for(C=0;16>C;++C)S[C]=b[E++]|b[E++]<<8|b[E++]<<16|b[E++]<<24;b=k.g[0],E=k.g[1],C=k.g[2];var w=k.g[3],_=b+(w^E&(C^w))+S[0]+3614090360&4294967295;b=E+(_<<7&4294967295|_>>>25),_=w+(C^b&(E^C))+S[1]+3905402710&4294967295,w=b+(_<<12&4294967295|_>>>20),_=C+(E^w&(b^E))+S[2]+606105819&4294967295,C=w+(_<<17&4294967295|_>>>15),_=E+(b^C&(w^b))+S[3]+3250441966&4294967295,E=C+(_<<22&4294967295|_>>>10),_=b+(w^E&(C^w))+S[4]+4118548399&4294967295,b=E+(_<<7&4294967295|_>>>25),_=w+(C^b&(E^C))+S[5]+1200080426&4294967295,w=b+(_<<12&4294967295|_>>>20),_=C+(E^w&(b^E))+S[6]+2821735955&4294967295,C=w+(_<<17&4294967295|_>>>15),_=E+(b^C&(w^b))+S[7]+4249261313&4294967295,E=C+(_<<22&4294967295|_>>>10),_=b+(w^E&(C^w))+S[8]+1770035416&4294967295,b=E+(_<<7&4294967295|_>>>25),_=w+(C^b&(E^C))+S[9]+2336552879&4294967295,w=b+(_<<12&4294967295|_>>>20),_=C+(E^w&(b^E))+S[10]+4294925233&4294967295,C=w+(_<<17&4294967295|_>>>15),_=E+(b^C&(w^b))+S[11]+2304563134&4294967295,E=C+(_<<22&4294967295|_>>>10),_=b+(w^E&(C^w))+S[12]+1804603682&4294967295,b=E+(_<<7&4294967295|_>>>25),_=w+(C^b&(E^C))+S[13]+4254626195&4294967295,w=b+(_<<12&4294967295|_>>>20),_=C+(E^w&(b^E))+S[14]+2792965006&4294967295,C=w+(_<<17&4294967295|_>>>15),_=E+(b^C&(w^b))+S[15]+1236535329&4294967295,E=C+(_<<22&4294967295|_>>>10),_=b+(C^w&(E^C))+S[1]+4129170786&4294967295,b=E+(_<<5&4294967295|_>>>27),_=w+(E^C&(b^E))+S[6]+3225465664&4294967295,w=b+(_<<9&4294967295|_>>>23),_=C+(b^E&(w^b))+S[11]+643717713&4294967295,C=w+(_<<14&4294967295|_>>>18),_=E+(w^b&(C^w))+S[0]+3921069994&4294967295,E=C+(_<<20&4294967295|_>>>12),_=b+(C^w&(E^C))+S[5]+3593408605&4294967295,b=E+(_<<5&4294967295|_>>>27),_=w+(E^C&(b^E))+S[10]+38016083&4294967295,w=b+(_<<9&4294967295|_>>>23),_=C+(b^E&(w^b))+S[15]+3634488961&4294967295,C=w+(_<<14&4294967295|_>>>18),_=E+(w^b&(C^w))+S[4]+3889429448&4294967295,E=C+(_<<20&4294967295|_>>>12),_=b+(C^w&(E^C))+S[9]+568446438&4294967295,b=E+(_<<5&4294967295|_>>>27),_=w+(E^C&(b^E))+S[14]+3275163606&4294967295,w=b+(_<<9&4294967295|_>>>23),_=C+(b^E&(w^b))+S[3]+4107603335&4294967295,C=w+(_<<14&4294967295|_>>>18),_=E+(w^b&(C^w))+S[8]+1163531501&4294967295,E=C+(_<<20&4294967295|_>>>12),_=b+(C^w&(E^C))+S[13]+2850285829&4294967295,b=E+(_<<5&4294967295|_>>>27),_=w+(E^C&(b^E))+S[2]+4243563512&4294967295,w=b+(_<<9&4294967295|_>>>23),_=C+(b^E&(w^b))+S[7]+1735328473&4294967295,C=w+(_<<14&4294967295|_>>>18),_=E+(w^b&(C^w))+S[12]+2368359562&4294967295,E=C+(_<<20&4294967295|_>>>12),_=b+(E^C^w)+S[5]+4294588738&4294967295,b=E+(_<<4&4294967295|_>>>28),_=w+(b^E^C)+S[8]+2272392833&4294967295,w=b+(_<<11&4294967295|_>>>21),_=C+(w^b^E)+S[11]+1839030562&4294967295,C=w+(_<<16&4294967295|_>>>16),_=E+(C^w^b)+S[14]+4259657740&4294967295,E=C+(_<<23&4294967295|_>>>9),_=b+(E^C^w)+S[1]+2763975236&4294967295,b=E+(_<<4&4294967295|_>>>28),_=w+(b^E^C)+S[4]+1272893353&4294967295,w=b+(_<<11&4294967295|_>>>21),_=C+(w^b^E)+S[7]+4139469664&4294967295,C=w+(_<<16&4294967295|_>>>16),_=E+(C^w^b)+S[10]+3200236656&4294967295,E=C+(_<<23&4294967295|_>>>9),_=b+(E^C^w)+S[13]+681279174&4294967295,b=E+(_<<4&4294967295|_>>>28),_=w+(b^E^C)+S[0]+3936430074&4294967295,w=b+(_<<11&4294967295|_>>>21),_=C+(w^b^E)+S[3]+3572445317&4294967295,C=w+(_<<16&4294967295|_>>>16),_=E+(C^w^b)+S[6]+76029189&4294967295,E=C+(_<<23&4294967295|_>>>9),_=b+(E^C^w)+S[9]+3654602809&4294967295,b=E+(_<<4&4294967295|_>>>28),_=w+(b^E^C)+S[12]+3873151461&4294967295,w=b+(_<<11&4294967295|_>>>21),_=C+(w^b^E)+S[15]+530742520&4294967295,C=w+(_<<16&4294967295|_>>>16),_=E+(C^w^b)+S[2]+3299628645&4294967295,E=C+(_<<23&4294967295|_>>>9),_=b+(C^(E|~w))+S[0]+4096336452&4294967295,b=E+(_<<6&4294967295|_>>>26),_=w+(E^(b|~C))+S[7]+1126891415&4294967295,w=b+(_<<10&4294967295|_>>>22),_=C+(b^(w|~E))+S[14]+2878612391&4294967295,C=w+(_<<15&4294967295|_>>>17),_=E+(w^(C|~b))+S[5]+4237533241&4294967295,E=C+(_<<21&4294967295|_>>>11),_=b+(C^(E|~w))+S[12]+1700485571&4294967295,b=E+(_<<6&4294967295|_>>>26),_=w+(E^(b|~C))+S[3]+2399980690&4294967295,w=b+(_<<10&4294967295|_>>>22),_=C+(b^(w|~E))+S[10]+4293915773&4294967295,C=w+(_<<15&4294967295|_>>>17),_=E+(w^(C|~b))+S[1]+2240044497&4294967295,E=C+(_<<21&4294967295|_>>>11),_=b+(C^(E|~w))+S[8]+1873313359&4294967295,b=E+(_<<6&4294967295|_>>>26),_=w+(E^(b|~C))+S[15]+4264355552&4294967295,w=b+(_<<10&4294967295|_>>>22),_=C+(b^(w|~E))+S[6]+2734768916&4294967295,C=w+(_<<15&4294967295|_>>>17),_=E+(w^(C|~b))+S[13]+1309151649&4294967295,E=C+(_<<21&4294967295|_>>>11),_=b+(C^(E|~w))+S[4]+4149444226&4294967295,b=E+(_<<6&4294967295|_>>>26),_=w+(E^(b|~C))+S[11]+3174756917&4294967295,w=b+(_<<10&4294967295|_>>>22),_=C+(b^(w|~E))+S[2]+718787259&4294967295,C=w+(_<<15&4294967295|_>>>17),_=E+(w^(C|~b))+S[9]+3951481745&4294967295,k.g[0]=k.g[0]+b&4294967295,k.g[1]=k.g[1]+(C+(_<<21&4294967295|_>>>11))&4294967295,k.g[2]=k.g[2]+C&4294967295,k.g[3]=k.g[3]+w&4294967295}s.prototype.u=function(k,b){b===void 0&&(b=k.length);for(var E=b-this.blockSize,S=this.B,C=this.h,w=0;w<b;){if(C==0)for(;w<=E;)i(this,k,w),w+=this.blockSize;if(typeof k=="string"){for(;w<b;)if(S[C++]=k.charCodeAt(w++),C==this.blockSize){i(this,S),C=0;break}}else for(;w<b;)if(S[C++]=k[w++],C==this.blockSize){i(this,S),C=0;break}}this.h=C,this.o+=b},s.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var b=1;b<k.length-8;++b)k[b]=0;var E=8*this.o;for(b=k.length-8;b<k.length;++b)k[b]=E&255,E/=256;for(this.u(k),k=Array(16),b=E=0;4>b;++b)for(var S=0;32>S;S+=8)k[E++]=this.g[b]>>>S&255;return k};function r(k,b){var E=l;return Object.prototype.hasOwnProperty.call(E,k)?E[k]:E[k]=b(k)}function o(k,b){this.h=b;for(var E=[],S=!0,C=k.length-1;0<=C;C--){var w=k[C]|0;S&&w==b||(E[C]=w,S=!1)}this.g=E}var l={};function c(k){return-128<=k&&128>k?r(k,function(b){return new o([b|0],0>b?-1:0)}):new o([k|0],0>k?-1:0)}function u(k){if(isNaN(k)||!isFinite(k))return m;if(0>k)return N(u(-k));for(var b=[],E=1,S=0;k>=E;S++)b[S]=k/E|0,E*=4294967296;return new o(b,0)}function d(k,b){if(k.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(k.charAt(0)=="-")return N(d(k.substring(1),b));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=u(Math.pow(b,8)),S=m,C=0;C<k.length;C+=8){var w=Math.min(8,k.length-C),_=parseInt(k.substring(C,C+w),b);8>w?(w=u(Math.pow(b,w)),S=S.j(w).add(u(_))):(S=S.j(E),S=S.add(u(_)))}return S}var m=c(0),g=c(1),y=c(16777216);t=o.prototype,t.m=function(){if(F(this))return-N(this).m();for(var k=0,b=1,E=0;E<this.g.length;E++){var S=this.i(E);k+=(0<=S?S:4294967296+S)*b,b*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(A(this))return"0";if(F(this))return"-"+N(this).toString(k);for(var b=u(Math.pow(k,6)),E=this,S="";;){var C=D(E,b).g;E=x(E,C.j(b));var w=((0<E.g.length?E.g[0]:E.h)>>>0).toString(k);if(E=C,A(E))return w+S;for(;6>w.length;)w="0"+w;S=w+S}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function A(k){if(k.h!=0)return!1;for(var b=0;b<k.g.length;b++)if(k.g[b]!=0)return!1;return!0}function F(k){return k.h==-1}t.l=function(k){return k=x(this,k),F(k)?-1:A(k)?0:1};function N(k){for(var b=k.g.length,E=[],S=0;S<b;S++)E[S]=~k.g[S];return new o(E,~k.h).add(g)}t.abs=function(){return F(this)?N(this):this},t.add=function(k){for(var b=Math.max(this.g.length,k.g.length),E=[],S=0,C=0;C<=b;C++){var w=S+(this.i(C)&65535)+(k.i(C)&65535),_=(w>>>16)+(this.i(C)>>>16)+(k.i(C)>>>16);S=_>>>16,w&=65535,_&=65535,E[C]=_<<16|w}return new o(E,E[E.length-1]&-2147483648?-1:0)};function x(k,b){return k.add(N(b))}t.j=function(k){if(A(this)||A(k))return m;if(F(this))return F(k)?N(this).j(N(k)):N(N(this).j(k));if(F(k))return N(this.j(N(k)));if(0>this.l(y)&&0>k.l(y))return u(this.m()*k.m());for(var b=this.g.length+k.g.length,E=[],S=0;S<2*b;S++)E[S]=0;for(S=0;S<this.g.length;S++)for(var C=0;C<k.g.length;C++){var w=this.i(S)>>>16,_=this.i(S)&65535,Te=k.i(C)>>>16,ae=k.i(C)&65535;E[2*S+2*C]+=_*ae,V(E,2*S+2*C),E[2*S+2*C+1]+=w*ae,V(E,2*S+2*C+1),E[2*S+2*C+1]+=_*Te,V(E,2*S+2*C+1),E[2*S+2*C+2]+=w*Te,V(E,2*S+2*C+2)}for(S=0;S<b;S++)E[S]=E[2*S+1]<<16|E[2*S];for(S=b;S<2*b;S++)E[S]=0;return new o(E,0)};function V(k,b){for(;(k[b]&65535)!=k[b];)k[b+1]+=k[b]>>>16,k[b]&=65535,b++}function R(k,b){this.g=k,this.h=b}function D(k,b){if(A(b))throw Error("division by zero");if(A(k))return new R(m,m);if(F(k))return b=D(N(k),b),new R(N(b.g),N(b.h));if(F(b))return b=D(k,N(b)),new R(N(b.g),b.h);if(30<k.g.length){if(F(k)||F(b))throw Error("slowDivide_ only works with positive integers.");for(var E=g,S=b;0>=S.l(k);)E=P(E),S=P(S);var C=H(E,1),w=H(S,1);for(S=H(S,2),E=H(E,2);!A(S);){var _=w.add(S);0>=_.l(k)&&(C=C.add(E),w=_),S=H(S,1),E=H(E,1)}return b=x(k,C.j(b)),new R(C,b)}for(C=m;0<=k.l(b);){for(E=Math.max(1,Math.floor(k.m()/b.m())),S=Math.ceil(Math.log(E)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),w=u(E),_=w.j(b);F(_)||0<_.l(k);)E-=S,w=u(E),_=w.j(b);A(w)&&(w=g),C=C.add(w),k=x(k,_)}return new R(C,k)}t.A=function(k){return D(this,k).h},t.and=function(k){for(var b=Math.max(this.g.length,k.g.length),E=[],S=0;S<b;S++)E[S]=this.i(S)&k.i(S);return new o(E,this.h&k.h)},t.or=function(k){for(var b=Math.max(this.g.length,k.g.length),E=[],S=0;S<b;S++)E[S]=this.i(S)|k.i(S);return new o(E,this.h|k.h)},t.xor=function(k){for(var b=Math.max(this.g.length,k.g.length),E=[],S=0;S<b;S++)E[S]=this.i(S)^k.i(S);return new o(E,this.h^k.h)};function P(k){for(var b=k.g.length+1,E=[],S=0;S<b;S++)E[S]=k.i(S)<<1|k.i(S-1)>>>31;return new o(E,k.h)}function H(k,b){var E=b>>5;b%=32;for(var S=k.g.length-E,C=[],w=0;w<S;w++)C[w]=0<b?k.i(w+E)>>>b|k.i(w+E+1)<<32-b:k.i(w+E);return new o(C,k.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,F_=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,oi=o}).apply(typeof mm<"u"?mm:typeof self<"u"?self:typeof window<"u"?window:{});var ua=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var U_,B_,Lr,j_,Ia,Zc,H_,q_,K_;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,p){return a==Array.prototype||a==Object.prototype||(a[h]=p.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof ua=="object"&&ua];for(var h=0;h<a.length;++h){var p=a[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var s=n(this);function i(a,h){if(h)e:{var p=s;a=a.split(".");for(var v=0;v<a.length-1;v++){var U=a[v];if(!(U in p))break e;p=p[U]}a=a[a.length-1],v=p[a],h=h(v),h!=v&&h!=null&&e(p,a,{configurable:!0,writable:!0,value:h})}}function r(a,h){a instanceof String&&(a+="");var p=0,v=!1,U={next:function(){if(!v&&p<a.length){var q=p++;return{value:h(q,a[q]),done:!1}}return v=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}i("Array.prototype.values",function(a){return a||function(){return r(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function u(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function d(a,h,p){return a.call.apply(a.bind,arguments)}function m(a,h,p){if(!a)throw Error();if(2<arguments.length){var v=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,v),a.apply(h,U)}}return function(){return a.apply(h,arguments)}}function g(a,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:m,g.apply(null,arguments)}function y(a,h){var p=Array.prototype.slice.call(arguments,1);return function(){var v=p.slice();return v.push.apply(v,arguments),a.apply(this,v)}}function A(a,h){function p(){}p.prototype=h.prototype,a.aa=h.prototype,a.prototype=new p,a.prototype.constructor=a,a.Qb=function(v,U,q){for(var ee=Array(arguments.length-2),He=2;He<arguments.length;He++)ee[He-2]=arguments[He];return h.prototype[U].apply(v,ee)}}function F(a){const h=a.length;if(0<h){const p=Array(h);for(let v=0;v<h;v++)p[v]=a[v];return p}return[]}function N(a,h){for(let p=1;p<arguments.length;p++){const v=arguments[p];if(c(v)){const U=a.length||0,q=v.length||0;a.length=U+q;for(let ee=0;ee<q;ee++)a[U+ee]=v[ee]}else a.push(v)}}class x{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function V(a){return/^[\s\xa0]*$/.test(a)}function R(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function D(a){return D[" "](a),a}D[" "]=function(){};var P=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function H(a,h,p){for(const v in a)h.call(p,a[v],v,a)}function k(a,h){for(const p in a)h.call(void 0,a[p],p,a)}function b(a){const h={};for(const p in a)h[p]=a[p];return h}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(a,h){let p,v;for(let U=1;U<arguments.length;U++){v=arguments[U];for(p in v)a[p]=v[p];for(let q=0;q<E.length;q++)p=E[q],Object.prototype.hasOwnProperty.call(v,p)&&(a[p]=v[p])}}function C(a){var h=1;a=a.split(":");const p=[];for(;0<h&&a.length;)p.push(a.shift()),h--;return a.length&&p.push(a.join(":")),p}function w(a){l.setTimeout(()=>{throw a},0)}function _(){var a=Vt;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class Te{constructor(){this.h=this.g=null}add(h,p){const v=ae.get();v.set(h,p),this.h?this.h.next=v:this.g=v,this.h=v}}var ae=new x(()=>new Ce,a=>a.reset());class Ce{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let _e,le=!1,Vt=new Te,Yt=()=>{const a=l.Promise.resolve(void 0);_e=()=>{a.then(Gt)}};var Gt=()=>{for(var a;a=_();){try{a.h.call(a.g)}catch(p){w(p)}var h=ae;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}le=!1};function We(){this.s=this.s,this.C=this.C}We.prototype.s=!1,We.prototype.ma=function(){this.s||(this.s=!0,this.N())},We.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Qe(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}Qe.prototype.h=function(){this.defaultPrevented=!0};var kn=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const p=()=>{};l.addEventListener("test",p,h),l.removeEventListener("test",p,h)}catch{}return a}();function Tt(a,h){if(Qe.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var p=this.type=a.type,v=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(P){e:{try{D(h.nodeName);var U=!0;break e}catch{}U=!1}U||(h=null)}}else p=="mouseover"?h=a.fromElement:p=="mouseout"&&(h=a.toElement);this.relatedTarget=h,v?(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:ut[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Tt.aa.h.call(this)}}A(Tt,Qe);var ut={2:"touch",3:"pen",4:"mouse"};Tt.prototype.h=function(){Tt.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var G="closure_listenable_"+(1e6*Math.random()|0),ie=0;function ne(a,h,p,v,U){this.listener=a,this.proxy=null,this.src=h,this.type=p,this.capture=!!v,this.ha=U,this.key=++ie,this.da=this.fa=!1}function ce(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Oe(a){this.src=a,this.g={},this.h=0}Oe.prototype.add=function(a,h,p,v,U){var q=a.toString();a=this.g[q],a||(a=this.g[q]=[],this.h++);var ee=T(a,h,v,U);return-1<ee?(h=a[ee],p||(h.fa=!1)):(h=new ne(h,this.src,q,!!v,U),h.fa=p,a.push(h)),h};function I(a,h){var p=h.type;if(p in a.g){var v=a.g[p],U=Array.prototype.indexOf.call(v,h,void 0),q;(q=0<=U)&&Array.prototype.splice.call(v,U,1),q&&(ce(h),a.g[p].length==0&&(delete a.g[p],a.h--))}}function T(a,h,p,v){for(var U=0;U<a.length;++U){var q=a[U];if(!q.da&&q.listener==h&&q.capture==!!p&&q.ha==v)return U}return-1}var $="closure_lm_"+(1e6*Math.random()|0),z={};function Q(a,h,p,v,U){if(Array.isArray(h)){for(var q=0;q<h.length;q++)Q(a,h[q],p,v,U);return null}return p=pe(p),a&&a[G]?a.K(h,p,u(v)?!!v.capture:!1,U):W(a,h,p,!1,v,U)}function W(a,h,p,v,U,q){if(!h)throw Error("Invalid event type");var ee=u(U)?!!U.capture:!!U,He=K(a);if(He||(a[$]=He=new Oe(a)),p=He.add(h,p,v,ee,q),p.proxy)return p;if(v=te(),p.proxy=v,v.src=a,v.listener=p,a.addEventListener)kn||(U=ee),U===void 0&&(U=!1),a.addEventListener(h.toString(),v,U);else if(a.attachEvent)a.attachEvent(L(h.toString()),v);else if(a.addListener&&a.removeListener)a.addListener(v);else throw Error("addEventListener and attachEvent are unavailable.");return p}function te(){function a(p){return h.call(a.src,a.listener,p)}const h=oe;return a}function Z(a,h,p,v,U){if(Array.isArray(h))for(var q=0;q<h.length;q++)Z(a,h[q],p,v,U);else v=u(v)?!!v.capture:!!v,p=pe(p),a&&a[G]?(a=a.i,h=String(h).toString(),h in a.g&&(q=a.g[h],p=T(q,p,v,U),-1<p&&(ce(q[p]),Array.prototype.splice.call(q,p,1),q.length==0&&(delete a.g[h],a.h--)))):a&&(a=K(a))&&(h=a.g[h.toString()],a=-1,h&&(a=T(h,p,v,U)),(p=-1<a?h[a]:null)&&B(p))}function B(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[G])I(h.i,a);else{var p=a.type,v=a.proxy;h.removeEventListener?h.removeEventListener(p,v,a.capture):h.detachEvent?h.detachEvent(L(p),v):h.addListener&&h.removeListener&&h.removeListener(v),(p=K(h))?(I(p,a),p.h==0&&(p.src=null,h[$]=null)):ce(a)}}}function L(a){return a in z?z[a]:z[a]="on"+a}function oe(a,h){if(a.da)a=!0;else{h=new Tt(h,this);var p=a.listener,v=a.ha||a.src;a.fa&&B(a),a=p.call(v,h)}return a}function K(a){return a=a[$],a instanceof Oe?a:null}var re="__closure_events_fn_"+(1e9*Math.random()>>>0);function pe(a){return typeof a=="function"?a:(a[re]||(a[re]=function(h){return a.handleEvent(h)}),a[re])}function fe(){We.call(this),this.i=new Oe(this),this.M=this,this.F=null}A(fe,We),fe.prototype[G]=!0,fe.prototype.removeEventListener=function(a,h,p,v){Z(this,a,h,p,v)};function ve(a,h){var p,v=a.F;if(v)for(p=[];v;v=v.F)p.push(v);if(a=a.M,v=h.type||h,typeof h=="string")h=new Qe(h,a);else if(h instanceof Qe)h.target=h.target||a;else{var U=h;h=new Qe(v,a),S(h,U)}if(U=!0,p)for(var q=p.length-1;0<=q;q--){var ee=h.g=p[q];U=Ne(ee,v,!0,h)&&U}if(ee=h.g=a,U=Ne(ee,v,!0,h)&&U,U=Ne(ee,v,!1,h)&&U,p)for(q=0;q<p.length;q++)ee=h.g=p[q],U=Ne(ee,v,!1,h)&&U}fe.prototype.N=function(){if(fe.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var p=a.g[h],v=0;v<p.length;v++)ce(p[v]);delete a.g[h],a.h--}}this.F=null},fe.prototype.K=function(a,h,p,v){return this.i.add(String(a),h,!1,p,v)},fe.prototype.L=function(a,h,p,v){return this.i.add(String(a),h,!0,p,v)};function Ne(a,h,p,v){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var U=!0,q=0;q<h.length;++q){var ee=h[q];if(ee&&!ee.da&&ee.capture==p){var He=ee.listener,bt=ee.ha||ee.src;ee.fa&&I(a.i,ee),U=He.call(bt,v)!==!1&&U}}return U&&!v.defaultPrevented}function _t(a,h,p){if(typeof a=="function")p&&(a=g(a,p));else if(a&&typeof a.handleEvent=="function")a=g(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(a,h||0)}function yt(a){a.g=_t(()=>{a.g=null,a.i&&(a.i=!1,yt(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class nn extends We{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:yt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function At(a){We.call(this),this.h=a,this.g={}}A(At,We);var ls=[];function pr(a){H(a.g,function(h,p){this.g.hasOwnProperty(p)&&B(h)},a),a.g={}}At.prototype.N=function(){At.aa.N.call(this),pr(this)},At.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vt=l.JSON.stringify,sn=l.JSON.parse,Ho=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function ql(){}ql.prototype.h=null;function jd(a){return a.h||(a.h=a.i())}function Hd(){}var gr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Kl(){Qe.call(this,"d")}A(Kl,Qe);function Gl(){Qe.call(this,"c")}A(Gl,Qe);var qs={},qd=null;function qo(){return qd=qd||new fe}qs.La="serverreachability";function Kd(a){Qe.call(this,qs.La,a)}A(Kd,Qe);function _r(a){const h=qo();ve(h,new Kd(h))}qs.STAT_EVENT="statevent";function Gd(a,h){Qe.call(this,qs.STAT_EVENT,a),this.stat=h}A(Gd,Qe);function Lt(a){const h=qo();ve(h,new Gd(h,a))}qs.Ma="timingevent";function zd(a,h){Qe.call(this,qs.Ma,a),this.size=h}A(zd,Qe);function yr(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},h)}function vr(){this.g=!0}vr.prototype.xa=function(){this.g=!1};function Dv(a,h,p,v,U,q){a.info(function(){if(a.g)if(q)for(var ee="",He=q.split("&"),bt=0;bt<He.length;bt++){var Ve=He[bt].split("=");if(1<Ve.length){var Rt=Ve[0];Ve=Ve[1];var Ct=Rt.split("_");ee=2<=Ct.length&&Ct[1]=="type"?ee+(Rt+"="+Ve+"&"):ee+(Rt+"=redacted&")}}else ee=null;else ee=q;return"XMLHTTP REQ ("+v+") [attempt "+U+"]: "+h+`
`+p+`
`+ee})}function Ov(a,h,p,v,U,q,ee){a.info(function(){return"XMLHTTP RESP ("+v+") [ attempt "+U+"]: "+h+`
`+p+`
`+q+" "+ee})}function Si(a,h,p,v){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+Mv(a,p)+(v?" "+v:"")})}function Nv(a,h){a.info(function(){return"TIMEOUT: "+h})}vr.prototype.info=function(){};function Mv(a,h){if(!a.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(a=0;a<p.length;a++)if(Array.isArray(p[a])){var v=p[a];if(!(2>v.length)){var U=v[1];if(Array.isArray(U)&&!(1>U.length)){var q=U[0];if(q!="noop"&&q!="stop"&&q!="close")for(var ee=1;ee<U.length;ee++)U[ee]=""}}}}return vt(p)}catch{return h}}var Ko={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Wd={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},zl;function Go(){}A(Go,ql),Go.prototype.g=function(){return new XMLHttpRequest},Go.prototype.i=function(){return{}},zl=new Go;function cs(a,h,p,v){this.j=a,this.i=h,this.l=p,this.R=v||1,this.U=new At(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qd}function Qd(){this.i=null,this.g="",this.h=!1}var Yd={},Wl={};function Ql(a,h,p){a.L=1,a.v=Yo($n(h)),a.m=p,a.P=!0,Jd(a,null)}function Jd(a,h){a.F=Date.now(),zo(a),a.A=$n(a.v);var p=a.A,v=a.R;Array.isArray(v)||(v=[String(v)]),dh(p.i,"t",v),a.C=0,p=a.j.J,a.h=new Qd,a.g=Ch(a.j,p?h:null,!a.m),0<a.O&&(a.M=new nn(g(a.Y,a,a.g),a.O)),h=a.U,p=a.g,v=a.ca;var U="readystatechange";Array.isArray(U)||(U&&(ls[0]=U.toString()),U=ls);for(var q=0;q<U.length;q++){var ee=Q(p,U[q],v||h.handleEvent,!1,h.h||h);if(!ee)break;h.g[ee.key]=ee}h=a.H?b(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),_r(),Dv(a.i,a.u,a.A,a.l,a.R,a.m)}cs.prototype.ca=function(a){a=a.target;const h=this.M;h&&Fn(a)==3?h.j():this.Y(a)},cs.prototype.Y=function(a){try{if(a==this.g)e:{const Ct=Fn(this.g);var h=this.g.Ba();const Ri=this.g.Z();if(!(3>Ct)&&(Ct!=3||this.g&&(this.h.h||this.g.oa()||yh(this.g)))){this.J||Ct!=4||h==7||(h==8||0>=Ri?_r(3):_r(2)),Yl(this);var p=this.g.Z();this.X=p;t:if(Xd(this)){var v=yh(this.g);a="";var U=v.length,q=Fn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ks(this),br(this);var ee="";break t}this.h.i=new l.TextDecoder}for(h=0;h<U;h++)this.h.h=!0,a+=this.h.i.decode(v[h],{stream:!(q&&h==U-1)});v.length=0,this.h.g+=a,this.C=0,ee=this.h.g}else ee=this.g.oa();if(this.o=p==200,Ov(this.i,this.u,this.A,this.l,this.R,Ct,p),this.o){if(this.T&&!this.K){t:{if(this.g){var He,bt=this.g;if((He=bt.g?bt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(He)){var Ve=He;break t}}Ve=null}if(p=Ve)Si(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Jl(this,p);else{this.o=!1,this.s=3,Lt(12),Ks(this),br(this);break e}}if(this.P){p=!0;let un;for(;!this.J&&this.C<ee.length;)if(un=xv(this,ee),un==Wl){Ct==4&&(this.s=4,Lt(14),p=!1),Si(this.i,this.l,null,"[Incomplete Response]");break}else if(un==Yd){this.s=4,Lt(15),Si(this.i,this.l,ee,"[Invalid Chunk]"),p=!1;break}else Si(this.i,this.l,un,null),Jl(this,un);if(Xd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ct!=4||ee.length!=0||this.h.h||(this.s=1,Lt(16),p=!1),this.o=this.o&&p,!p)Si(this.i,this.l,ee,"[Invalid Chunked Response]"),Ks(this),br(this);else if(0<ee.length&&!this.W){this.W=!0;var Rt=this.j;Rt.g==this&&Rt.ba&&!Rt.M&&(Rt.j.info("Great, no buffering proxy detected. Bytes received: "+ee.length),sc(Rt),Rt.M=!0,Lt(11))}}else Si(this.i,this.l,ee,null),Jl(this,ee);Ct==4&&Ks(this),this.o&&!this.J&&(Ct==4?Sh(this.j,this):(this.o=!1,zo(this)))}else Xv(this.g),p==400&&0<ee.indexOf("Unknown SID")?(this.s=3,Lt(12)):(this.s=0,Lt(13)),Ks(this),br(this)}}}catch{}finally{}};function Xd(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function xv(a,h){var p=a.C,v=h.indexOf(`
`,p);return v==-1?Wl:(p=Number(h.substring(p,v)),isNaN(p)?Yd:(v+=1,v+p>h.length?Wl:(h=h.slice(v,v+p),a.C=v+p,h)))}cs.prototype.cancel=function(){this.J=!0,Ks(this)};function zo(a){a.S=Date.now()+a.I,Zd(a,a.I)}function Zd(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=yr(g(a.ba,a),h)}function Yl(a){a.B&&(l.clearTimeout(a.B),a.B=null)}cs.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Nv(this.i,this.A),this.L!=2&&(_r(),Lt(17)),Ks(this),this.s=2,br(this)):Zd(this,this.S-a)};function br(a){a.j.G==0||a.J||Sh(a.j,a)}function Ks(a){Yl(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,pr(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Jl(a,h){try{var p=a.j;if(p.G!=0&&(p.g==a||Xl(p.h,a))){if(!a.K&&Xl(p.h,a)&&p.G==3){try{var v=p.Da.g.parse(h)}catch{v=null}if(Array.isArray(v)&&v.length==3){var U=v;if(U[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<a.F)ta(p),Zo(p);else break e;nc(p),Lt(18)}}else p.za=U[1],0<p.za-p.T&&37500>U[2]&&p.F&&p.v==0&&!p.C&&(p.C=yr(g(p.Za,p),6e3));if(1>=nh(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else zs(p,11)}else if((a.K||p.g==a)&&ta(p),!V(h))for(U=p.Da.g.parse(h),h=0;h<U.length;h++){let Ve=U[h];if(p.T=Ve[0],Ve=Ve[1],p.G==2)if(Ve[0]=="c"){p.K=Ve[1],p.ia=Ve[2];const Rt=Ve[3];Rt!=null&&(p.la=Rt,p.j.info("VER="+p.la));const Ct=Ve[4];Ct!=null&&(p.Aa=Ct,p.j.info("SVER="+p.Aa));const Ri=Ve[5];Ri!=null&&typeof Ri=="number"&&0<Ri&&(v=1.5*Ri,p.L=v,p.j.info("backChannelRequestTimeoutMs_="+v)),v=p;const un=a.g;if(un){const sa=un.g?un.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(sa){var q=v.h;q.g||sa.indexOf("spdy")==-1&&sa.indexOf("quic")==-1&&sa.indexOf("h2")==-1||(q.j=q.l,q.g=new Set,q.h&&(Zl(q,q.h),q.h=null))}if(v.D){const ic=un.g?un.g.getResponseHeader("X-HTTP-Session-Id"):null;ic&&(v.ya=ic,Ye(v.I,v.D,ic))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-a.F,p.j.info("Handshake RTT: "+p.R+"ms")),v=p;var ee=a;if(v.qa=Rh(v,v.J?v.ia:null,v.W),ee.K){sh(v.h,ee);var He=ee,bt=v.L;bt&&(He.I=bt),He.B&&(Yl(He),zo(He)),v.g=ee}else wh(v);0<p.i.length&&ea(p)}else Ve[0]!="stop"&&Ve[0]!="close"||zs(p,7);else p.G==3&&(Ve[0]=="stop"||Ve[0]=="close"?Ve[0]=="stop"?zs(p,7):tc(p):Ve[0]!="noop"&&p.l&&p.l.ta(Ve),p.v=0)}}_r(4)}catch{}}var Vv=class{constructor(a,h){this.g=a,this.map=h}};function eh(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function th(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function nh(a){return a.h?1:a.g?a.g.size:0}function Xl(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Zl(a,h){a.g?a.g.add(h):a.h=h}function sh(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}eh.prototype.cancel=function(){if(this.i=ih(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function ih(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const p of a.g.values())h=h.concat(p.D);return h}return F(a.i)}function Lv(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var h=[],p=a.length,v=0;v<p;v++)h.push(a[v]);return h}h=[],p=0;for(v in a)h[p++]=a[v];return h}function $v(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var h=[];a=a.length;for(var p=0;p<a;p++)h.push(p);return h}h=[],p=0;for(const v in a)h[p++]=v;return h}}}function rh(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var p=$v(a),v=Lv(a),U=v.length,q=0;q<U;q++)h.call(void 0,v[q],p&&p[q],a)}var oh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fv(a,h){if(a){a=a.split("&");for(var p=0;p<a.length;p++){var v=a[p].indexOf("="),U=null;if(0<=v){var q=a[p].substring(0,v);U=a[p].substring(v+1)}else q=a[p];h(q,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function Gs(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Gs){this.h=a.h,Wo(this,a.j),this.o=a.o,this.g=a.g,Qo(this,a.s),this.l=a.l;var h=a.i,p=new wr;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),ah(this,p),this.m=a.m}else a&&(h=String(a).match(oh))?(this.h=!1,Wo(this,h[1]||"",!0),this.o=Er(h[2]||""),this.g=Er(h[3]||"",!0),Qo(this,h[4]),this.l=Er(h[5]||"",!0),ah(this,h[6]||"",!0),this.m=Er(h[7]||"")):(this.h=!1,this.i=new wr(null,this.h))}Gs.prototype.toString=function(){var a=[],h=this.j;h&&a.push(kr(h,lh,!0),":");var p=this.g;return(p||h=="file")&&(a.push("//"),(h=this.o)&&a.push(kr(h,lh,!0),"@"),a.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&a.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&a.push("/"),a.push(kr(p,p.charAt(0)=="/"?jv:Bv,!0))),(p=this.i.toString())&&a.push("?",p),(p=this.m)&&a.push("#",kr(p,qv)),a.join("")};function $n(a){return new Gs(a)}function Wo(a,h,p){a.j=p?Er(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function Qo(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function ah(a,h,p){h instanceof wr?(a.i=h,Kv(a.i,a.h)):(p||(h=kr(h,Hv)),a.i=new wr(h,a.h))}function Ye(a,h,p){a.i.set(h,p)}function Yo(a){return Ye(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Er(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function kr(a,h,p){return typeof a=="string"?(a=encodeURI(a).replace(h,Uv),p&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Uv(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var lh=/[#\/\?@]/g,Bv=/[#\?:]/g,jv=/[#\?]/g,Hv=/[#\?@]/g,qv=/#/g;function wr(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function us(a){a.g||(a.g=new Map,a.h=0,a.i&&Fv(a.i,function(h,p){a.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}t=wr.prototype,t.add=function(a,h){us(this),this.i=null,a=Ti(this,a);var p=this.g.get(a);return p||this.g.set(a,p=[]),p.push(h),this.h+=1,this};function ch(a,h){us(a),h=Ti(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function uh(a,h){return us(a),h=Ti(a,h),a.g.has(h)}t.forEach=function(a,h){us(this),this.g.forEach(function(p,v){p.forEach(function(U){a.call(h,U,v,this)},this)},this)},t.na=function(){us(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let v=0;v<h.length;v++){const U=a[v];for(let q=0;q<U.length;q++)p.push(h[v])}return p},t.V=function(a){us(this);let h=[];if(typeof a=="string")uh(this,a)&&(h=h.concat(this.g.get(Ti(this,a))));else{a=Array.from(this.g.values());for(let p=0;p<a.length;p++)h=h.concat(a[p])}return h},t.set=function(a,h){return us(this),this.i=null,a=Ti(this,a),uh(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function dh(a,h,p){ch(a,h),0<p.length&&(a.i=null,a.g.set(Ti(a,h),F(p)),a.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var v=h[p];const q=encodeURIComponent(String(v)),ee=this.V(v);for(v=0;v<ee.length;v++){var U=q;ee[v]!==""&&(U+="="+encodeURIComponent(String(ee[v]))),a.push(U)}}return this.i=a.join("&")};function Ti(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function Kv(a,h){h&&!a.j&&(us(a),a.i=null,a.g.forEach(function(p,v){var U=v.toLowerCase();v!=U&&(ch(this,v),dh(this,U,p))},a)),a.j=h}function Gv(a,h){const p=new vr;if(l.Image){const v=new Image;v.onload=y(ds,p,"TestLoadImage: loaded",!0,h,v),v.onerror=y(ds,p,"TestLoadImage: error",!1,h,v),v.onabort=y(ds,p,"TestLoadImage: abort",!1,h,v),v.ontimeout=y(ds,p,"TestLoadImage: timeout",!1,h,v),l.setTimeout(function(){v.ontimeout&&v.ontimeout()},1e4),v.src=a}else h(!1)}function zv(a,h){const p=new vr,v=new AbortController,U=setTimeout(()=>{v.abort(),ds(p,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:v.signal}).then(q=>{clearTimeout(U),q.ok?ds(p,"TestPingServer: ok",!0,h):ds(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(U),ds(p,"TestPingServer: error",!1,h)})}function ds(a,h,p,v,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),v(p)}catch{}}function Wv(){this.g=new Ho}function Qv(a,h,p){const v=p||"";try{rh(a,function(U,q){let ee=U;u(U)&&(ee=vt(U)),h.push(v+q+"="+encodeURIComponent(ee))})}catch(U){throw h.push(v+"type="+encodeURIComponent("_badmap")),U}}function Ir(a){this.l=a.Ub||null,this.j=a.eb||!1}A(Ir,ql),Ir.prototype.g=function(){return new Jo(this.l,this.j)},Ir.prototype.i=function(a){return function(){return a}}({});function Jo(a,h){fe.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(Jo,fe),t=Jo.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Tr(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Sr(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Tr(this)),this.g&&(this.readyState=3,Tr(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;hh(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function hh(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Sr(this):Tr(this),this.readyState==3&&hh(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Sr(this))},t.Qa=function(a){this.g&&(this.response=a,Sr(this))},t.ga=function(){this.g&&Sr(this)};function Sr(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Tr(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,a.push(p[0]+": "+p[1]),p=h.next();return a.join(`\r
`)};function Tr(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Jo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function fh(a){let h="";return H(a,function(p,v){h+=v,h+=":",h+=p,h+=`\r
`}),h}function ec(a,h,p){e:{for(v in p){var v=!1;break e}v=!0}v||(p=fh(p),typeof a=="string"?p!=null&&encodeURIComponent(String(p)):Ye(a,h,p))}function et(a){fe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(et,fe);var Yv=/^https?$/i,Jv=["POST","PUT"];t=et.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,p,v){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():zl.g(),this.v=this.o?jd(this.o):jd(zl),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(q){mh(this,q);return}if(a=p||"",p=new Map(this.headers),v)if(Object.getPrototypeOf(v)===Object.prototype)for(var U in v)p.set(U,v[U]);else if(typeof v.keys=="function"&&typeof v.get=="function")for(const q of v.keys())p.set(q,v.get(q));else throw Error("Unknown input type for opt_headers: "+String(v));v=Array.from(p.keys()).find(q=>q.toLowerCase()=="content-type"),U=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Jv,h,void 0))||v||U||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[q,ee]of p)this.g.setRequestHeader(q,ee);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{_h(this),this.u=!0,this.g.send(a),this.u=!1}catch(q){mh(this,q)}};function mh(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,ph(a),Xo(a)}function ph(a){a.A||(a.A=!0,ve(a,"complete"),ve(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,ve(this,"complete"),ve(this,"abort"),Xo(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xo(this,!0)),et.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?gh(this):this.bb())},t.bb=function(){gh(this)};function gh(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Fn(a)!=4||a.Z()!=2)){if(a.u&&Fn(a)==4)_t(a.Ea,0,a);else if(ve(a,"readystatechange"),Fn(a)==4){a.h=!1;try{const ee=a.Z();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var v;if(v=ee===0){var U=String(a.D).match(oh)[1]||null;!U&&l.self&&l.self.location&&(U=l.self.location.protocol.slice(0,-1)),v=!Yv.test(U?U.toLowerCase():"")}p=v}if(p)ve(a,"complete"),ve(a,"success");else{a.m=6;try{var q=2<Fn(a)?a.g.statusText:""}catch{q=""}a.l=q+" ["+a.Z()+"]",ph(a)}}finally{Xo(a)}}}}function Xo(a,h){if(a.g){_h(a);const p=a.g,v=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||ve(a,"ready");try{p.onreadystatechange=v}catch{}}}function _h(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function Fn(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<Fn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),sn(h)}};function yh(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Xv(a){const h={};a=(a.g&&2<=Fn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let v=0;v<a.length;v++){if(V(a[v]))continue;var p=C(a[v]);const U=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const q=h[U]||[];h[U]=q,q.push(p)}k(h,function(v){return v.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ar(a,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[a]||h}function vh(a){this.Aa=0,this.i=[],this.j=new vr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ar("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ar("baseRetryDelayMs",5e3,a),this.cb=Ar("retryDelaySeedMs",1e4,a),this.Wa=Ar("forwardChannelMaxRetries",2,a),this.wa=Ar("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new eh(a&&a.concurrentRequestLimit),this.Da=new Wv,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=vh.prototype,t.la=8,t.G=1,t.connect=function(a,h,p,v){Lt(0),this.W=a,this.H=h||{},p&&v!==void 0&&(this.H.OSID=p,this.H.OAID=v),this.F=this.X,this.I=Rh(this,null,this.W),ea(this)};function tc(a){if(bh(a),a.G==3){var h=a.U++,p=$n(a.I);if(Ye(p,"SID",a.K),Ye(p,"RID",h),Ye(p,"TYPE","terminate"),Rr(a,p),h=new cs(a,a.j,h),h.L=2,h.v=Yo($n(p)),p=!1,l.navigator&&l.navigator.sendBeacon)try{p=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&l.Image&&(new Image().src=h.v,p=!0),p||(h.g=Ch(h.j,null),h.g.ea(h.v)),h.F=Date.now(),zo(h)}Ah(a)}function Zo(a){a.g&&(sc(a),a.g.cancel(),a.g=null)}function bh(a){Zo(a),a.u&&(l.clearTimeout(a.u),a.u=null),ta(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function ea(a){if(!th(a.h)&&!a.s){a.s=!0;var h=a.Ga;_e||Yt(),le||(_e(),le=!0),Vt.add(h,a),a.B=0}}function Zv(a,h){return nh(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=yr(g(a.Ga,a,h),Th(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const U=new cs(this,this.j,a);let q=this.o;if(this.S&&(q?(q=b(q),S(q,this.S)):q=this.S),this.m!==null||this.O||(U.H=q,q=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var v=this.i[p];if("__data__"in v.map&&(v=v.map.__data__,typeof v=="string")){v=v.length;break t}v=void 0}if(v===void 0)break;if(h+=v,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=kh(this,U,h),p=$n(this.I),Ye(p,"RID",a),Ye(p,"CVER",22),this.D&&Ye(p,"X-HTTP-Session-Id",this.D),Rr(this,p),q&&(this.O?h="headers="+encodeURIComponent(String(fh(q)))+"&"+h:this.m&&ec(p,this.m,q)),Zl(this.h,U),this.Ua&&Ye(p,"TYPE","init"),this.P?(Ye(p,"$req",h),Ye(p,"SID","null"),U.T=!0,Ql(U,p,null)):Ql(U,p,h),this.G=2}}else this.G==3&&(a?Eh(this,a):this.i.length==0||th(this.h)||Eh(this))};function Eh(a,h){var p;h?p=h.l:p=a.U++;const v=$n(a.I);Ye(v,"SID",a.K),Ye(v,"RID",p),Ye(v,"AID",a.T),Rr(a,v),a.m&&a.o&&ec(v,a.m,a.o),p=new cs(a,a.j,p,a.B+1),a.m===null&&(p.H=a.o),h&&(a.i=h.D.concat(a.i)),h=kh(a,p,1e3),p.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Zl(a.h,p),Ql(p,v,h)}function Rr(a,h){a.H&&H(a.H,function(p,v){Ye(h,v,p)}),a.l&&rh({},function(p,v){Ye(h,v,p)})}function kh(a,h,p){p=Math.min(a.i.length,p);var v=a.l?g(a.l.Na,a.l,a):null;e:{var U=a.i;let q=-1;for(;;){const ee=["count="+p];q==-1?0<p?(q=U[0].g,ee.push("ofs="+q)):q=0:ee.push("ofs="+q);let He=!0;for(let bt=0;bt<p;bt++){let Ve=U[bt].g;const Rt=U[bt].map;if(Ve-=q,0>Ve)q=Math.max(0,U[bt].g-100),He=!1;else try{Qv(Rt,ee,"req"+Ve+"_")}catch{v&&v(Rt)}}if(He){v=ee.join("&");break e}}}return a=a.i.splice(0,p),h.D=a,v}function wh(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;_e||Yt(),le||(_e(),le=!0),Vt.add(h,a),a.v=0}}function nc(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=yr(g(a.Fa,a),Th(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Ih(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=yr(g(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Lt(10),Zo(this),Ih(this))};function sc(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Ih(a){a.g=new cs(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=$n(a.qa);Ye(h,"RID","rpc"),Ye(h,"SID",a.K),Ye(h,"AID",a.T),Ye(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&Ye(h,"TO",a.ja),Ye(h,"TYPE","xmlhttp"),Rr(a,h),a.m&&a.o&&ec(h,a.m,a.o),a.L&&(a.g.I=a.L);var p=a.g;a=a.ia,p.L=1,p.v=Yo($n(h)),p.m=null,p.P=!0,Jd(p,a)}t.Za=function(){this.C!=null&&(this.C=null,Zo(this),nc(this),Lt(19))};function ta(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function Sh(a,h){var p=null;if(a.g==h){ta(a),sc(a),a.g=null;var v=2}else if(Xl(a.h,h))p=h.D,sh(a.h,h),v=1;else return;if(a.G!=0){if(h.o)if(v==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var U=a.B;v=qo(),ve(v,new zd(v,p)),ea(a)}else wh(a);else if(U=h.s,U==3||U==0&&0<h.X||!(v==1&&Zv(a,h)||v==2&&nc(a)))switch(p&&0<p.length&&(h=a.h,h.i=h.i.concat(p)),U){case 1:zs(a,5);break;case 4:zs(a,10);break;case 3:zs(a,6);break;default:zs(a,2)}}}function Th(a,h){let p=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(p*=2),p*h}function zs(a,h){if(a.j.info("Error code "+h),h==2){var p=g(a.fb,a),v=a.Xa;const U=!v;v=new Gs(v||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Wo(v,"https"),Yo(v),U?Gv(v.toString(),p):zv(v.toString(),p)}else Lt(2);a.G=0,a.l&&a.l.sa(h),Ah(a),bh(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Lt(2)):(this.j.info("Failed to ping google.com"),Lt(1))};function Ah(a){if(a.G=0,a.ka=[],a.l){const h=ih(a.h);(h.length!=0||a.i.length!=0)&&(N(a.ka,h),N(a.ka,a.i),a.h.i.length=0,F(a.i),a.i.length=0),a.l.ra()}}function Rh(a,h,p){var v=p instanceof Gs?$n(p):new Gs(p);if(v.g!="")h&&(v.g=h+"."+v.g),Qo(v,v.s);else{var U=l.location;v=U.protocol,h=h?h+"."+U.hostname:U.hostname,U=+U.port;var q=new Gs(null);v&&Wo(q,v),h&&(q.g=h),U&&Qo(q,U),p&&(q.l=p),v=q}return p=a.D,h=a.ya,p&&h&&Ye(v,p,h),Ye(v,"VER",a.la),Rr(a,v),v}function Ch(a,h,p){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new et(new Ir({eb:p})):new et(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ph(){}t=Ph.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function na(){}na.prototype.g=function(a,h){return new Jt(a,h)};function Jt(a,h){fe.call(this),this.g=new vh(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!V(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!V(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new Ai(this)}A(Jt,fe),Jt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Jt.prototype.close=function(){tc(this.g)},Jt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var p={};p.__data__=a,a=p}else this.u&&(p={},p.__data__=vt(a),a=p);h.i.push(new Vv(h.Ya++,a)),h.G==3&&ea(h)},Jt.prototype.N=function(){this.g.l=null,delete this.j,tc(this.g),delete this.g,Jt.aa.N.call(this)};function Dh(a){Kl.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const p in h){a=p;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}A(Dh,Kl);function Oh(){Gl.call(this),this.status=1}A(Oh,Gl);function Ai(a){this.g=a}A(Ai,Ph),Ai.prototype.ua=function(){ve(this.g,"a")},Ai.prototype.ta=function(a){ve(this.g,new Dh(a))},Ai.prototype.sa=function(a){ve(this.g,new Oh)},Ai.prototype.ra=function(){ve(this.g,"b")},na.prototype.createWebChannel=na.prototype.g,Jt.prototype.send=Jt.prototype.o,Jt.prototype.open=Jt.prototype.m,Jt.prototype.close=Jt.prototype.close,K_=function(){return new na},q_=function(){return qo()},H_=qs,Zc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ko.NO_ERROR=0,Ko.TIMEOUT=8,Ko.HTTP_ERROR=6,Ia=Ko,Wd.COMPLETE="complete",j_=Wd,Hd.EventType=gr,gr.OPEN="a",gr.CLOSE="b",gr.ERROR="c",gr.MESSAGE="d",fe.prototype.listen=fe.prototype.K,Lr=Hd,B_=Ir,et.prototype.listenOnce=et.prototype.L,et.prototype.getLastError=et.prototype.Ka,et.prototype.getLastErrorCode=et.prototype.Ba,et.prototype.getStatus=et.prototype.Z,et.prototype.getResponseJson=et.prototype.Oa,et.prototype.getResponseText=et.prototype.oa,et.prototype.send=et.prototype.ea,et.prototype.setWithCredentials=et.prototype.Ha,U_=et}).apply(typeof ua<"u"?ua:typeof self<"u"?self:typeof window<"u"?window:{});const pm="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Nt.UNAUTHENTICATED=new Nt(null),Nt.GOOGLE_CREDENTIALS=new Nt("google-credentials-uid"),Nt.FIRST_PARTY=new Nt("first-party-uid"),Nt.MOCK_USER=new Nt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cr="10.12.5";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi=new $u("@firebase/firestore");function Or(){return pi.logLevel}function se(t,...e){if(pi.logLevel<=De.DEBUG){const n=e.map(Qu);pi.debug(`Firestore (${cr}): ${t}`,...n)}}function Mn(t,...e){if(pi.logLevel<=De.ERROR){const n=e.map(Qu);pi.error(`Firestore (${cr}): ${t}`,...n)}}function gi(t,...e){if(pi.logLevel<=De.WARN){const n=e.map(Qu);pi.warn(`Firestore (${cr}): ${t}`,...n)}}function Qu(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(t="Unexpected state"){const e=`FIRESTORE (${cr}) INTERNAL ASSERTION FAILED: `+t;throw Mn(e),new Error(e)}function $e(t,e){t||ye()}function ke(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ue extends rs{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class z_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Nt.UNAUTHENTICATED))}shutdown(){}}class P0{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class D0{constructor(e){this.t=e,this.currentUser=Nt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let s=this.i;const i=c=>this.i!==s?(s=this.i,n(c)):Promise.resolve();let r=new pn;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new pn,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=r;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(se("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new pn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?($e(typeof s.accessToken=="string"),new G_(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return $e(e===null||typeof e=="string"),new Nt(e)}}class O0{constructor(e,n,s){this.l=e,this.h=n,this.P=s,this.type="FirstParty",this.user=Nt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class N0{constructor(e,n,s){this.l=e,this.h=n,this.P=s}getToken(){return Promise.resolve(new O0(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Nt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class M0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class x0{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const s=r=>{r.error!=null&&se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.R;return this.R=r.token,se("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>s(r))};const i=r=>{se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.appCheck.addTokenListener(this.o)};this.A.onInit(r=>i(r)),setTimeout(()=>{if(!this.appCheck){const r=this.A.getImmediate({optional:!0});r?i(r):se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?($e(typeof n.token=="string"),this.R=n.token,new M0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const i=V0(40);for(let r=0;r<i.length;++r)s.length<20&&i[r]<n&&(s+=e.charAt(i[r]%e.length))}return s}}function Le(t,e){return t<e?-1:t>e?1:0}function Xi(t,e,n){return t.length===e.length&&t.every((s,i)=>n(s,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ue(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ue(J.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ue(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(J.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return rt.fromMillis(Date.now())}static fromDate(e){return rt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*n));return new rt(n,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.timestamp=e}static fromTimestamp(e){return new be(e)}static min(){return new be(new rt(0,0))}static max(){return new be(new rt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,n,s){n===void 0?n=0:n>e.length&&ye(),s===void 0?s=e.length-n:s>e.length-n&&ye(),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return _o.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof _o?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let i=0;i<s;i++){const r=e.get(i),o=n.get(i);if(r<o)return-1;if(r>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Je extends _o{construct(e,n,s){return new Je(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new ue(J.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(i=>i.length>0))}return new Je(n)}static emptyPath(){return new Je([])}}const L0=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mt extends _o{construct(e,n,s){return new mt(e,n,s)}static isValidIdentifier(e){return L0.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new mt(["__name__"])}static fromServerFormat(e){const n=[];let s="",i=0;const r=()=>{if(s.length===0)throw new ue(J.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new ue(J.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ue(J.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(s+=l,i++):(r(),i++)}if(r(),o)throw new ue(J.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mt(n)}static emptyPath(){return new mt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.path=e}static fromPath(e){return new me(Je.fromString(e))}static fromName(e){return new me(Je.fromString(e).popFirst(5))}static empty(){return new me(Je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Je.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new me(new Je(e.slice()))}}function $0(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,i=be.fromTimestamp(s===1e9?new rt(n+1,0):new rt(n,s));return new Vs(i,me.empty(),e)}function F0(t){return new Vs(t.readTime,t.key,-1)}class Vs{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new Vs(be.min(),me.empty(),-1)}static max(){return new Vs(be.max(),me.empty(),-1)}}function U0(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=me.comparator(t.documentKey,e.documentKey),n!==0?n:Le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class j0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(t){if(t.code!==J.FAILED_PRECONDITION||t.message!==B0)throw t;se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ye(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Y((s,i)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(s,i)},this.catchCallback=r=>{this.wrapFailure(n,r).next(s,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Y?n:Y.resolve(n)}catch(n){return Y.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Y.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Y.reject(n)}static resolve(e){return new Y((n,s)=>{n(e)})}static reject(e){return new Y((n,s)=>{s(e)})}static waitFor(e){return new Y((n,s)=>{let i=0,r=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++r,o&&r===i&&n()},c=>s(c))}),o=!0,r===i&&n()})}static or(e){let n=Y.resolve(!1);for(const s of e)n=n.next(i=>i?Y.resolve(i):s());return n}static forEach(e,n){const s=[];return e.forEach((i,r)=>{s.push(n.call(this,i,r))}),this.waitFor(s)}static mapArray(e,n){return new Y((s,i)=>{const r=e.length,o=new Array(r);let l=0;for(let c=0;c<r;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===r&&s(o)},d=>i(d))}})}static doWhile(e,n){return new Y((s,i)=>{const r=()=>{e()===!0?n().next(()=>{r()},i):s()};r()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new pn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Yr(e,n.error)):this.V.resolve()},this.transaction.onerror=s=>{const i=Xu(s.target.error);this.V.reject(new Yr(e,i))}}static open(e,n,s,i){try{return new Ju(n,e.transaction(i,s))}catch(r){throw new Yr(n,r)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(se("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new q0(n)}}class ai{constructor(e,n,s){this.name=e,this.version=n,this.p=s,ai.S(ot())===12.2&&Mn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return se("SimpleDb","Removing database:",e),ti(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Xg())return!1;if(ai.C())return!0;const e=ot(),n=ai.S(e),s=0<n&&n<10,i=W_(e),r=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||r)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(s)}async M(e){return this.db||(se("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,s)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=r=>{const o=r.target.result;n(o)},i.onblocked=()=>{s(new Yr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=r=>{const o=r.target.error;o.name==="VersionError"?s(new ue(J.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new ue(J.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new Yr(e,o))},i.onupgradeneeded=r=>{se("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',r.oldVersion);const o=r.target.result;this.p.O(o,i.transaction,r.oldVersion,this.version).next(()=>{se("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,s,i){const r=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=Ju.open(this.db,e,r?"readonly":"readwrite",s),c=i(l).next(u=>(l.g(),u)).catch(u=>(l.abort(u),Y.reject(u))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(se("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function W_(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class H0{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ti(this.B.delete())}}class Yr extends ue{constructor(e,n){super(J.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Mo(t){return t.name==="IndexedDbTransactionError"}class q0{constructor(e){this.store=e}put(e,n){let s;return n!==void 0?(se("SimpleDb","PUT",this.store.name,e,n),s=this.store.put(n,e)):(se("SimpleDb","PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),ti(s)}add(e){return se("SimpleDb","ADD",this.store.name,e,e),ti(this.store.add(e))}get(e){return ti(this.store.get(e)).next(n=>(n===void 0&&(n=null),se("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return se("SimpleDb","DELETE",this.store.name,e),ti(this.store.delete(e))}count(){return se("SimpleDb","COUNT",this.store.name),ti(this.store.count())}U(e,n){const s=this.options(e,n),i=s.index?this.store.index(s.index):this.store;if(typeof i.getAll=="function"){const r=i.getAll(s.range);return new Y((o,l)=>{r.onerror=c=>{l(c.target.error)},r.onsuccess=c=>{o(c.target.result)}})}{const r=this.cursor(s),o=[];return this.W(r,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,n){const s=this.store.getAll(e,n===null?void 0:n);return new Y((i,r)=>{s.onerror=o=>{r(o.target.error)},s.onsuccess=o=>{i(o.target.result)}})}j(e,n){se("SimpleDb","DELETE ALL",this.store.name);const s=this.options(e,n);s.H=!1;const i=this.cursor(s);return this.W(i,(r,o,l)=>l.delete())}J(e,n){let s;n?s=e:(s={},n=e);const i=this.cursor(s);return this.W(i,n)}Y(e){const n=this.cursor({});return new Y((s,i)=>{n.onerror=r=>{const o=Xu(r.target.error);i(o)},n.onsuccess=r=>{const o=r.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():s()}):s()}})}W(e,n){const s=[];return new Y((i,r)=>{e.onerror=o=>{r(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void i();const c=new H0(l),u=n(l.primaryKey,l.value,c);if(u instanceof Y){const d=u.catch(m=>(c.done(),Y.reject(m)));s.push(d)}c.isDone?i():c.K===null?l.continue():l.continue(c.K)}}).next(()=>Y.waitFor(s))}options(e,n){let s;return e!==void 0&&(typeof e=="string"?s=e:n=e),{index:s,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const s=this.store.index(e.index);return e.H?s.openKeyCursor(e.range,n):s.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ti(t){return new Y((e,n)=>{t.onsuccess=s=>{const i=s.target.result;e(i)},t.onerror=s=>{const i=Xu(s.target.error);n(i)}})}let gm=!1;function Xu(t){const e=ai.S(ot());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const s=new ue("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return gm||(gm=!0,setTimeout(()=>{throw s},0)),s}}return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ie(s),this.se=s=>n.writeSequenceNumber(s))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Zu.oe=-1;function xo(t){return t==null}function za(t){return t===0&&1/t==-1/0}function K0(t){return typeof t=="number"&&Number.isInteger(t)&&!za(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _m(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ei(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Q_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,n){this.comparator=e,this.root=n||Et.EMPTY}insert(e,n){return new Ze(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Et.BLACK,null,null))}remove(e){return new Ze(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Et.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(e,s.key);if(i===0)return n+s.left.size;i<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new da(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new da(this.root,e,this.comparator,!1)}getReverseIterator(){return new da(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new da(this.root,e,this.comparator,!0)}}class da{constructor(e,n,s,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=n?s(e.key,n):1,n&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Et{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s??Et.RED,this.left=i??Et.EMPTY,this.right=r??Et.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,i,r){return new Et(e??this.key,n??this.value,s??this.color,i??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Et.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Et.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ye();const e=this.left.check();if(e!==this.right.check())throw ye();return e+(this.isRed()?0:1)}}Et.EMPTY=null,Et.RED=!0,Et.BLACK=!1;Et.EMPTY=new class{constructor(){this.size=0}get key(){throw ye()}get value(){throw ye()}get color(){throw ye()}get left(){throw ye()}get right(){throw ye()}copy(e,n,s,i,r){return this}insert(e,n,s){return new Et(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.comparator=e,this.data=new Ze(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ym(this.data.getIterator())}getIteratorFrom(e){return new ym(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof It)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,r=s.getNext().key;if(this.comparator(i,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new It(this.comparator);return n.data=e,n}}class ym{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.fields=e,e.sort(mt.comparator)}static empty(){return new en([])}unionWith(e){let n=new It(mt.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new en(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Xi(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new Y_("Invalid base64 string: "+r):r}}(e);return new pt(n)}static fromUint8Array(e){const n=function(i){let r="";for(let o=0;o<i.length;++o)r+=String.fromCharCode(i[o]);return r}(e);return new pt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const s=new Uint8Array(n.length);for(let i=0;i<n.length;i++)s[i]=n.charCodeAt(i);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pt.EMPTY_BYTE_STRING=new pt("");const G0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ls(t){if($e(!!t),typeof t=="string"){let e=0;const n=G0.exec(t);if($e(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:it(t.seconds),nanos:it(t.nanos)}}function it(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function _i(t){return typeof t=="string"?pt.fromBase64String(t):pt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ed(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function td(t){const e=t.mapValue.fields.__previous_value__;return ed(e)?td(e):e}function yo(t){const e=Ls(t.mapValue.fields.__local_write_time__.timestampValue);return new rt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(e,n,s,i,r,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=i,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class Zi{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Zi("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Zi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha={mapValue:{}};function yi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ed(t)?4:W0(t)?9007199254740991:10:ye()}function xn(t,e){if(t===e)return!0;const n=yi(t);if(n!==yi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return yo(t).isEqual(yo(e));case 3:return function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const o=Ls(i.timestampValue),l=Ls(r.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,r){return _i(i.bytesValue).isEqual(_i(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,r){return it(i.geoPointValue.latitude)===it(r.geoPointValue.latitude)&&it(i.geoPointValue.longitude)===it(r.geoPointValue.longitude)}(t,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return it(i.integerValue)===it(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const o=it(i.doubleValue),l=it(r.doubleValue);return o===l?za(o)===za(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Xi(t.arrayValue.values||[],e.arrayValue.values||[],xn);case 10:return function(i,r){const o=i.mapValue.fields||{},l=r.mapValue.fields||{};if(_m(o)!==_m(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!xn(o[c],l[c])))return!1;return!0}(t,e);default:return ye()}}function vo(t,e){return(t.values||[]).find(n=>xn(n,e))!==void 0}function er(t,e){if(t===e)return 0;const n=yi(t),s=yi(e);if(n!==s)return Le(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return Le(t.booleanValue,e.booleanValue);case 2:return function(r,o){const l=it(r.integerValue||r.doubleValue),c=it(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return vm(t.timestampValue,e.timestampValue);case 4:return vm(yo(t),yo(e));case 5:return Le(t.stringValue,e.stringValue);case 6:return function(r,o){const l=_i(r),c=_i(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(r,o){const l=r.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Le(l[u],c[u]);if(d!==0)return d}return Le(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(r,o){const l=Le(it(r.latitude),it(o.latitude));return l!==0?l:Le(it(r.longitude),it(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(r,o){const l=r.values||[],c=o.values||[];for(let u=0;u<l.length&&u<c.length;++u){const d=er(l[u],c[u]);if(d)return d}return Le(l.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(r,o){if(r===ha.mapValue&&o===ha.mapValue)return 0;if(r===ha.mapValue)return 1;if(o===ha.mapValue)return-1;const l=r.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let m=0;m<c.length&&m<d.length;++m){const g=Le(c[m],d[m]);if(g!==0)return g;const y=er(l[c[m]],u[d[m]]);if(y!==0)return y}return Le(c.length,d.length)}(t.mapValue,e.mapValue);default:throw ye()}}function vm(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Le(t,e);const n=Ls(t),s=Ls(e),i=Le(n.seconds,s.seconds);return i!==0?i:Le(n.nanos,s.nanos)}function tr(t){return eu(t)}function eu(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const s=Ls(n);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return _i(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return me.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let s="[",i=!0;for(const r of n.values||[])i?i=!1:s+=",",s+=eu(r);return s+"]"}(t.arrayValue):"mapValue"in t?function(n){const s=Object.keys(n.fields||{}).sort();let i="{",r=!0;for(const o of s)r?r=!1:i+=",",i+=`${o}:${eu(n.fields[o])}`;return i+"}"}(t.mapValue):ye()}function tu(t){return!!t&&"integerValue"in t}function nd(t){return!!t&&"arrayValue"in t}function bm(t){return!!t&&"nullValue"in t}function Em(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Sa(t){return!!t&&"mapValue"in t}function Jr(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ei(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=Jr(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Jr(t.arrayValue.values[n]);return e}return Object.assign({},t)}function W0(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.value=e}static empty(){return new Bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Sa(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Jr(n)}setAll(e){let n=mt.emptyPath(),s={},i=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,s,i),s={},i=[],n=l.popLast()}o?s[l.lastSegment()]=Jr(o):i.push(l.lastSegment())});const r=this.getFieldsMap(n);this.applyChanges(r,s,i)}delete(e){const n=this.field(e.popLast());Sa(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return xn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let i=n.mapValue.fields[e.get(s)];Sa(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,s){Ei(n,(i,r)=>e[i]=r);for(const i of s)delete e[i]}clone(){return new Bt(Jr(this.value))}}function J_(t){const e=[];return Ei(t.fields,(n,s)=>{const i=new mt([n]);if(Sa(s)){const r=J_(s.mapValue).fields;if(r.length===0)e.push(i);else for(const o of r)e.push(i.child(o))}else e.push(i)}),new en(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n,s,i,r,o,l){this.key=e,this.documentType=n,this.version=s,this.readTime=i,this.createTime=r,this.data=o,this.documentState=l}static newInvalidDocument(e){return new ht(e,0,be.min(),be.min(),be.min(),Bt.empty(),0)}static newFoundDocument(e,n,s,i){return new ht(e,1,n,be.min(),s,i,0)}static newNoDocument(e,n){return new ht(e,2,n,be.min(),be.min(),Bt.empty(),0)}static newUnknownDocument(e,n){return new ht(e,3,n,be.min(),be.min(),Bt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(be.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ht&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ht(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e,n){this.position=e,this.inclusive=n}}function km(t,e,n){let s=0;for(let i=0;i<t.position.length;i++){const r=e[i],o=t.position[i];if(r.field.isKeyField()?s=me.comparator(me.fromName(o.referenceValue),n.key):s=er(o,n.data.field(r.field)),r.dir==="desc"&&(s*=-1),s!==0)break}return s}function wm(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!xn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,n="asc"){this.field=e,this.dir=n}}function Q0(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{}class at extends X_{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new J0(e,n,s):n==="array-contains"?new eR(e,s):n==="in"?new tR(e,s):n==="not-in"?new nR(e,s):n==="array-contains-any"?new sR(e,s):new at(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new X0(e,s):new Z0(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(er(n,this.value)):n!==null&&yi(this.value)===yi(n)&&this.matchesComparison(er(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ye()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vn extends X_{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Vn(e,n)}matches(e){return Z_(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Z_(t){return t.op==="and"}function ey(t){return Y0(t)&&Z_(t)}function Y0(t){for(const e of t.filters)if(e instanceof Vn)return!1;return!0}function nu(t){if(t instanceof at)return t.field.canonicalString()+t.op.toString()+tr(t.value);if(ey(t))return t.filters.map(e=>nu(e)).join(",");{const e=t.filters.map(n=>nu(n)).join(",");return`${t.op}(${e})`}}function ty(t,e){return t instanceof at?function(s,i){return i instanceof at&&s.op===i.op&&s.field.isEqual(i.field)&&xn(s.value,i.value)}(t,e):t instanceof Vn?function(s,i){return i instanceof Vn&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce((r,o,l)=>r&&ty(o,i.filters[l]),!0):!1}(t,e):void ye()}function ny(t){return t instanceof at?function(n){return`${n.field.canonicalString()} ${n.op} ${tr(n.value)}`}(t):t instanceof Vn?function(n){return n.op.toString()+" {"+n.getFilters().map(ny).join(" ,")+"}"}(t):"Filter"}class J0 extends at{constructor(e,n,s){super(e,n,s),this.key=me.fromName(s.referenceValue)}matches(e){const n=me.comparator(e.key,this.key);return this.matchesComparison(n)}}class X0 extends at{constructor(e,n){super(e,"in",n),this.keys=sy("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Z0 extends at{constructor(e,n){super(e,"not-in",n),this.keys=sy("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function sy(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(s=>me.fromName(s.referenceValue))}class eR extends at{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return nd(n)&&vo(n.arrayValue,this.value)}}class tR extends at{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&vo(this.value.arrayValue,n)}}class nR extends at{constructor(e,n){super(e,"not-in",n)}matches(e){if(vo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!vo(this.value.arrayValue,n)}}class sR extends at{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!nd(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>vo(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e,n=null,s=[],i=[],r=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=i,this.limit=r,this.startAt=o,this.endAt=l,this.ue=null}}function Im(t,e=null,n=[],s=[],i=null,r=null,o=null){return new iR(t,e,n,s,i,r,o)}function sd(t){const e=ke(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>nu(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),xo(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>tr(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>tr(s)).join(",")),e.ue=n}return e.ue}function id(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Q0(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!ty(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wm(t.startAt,e.startAt)&&wm(t.endAt,e.endAt)}function su(t){return me.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,n=null,s=[],i=[],r=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=i,this.limit=r,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function rR(t,e,n,s,i,r,o,l){return new Tl(t,e,n,s,i,r,o,l)}function rd(t){return new Tl(t)}function Sm(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function oR(t){return t.collectionGroup!==null}function Xr(t){const e=ke(t);if(e.ce===null){e.ce=[];const n=new Set;for(const r of e.explicitOrderBy)e.ce.push(r),n.add(r.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new It(mt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(r=>{n.has(r.canonicalString())||r.isKeyField()||e.ce.push(new Qa(r,s))}),n.has(mt.keyField().canonicalString())||e.ce.push(new Qa(mt.keyField(),s))}return e.ce}function Nn(t){const e=ke(t);return e.le||(e.le=aR(e,Xr(t))),e.le}function aR(t,e){if(t.limitType==="F")return Im(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const r=i.dir==="desc"?"asc":"desc";return new Qa(i.field,r)});const n=t.endAt?new Wa(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new Wa(t.startAt.position,t.startAt.inclusive):null;return Im(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function iu(t,e,n){return new Tl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Al(t,e){return id(Nn(t),Nn(e))&&t.limitType===e.limitType}function iy(t){return`${sd(Nn(t))}|lt:${t.limitType}`}function Ni(t){return`Query(target=${function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map(i=>ny(i)).join(", ")}]`),xo(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map(i=>tr(i)).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map(i=>tr(i)).join(",")),`Target(${s})`}(Nn(t))}; limitType=${t.limitType})`}function Rl(t,e){return e.isFoundDocument()&&function(s,i){const r=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(r):me.isDocumentKey(s.path)?s.path.isEqual(r):s.path.isImmediateParentOf(r)}(t,e)&&function(s,i){for(const r of Xr(s))if(!r.field.isKeyField()&&i.data.field(r.field)===null)return!1;return!0}(t,e)&&function(s,i){for(const r of s.filters)if(!r.matches(i))return!1;return!0}(t,e)&&function(s,i){return!(s.startAt&&!function(o,l,c){const u=km(o,l,c);return o.inclusive?u<=0:u<0}(s.startAt,Xr(s),i)||s.endAt&&!function(o,l,c){const u=km(o,l,c);return o.inclusive?u>=0:u>0}(s.endAt,Xr(s),i))}(t,e)}function lR(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function ry(t){return(e,n)=>{let s=!1;for(const i of Xr(t)){const r=cR(i,e,n);if(r!==0)return r;s=s||i.field.isKeyField()}return 0}}function cR(t,e,n){const s=t.field.isKeyField()?me.comparator(e.key,n.key):function(r,o,l){const c=o.data.field(r),u=l.data.field(r);return c!==null&&u!==null?er(c,u):ye()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return ye()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[i,r]of s)if(this.equalsFn(i,e))return r}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),i=this.inner[s];if(i===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return s.length===1?delete this.inner[n]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ei(this.inner,(n,s)=>{for(const[i,r]of s)e(i,r)})}isEmpty(){return Q_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR=new Ze(me.comparator);function ss(){return uR}const oy=new Ze(me.comparator);function $r(...t){let e=oy;for(const n of t)e=e.insert(n.key,n);return e}function ay(t){let e=oy;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function ni(){return Zr()}function ly(){return Zr()}function Zr(){return new ur(t=>t.toString(),(t,e)=>t.isEqual(e))}const dR=new Ze(me.comparator),hR=new It(me.comparator);function Re(...t){let e=hR;for(const n of t)e=e.add(n);return e}const fR=new It(Le);function mR(){return fR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:za(e)?"-0":e}}function uy(t){return{integerValue:""+t}}function pR(t,e){return K0(e)?uy(e):cy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(){this._=void 0}}function gR(t,e,n){return t instanceof bo?function(i,r){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&ed(r)&&(r=td(r)),r&&(o.fields.__previous_value__=r),{mapValue:o}}(n,e):t instanceof Eo?hy(t,e):t instanceof ko?fy(t,e):function(i,r){const o=dy(i,r),l=Tm(o)+Tm(i.Pe);return tu(o)&&tu(i.Pe)?uy(l):cy(i.serializer,l)}(t,e)}function _R(t,e,n){return t instanceof Eo?hy(t,e):t instanceof ko?fy(t,e):n}function dy(t,e){return t instanceof Ya?function(s){return tu(s)||function(r){return!!r&&"doubleValue"in r}(s)}(e)?e:{integerValue:0}:null}class bo extends Cl{}class Eo extends Cl{constructor(e){super(),this.elements=e}}function hy(t,e){const n=my(e);for(const s of t.elements)n.some(i=>xn(i,s))||n.push(s);return{arrayValue:{values:n}}}class ko extends Cl{constructor(e){super(),this.elements=e}}function fy(t,e){let n=my(e);for(const s of t.elements)n=n.filter(i=>!xn(i,s));return{arrayValue:{values:n}}}class Ya extends Cl{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Tm(t){return it(t.integerValue||t.doubleValue)}function my(t){return nd(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e,n){this.field=e,this.transform=n}}function vR(t,e){return t.field.isEqual(e.field)&&function(s,i){return s instanceof Eo&&i instanceof Eo||s instanceof ko&&i instanceof ko?Xi(s.elements,i.elements,xn):s instanceof Ya&&i instanceof Ya?xn(s.Pe,i.Pe):s instanceof bo&&i instanceof bo}(t.transform,e.transform)}class bR{constructor(e,n){this.version=e,this.transformResults=n}}class wt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new wt}static exists(e){return new wt(void 0,e)}static updateTime(e){return new wt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ta(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Pl{}function py(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Dl(t.key,wt.none()):new Vo(t.key,t.data,wt.none());{const n=t.data,s=Bt.empty();let i=new It(mt.comparator);for(let r of e.fields)if(!i.has(r)){let o=n.field(r);o===null&&r.length>1&&(r=r.popLast(),o=n.field(r)),o===null?s.delete(r):s.set(r,o),i=i.add(r)}return new js(t.key,s,new en(i.toArray()),wt.none())}}function ER(t,e,n){t instanceof Vo?function(i,r,o){const l=i.value.clone(),c=Rm(i.fieldTransforms,r,o.transformResults);l.setAll(c),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof js?function(i,r,o){if(!Ta(i.precondition,r))return void r.convertToUnknownDocument(o.version);const l=Rm(i.fieldTransforms,r,o.transformResults),c=r.data;c.setAll(gy(i)),c.setAll(l),r.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function eo(t,e,n,s){return t instanceof Vo?function(r,o,l,c){if(!Ta(r.precondition,o))return l;const u=r.value.clone(),d=Cm(r.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,s):t instanceof js?function(r,o,l,c){if(!Ta(r.precondition,o))return l;const u=Cm(r.fieldTransforms,c,o),d=o.data;return d.setAll(gy(r)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(m=>m.field))}(t,e,n,s):function(r,o,l){return Ta(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function kR(t,e){let n=null;for(const s of t.fieldTransforms){const i=e.data.field(s.field),r=dy(s.transform,i||null);r!=null&&(n===null&&(n=Bt.empty()),n.set(s.field,r))}return n||null}function Am(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&Xi(s,i,(r,o)=>vR(r,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Vo extends Pl{constructor(e,n,s,i=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class js extends Pl{constructor(e,n,s,i,r=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function gy(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function Rm(t,e,n){const s=new Map;$e(t.length===n.length);for(let i=0;i<n.length;i++){const r=t[i],o=r.transform,l=e.data.field(r.field);s.set(r.field,_R(o,l,n[i]))}return s}function Cm(t,e,n){const s=new Map;for(const i of t){const r=i.transform,o=n.data.field(i.field);s.set(i.field,gR(r,o,e))}return s}class Dl extends Pl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _y extends Pl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e,n,s,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const r=this.mutations[i];r.key.isEqual(e.key)&&ER(r,e,s[i])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=eo(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=eo(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=ly();return this.mutations.forEach(i=>{const r=e.get(i.key),o=r.overlayedDocument;let l=this.applyToLocalView(o,r.mutatedFields);l=n.has(i.key)?null:l;const c=py(o,l);c!==null&&s.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(be.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Re())}isEqual(e){return this.batchId===e.batchId&&Xi(this.mutations,e.mutations,(n,s)=>Am(n,s))&&Xi(this.baseMutations,e.baseMutations,(n,s)=>Am(n,s))}}class od{constructor(e,n,s,i){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=i}static from(e,n,s){$e(e.mutations.length===s.length);let i=function(){return dR}();const r=e.mutations;for(let o=0;o<r.length;o++)i=i.insert(r[o].key,s[o].version);return new od(e,n,s,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st,Me;function yy(t){switch(t){default:return ye();case J.CANCELLED:case J.UNKNOWN:case J.DEADLINE_EXCEEDED:case J.RESOURCE_EXHAUSTED:case J.INTERNAL:case J.UNAVAILABLE:case J.UNAUTHENTICATED:return!1;case J.INVALID_ARGUMENT:case J.NOT_FOUND:case J.ALREADY_EXISTS:case J.PERMISSION_DENIED:case J.FAILED_PRECONDITION:case J.ABORTED:case J.OUT_OF_RANGE:case J.UNIMPLEMENTED:case J.DATA_LOSS:return!0}}function vy(t){if(t===void 0)return Mn("GRPC error has no .code"),J.UNKNOWN;switch(t){case st.OK:return J.OK;case st.CANCELLED:return J.CANCELLED;case st.UNKNOWN:return J.UNKNOWN;case st.DEADLINE_EXCEEDED:return J.DEADLINE_EXCEEDED;case st.RESOURCE_EXHAUSTED:return J.RESOURCE_EXHAUSTED;case st.INTERNAL:return J.INTERNAL;case st.UNAVAILABLE:return J.UNAVAILABLE;case st.UNAUTHENTICATED:return J.UNAUTHENTICATED;case st.INVALID_ARGUMENT:return J.INVALID_ARGUMENT;case st.NOT_FOUND:return J.NOT_FOUND;case st.ALREADY_EXISTS:return J.ALREADY_EXISTS;case st.PERMISSION_DENIED:return J.PERMISSION_DENIED;case st.FAILED_PRECONDITION:return J.FAILED_PRECONDITION;case st.ABORTED:return J.ABORTED;case st.OUT_OF_RANGE:return J.OUT_OF_RANGE;case st.UNIMPLEMENTED:return J.UNIMPLEMENTED;case st.DATA_LOSS:return J.DATA_LOSS;default:return ye()}}(Me=st||(st={}))[Me.OK=0]="OK",Me[Me.CANCELLED=1]="CANCELLED",Me[Me.UNKNOWN=2]="UNKNOWN",Me[Me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Me[Me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Me[Me.NOT_FOUND=5]="NOT_FOUND",Me[Me.ALREADY_EXISTS=6]="ALREADY_EXISTS",Me[Me.PERMISSION_DENIED=7]="PERMISSION_DENIED",Me[Me.UNAUTHENTICATED=16]="UNAUTHENTICATED",Me[Me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Me[Me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Me[Me.ABORTED=10]="ABORTED",Me[Me.OUT_OF_RANGE=11]="OUT_OF_RANGE",Me[Me.UNIMPLEMENTED=12]="UNIMPLEMENTED",Me[Me.INTERNAL=13]="INTERNAL",Me[Me.UNAVAILABLE=14]="UNAVAILABLE",Me[Me.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AR=new oi([4294967295,4294967295],0);function Pm(t){const e=TR().encode(t),n=new F_;return n.update(e),new Uint8Array(n.digest())}function Dm(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),i=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new oi([n,s],0),new oi([i,r],0)]}class ad{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new Fr(`Invalid padding: ${n}`);if(s<0)throw new Fr(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Fr(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new Fr(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=oi.fromNumber(this.Ie)}Ee(e,n,s){let i=e.add(n.multiply(oi.fromNumber(s)));return i.compare(AR)===1&&(i=new oi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Pm(e),[s,i]=Dm(n);for(let r=0;r<this.hashCount;r++){const o=this.Ee(s,i,r);if(!this.de(o))return!1}return!0}static create(e,n,s){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new ad(r,i,n);return s.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=Pm(e),[s,i]=Dm(n);for(let r=0;r<this.hashCount;r++){const o=this.Ee(s,i,r);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class Fr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,n,s,i,r){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const i=new Map;return i.set(e,Lo.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new Ol(be.min(),i,new Ze(Le),ss(),Re())}}class Lo{constructor(e,n,s,i,r){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new Lo(s,n,Re(),Re(),Re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,n,s,i){this.Re=e,this.removedTargetIds=n,this.key=s,this.Ve=i}}class by{constructor(e,n){this.targetId=e,this.me=n}}class Ey{constructor(e,n,s=pt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=i}}class Om{constructor(){this.fe=0,this.ge=Mm(),this.pe=pt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=Re(),n=Re(),s=Re();return this.ge.forEach((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:s=s.add(i);break;default:ye()}}),new Lo(this.pe,this.ye,e,n,s)}ve(){this.we=!1,this.ge=Mm()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,$e(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class RR{constructor(e){this.Le=e,this.Be=new Map,this.ke=ss(),this.qe=Nm(),this.Qe=new Ze(Le)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const s=this.Ge(n);switch(e.state){case 0:this.ze(n)&&s.De(e.resumeToken);break;case 1:s.Oe(),s.Se||s.ve(),s.De(e.resumeToken);break;case 2:s.Oe(),s.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(s.Ne(),s.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),s.De(e.resumeToken));break;default:ye()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((s,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,s=e.me.count,i=this.Je(n);if(i){const r=i.target;if(su(r))if(s===0){const o=new me(r.path);this.Ue(n,o,ht.newNoDocument(o,be.min()))}else $e(s===1);else{const o=this.Ye(n);if(o!==s){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:r=0}=n;let o,l;try{o=_i(s).toUint8Array()}catch(c){if(c instanceof Y_)return gi("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new ad(o,i,r)}catch(c){return gi(c instanceof Fr?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,s){return n.me.count===s-this.nt(e,n.targetId)?0:2}nt(e,n){const s=this.Le.getRemoteKeysForTarget(n);let i=0;return s.forEach(r=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,r,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((r,o)=>{const l=this.Je(o);if(l){if(r.current&&su(l.target)){const c=new me(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,ht.newNoDocument(c,e))}r.be&&(n.set(o,r.Ce()),r.ve())}});let s=Re();this.qe.forEach((r,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(s=s.add(r))}),this.ke.forEach((r,o)=>o.setReadTime(e));const i=new Ol(e,n,this.Qe,this.ke,s);return this.ke=ss(),this.qe=Nm(),this.Qe=new Ze(Le),i}$e(e,n){if(!this.ze(e))return;const s=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,s),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,s){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),s&&(this.ke=this.ke.insert(n,s))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Om,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new It(Le),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||se("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Om),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Nm(){return new Ze(me.comparator)}function Mm(){return new Ze(me.comparator)}const CR={asc:"ASCENDING",desc:"DESCENDING"},PR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},DR={and:"AND",or:"OR"};class OR{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ru(t,e){return t.useProto3Json||xo(e)?e:{value:e}}function Ja(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ky(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function NR(t,e){return Ja(t,e.toTimestamp())}function tn(t){return $e(!!t),be.fromTimestamp(function(n){const s=Ls(n);return new rt(s.seconds,s.nanos)}(t))}function ld(t,e){return ou(t,e).canonicalString()}function ou(t,e){const n=function(i){return new Je(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function wy(t){const e=Je.fromString(t);return $e(Cy(e)),e}function Xa(t,e){return ld(t.databaseId,e.path)}function to(t,e){const n=wy(e);if(n.get(1)!==t.databaseId.projectId)throw new ue(J.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ue(J.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new me(Sy(n))}function Iy(t,e){return ld(t.databaseId,e)}function MR(t){const e=wy(t);return e.length===4?Je.emptyPath():Sy(e)}function au(t){return new Je(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Sy(t){return $e(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function xm(t,e,n){return{name:Xa(t,e),fields:n.value.mapValue.fields}}function xR(t,e){return"found"in e?function(s,i){$e(!!i.found),i.found.name,i.found.updateTime;const r=to(s,i.found.name),o=tn(i.found.updateTime),l=i.found.createTime?tn(i.found.createTime):be.min(),c=new Bt({mapValue:{fields:i.found.fields}});return ht.newFoundDocument(r,o,l,c)}(t,e):"missing"in e?function(s,i){$e(!!i.missing),$e(!!i.readTime);const r=to(s,i.missing),o=tn(i.readTime);return ht.newNoDocument(r,o)}(t,e):ye()}function VR(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ye()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],r=function(u,d){return u.useProto3Json?($e(d===void 0||typeof d=="string"),pt.fromBase64String(d||"")):($e(d===void 0||d instanceof Buffer||d instanceof Uint8Array),pt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?J.UNKNOWN:vy(u.code);return new ue(d,u.message||"")}(o);n=new Ey(s,i,r,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=to(t,s.document.name),r=tn(s.document.updateTime),o=s.document.createTime?tn(s.document.createTime):be.min(),l=new Bt({mapValue:{fields:s.document.fields}}),c=ht.newFoundDocument(i,r,o,l),u=s.targetIds||[],d=s.removedTargetIds||[];n=new Aa(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=to(t,s.document),r=s.readTime?tn(s.readTime):be.min(),o=ht.newNoDocument(i,r),l=s.removedTargetIds||[];n=new Aa([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=to(t,s.document),r=s.removedTargetIds||[];n=new Aa([],r,i,null)}else{if(!("filter"in e))return ye();{e.filter;const s=e.filter;s.targetId;const{count:i=0,unchangedNames:r}=s,o=new SR(i,r),l=s.targetId;n=new by(l,o)}}return n}function Ty(t,e){let n;if(e instanceof Vo)n={update:xm(t,e.key,e.value)};else if(e instanceof Dl)n={delete:Xa(t,e.key)};else if(e instanceof js)n={update:xm(t,e.key,e.data),updateMask:KR(e.fieldMask)};else{if(!(e instanceof _y))return ye();n={verify:Xa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(r,o){const l=o.transform;if(l instanceof bo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Eo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ko)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ya)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw ye()}(0,s))),e.precondition.isNone||(n.currentDocument=function(i,r){return r.updateTime!==void 0?{updateTime:NR(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:ye()}(t,e.precondition)),n}function LR(t,e){return t&&t.length>0?($e(e!==void 0),t.map(n=>function(i,r){let o=i.updateTime?tn(i.updateTime):tn(r);return o.isEqual(be.min())&&(o=tn(r)),new bR(o,i.transformResults||[])}(n,e))):[]}function $R(t,e){return{documents:[Iy(t,e.path)]}}function FR(t,e){const n={structuredQuery:{}},s=e.path;let i;e.collectionGroup!==null?(i=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=Iy(t,i);const r=function(u){if(u.length!==0)return Ry(Vn.create(u,"and"))}(e.filters);r&&(n.structuredQuery.where=r);const o=function(u){if(u.length!==0)return u.map(d=>function(g){return{field:Mi(g.field),direction:jR(g.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=ru(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:i}}function UR(t){let e=MR(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let i=null;if(s>0){$e(s===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let r=[];n.where&&(r=function(m){const g=Ay(m);return g instanceof Vn&&ey(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(A){return new Qa(xi(A.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(g))}(n.orderBy));let l=null;n.limit&&(l=function(m){let g;return g=typeof m=="object"?m.value:m,xo(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(m){const g=!!m.before,y=m.values||[];return new Wa(y,g)}(n.startAt));let u=null;return n.endAt&&(u=function(m){const g=!m.before,y=m.values||[];return new Wa(y,g)}(n.endAt)),rR(e,i,o,r,l,"F",c,u)}function BR(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ye()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Ay(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=xi(n.unaryFilter.field);return at.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=xi(n.unaryFilter.field);return at.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=xi(n.unaryFilter.field);return at.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=xi(n.unaryFilter.field);return at.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ye()}}(t):t.fieldFilter!==void 0?function(n){return at.create(xi(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ye()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Vn.create(n.compositeFilter.filters.map(s=>Ay(s)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ye()}}(n.compositeFilter.op))}(t):ye()}function jR(t){return CR[t]}function HR(t){return PR[t]}function qR(t){return DR[t]}function Mi(t){return{fieldPath:t.canonicalString()}}function xi(t){return mt.fromServerFormat(t.fieldPath)}function Ry(t){return t instanceof at?function(n){if(n.op==="=="){if(Em(n.value))return{unaryFilter:{field:Mi(n.field),op:"IS_NAN"}};if(bm(n.value))return{unaryFilter:{field:Mi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Em(n.value))return{unaryFilter:{field:Mi(n.field),op:"IS_NOT_NAN"}};if(bm(n.value))return{unaryFilter:{field:Mi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mi(n.field),op:HR(n.op),value:n.value}}}(t):t instanceof Vn?function(n){const s=n.getFilters().map(i=>Ry(i));return s.length===1?s[0]:{compositeFilter:{op:qR(n.op),filters:s}}}(t):ye()}function KR(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Cy(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,n,s,i,r=be.min(),o=be.min(),l=pt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Ts(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e){this.ct=e}}function zR(t){const e=UR({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?iu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(){this.an=new QR}addToCollectionParentIndex(e,n){return this.an.add(n),Y.resolve()}getCollectionParents(e,n){return Y.resolve(this.an.getEntries(n))}addFieldIndex(e,n){return Y.resolve()}deleteFieldIndex(e,n){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,n){return Y.resolve()}getDocumentsMatchingTarget(e,n){return Y.resolve(null)}getIndexType(e,n){return Y.resolve(0)}getFieldIndexes(e,n){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,n){return Y.resolve(Vs.min())}getMinOffsetFromCollectionGroup(e,n){return Y.resolve(Vs.min())}updateCollectionGroup(e,n,s){return Y.resolve()}updateIndexEntries(e,n){return Y.resolve()}}class QR{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),i=this.index[n]||new It(Je.comparator),r=!i.has(s);return this.index[n]=i.add(s),r}has(e){const n=e.lastSegment(),s=e.popLast(),i=this.index[n];return i&&i.has(s)}getEntries(e){return(this.index[e]||new It(Je.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static Ln(){return new nr(0)}static Bn(){return new nr(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(){this.changes=new ur(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ht.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?Y.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e,n,s,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=i}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(s=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(s!==null&&eo(s.mutation,i,en.empty(),rt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,Re()).next(()=>s))}getLocalViewOfDocuments(e,n,s=Re()){const i=ni();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,s).next(r=>{let o=$r();return r.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=ni();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,Re()))}populateOverlays(e,n,s){const i=[];return s.forEach(r=>{n.has(r)||i.push(r)}),this.documentOverlayCache.getOverlays(e,i).next(r=>{r.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,s,i){let r=ss();const o=Zr(),l=function(){return Zr()}();return n.forEach((c,u)=>{const d=s.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof js)?r=r.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),eo(d.mutation,u,d.mutation.getFieldMask(),rt.now())):o.set(u.key,en.empty())}),this.recalculateAndSaveOverlays(e,r).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var m;return l.set(u,new JR(d,(m=o.get(u))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const s=Zr();let i=new Ze((o,l)=>o-l),r=Re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=s.get(c)||en.empty();d=l.applyToLocalView(u,d),s.set(c,d);const m=(i.get(l.batchId)||Re()).add(c);i=i.insert(l.batchId,m)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,m=ly();d.forEach(g=>{if(!r.has(g)){const y=py(n.get(g),s.get(g));y!==null&&m.set(g,y),r=r.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,m))}return Y.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s,i){return function(o){return me.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):oR(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,i):this.getDocumentsMatchingCollectionQuery(e,n,s,i)}getNextDocuments(e,n,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,i).next(r=>{const o=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,i-r.size):Y.resolve(ni());let l=-1,c=r;return o.next(u=>Y.forEach(u,(d,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),r.get(d)?Y.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,u,r)).next(()=>this.computeViews(e,c,u,Re())).next(d=>({batchId:l,changes:ay(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new me(n)).next(s=>{let i=$r();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,s,i){const r=n.collectionGroup;let o=$r();return this.indexManager.getCollectionParents(e,r).next(l=>Y.forEach(l,c=>{const u=function(m,g){return new Tl(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(r));return this.getDocumentsMatchingCollectionQuery(e,u,s,i).next(d=>{d.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,s,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,r,i))).next(o=>{r.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,ht.newInvalidDocument(d)))});let l=$r();return o.forEach((c,u)=>{const d=r.get(c);d!==void 0&&eo(d.mutation,u,en.empty(),rt.now()),Rl(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e){this.serializer=e,this.lr=new Map,this.hr=new Map}getBundleMetadata(e,n){return Y.resolve(this.lr.get(n))}saveBundleMetadata(e,n){return this.lr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:tn(i.createTime)}}(n)),Y.resolve()}getNamedQuery(e,n){return Y.resolve(this.hr.get(n))}saveNamedQuery(e,n){return this.hr.set(n.name,function(i){return{name:i.name,query:zR(i.bundledQuery),readTime:tn(i.readTime)}}(n)),Y.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(){this.overlays=new Ze(me.comparator),this.Pr=new Map}getOverlay(e,n){return Y.resolve(this.overlays.get(n))}getOverlays(e,n){const s=ni();return Y.forEach(n,i=>this.getOverlay(e,i).next(r=>{r!==null&&s.set(i,r)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((i,r)=>{this.ht(e,n,r)}),Y.resolve()}removeOverlaysForBatchId(e,n,s){const i=this.Pr.get(s);return i!==void 0&&(i.forEach(r=>this.overlays=this.overlays.remove(r)),this.Pr.delete(s)),Y.resolve()}getOverlaysForCollection(e,n,s){const i=ni(),r=n.length+1,o=new me(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===r&&c.largestBatchId>s&&i.set(c.getKey(),c)}return Y.resolve(i)}getOverlaysForCollectionGroup(e,n,s,i){let r=new Ze((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>s){let d=r.get(u.largestBatchId);d===null&&(d=ni(),r=r.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=ni(),c=r.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=i)););return Y.resolve(l)}ht(e,n,s){const i=this.overlays.get(s.key);if(i!==null){const o=this.Pr.get(i.largestBatchId).delete(s.key);this.Pr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new IR(n,s));let r=this.Pr.get(n);r===void 0&&(r=Re(),this.Pr.set(n,r)),this.Pr.set(n,r.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(){this.sessionToken=pt.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Y.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(){this.Ir=new It(dt.Tr),this.Er=new It(dt.dr)}isEmpty(){return this.Ir.isEmpty()}addReference(e,n){const s=new dt(e,n);this.Ir=this.Ir.add(s),this.Er=this.Er.add(s)}Ar(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.Rr(new dt(e,n))}Vr(e,n){e.forEach(s=>this.removeReference(s,n))}mr(e){const n=new me(new Je([])),s=new dt(n,e),i=new dt(n,e+1),r=[];return this.Er.forEachInRange([s,i],o=>{this.Rr(o),r.push(o.key)}),r}gr(){this.Ir.forEach(e=>this.Rr(e))}Rr(e){this.Ir=this.Ir.delete(e),this.Er=this.Er.delete(e)}pr(e){const n=new me(new Je([])),s=new dt(n,e),i=new dt(n,e+1);let r=Re();return this.Er.forEachInRange([s,i],o=>{r=r.add(o.key)}),r}containsKey(e){const n=new dt(e,0),s=this.Ir.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class dt{constructor(e,n){this.key=e,this.yr=n}static Tr(e,n){return me.comparator(e.key,n.key)||Le(e.yr,n.yr)}static dr(e,n){return Le(e.yr,n.yr)||me.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.wr=1,this.Sr=new It(dt.Tr)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,i){const r=this.wr;this.wr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new wR(r,n,s,i);this.mutationQueue.push(o);for(const l of i)this.Sr=this.Sr.add(new dt(l.key,r)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Y.resolve(o)}lookupMutationBatch(e,n){return Y.resolve(this.br(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,i=this.Dr(s),r=i<0?0:i;return Y.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?-1:this.wr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new dt(n,0),i=new dt(n,Number.POSITIVE_INFINITY),r=[];return this.Sr.forEachInRange([s,i],o=>{const l=this.br(o.yr);r.push(l)}),Y.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new It(Le);return n.forEach(i=>{const r=new dt(i,0),o=new dt(i,Number.POSITIVE_INFINITY);this.Sr.forEachInRange([r,o],l=>{s=s.add(l.yr)})}),Y.resolve(this.Cr(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,i=s.length+1;let r=s;me.isDocumentKey(r)||(r=r.child(""));const o=new dt(new me(r),0);let l=new It(Le);return this.Sr.forEachWhile(c=>{const u=c.key.path;return!!s.isPrefixOf(u)&&(u.length===i&&(l=l.add(c.yr)),!0)},o),Y.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(s=>{const i=this.br(s);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){$e(this.vr(n.batchId,"removed")===0),this.mutationQueue.shift();let s=this.Sr;return Y.forEach(n.mutations,i=>{const r=new dt(i.key,n.batchId);return s=s.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Sr=s})}xn(e){}containsKey(e,n){const s=new dt(n,0),i=this.Sr.firstAfterOrEqual(s);return Y.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}vr(e,n){return this.Dr(e)}Dr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}br(e){const n=this.Dr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(e){this.Fr=e,this.docs=function(){return new Ze(me.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,i=this.docs.get(s),r=i?i.size:0,o=this.Fr(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return Y.resolve(s?s.document.mutableCopy():ht.newInvalidDocument(n))}getEntries(e,n){let s=ss();return n.forEach(i=>{const r=this.docs.get(i);s=s.insert(i,r?r.document.mutableCopy():ht.newInvalidDocument(i))}),Y.resolve(s)}getDocumentsMatchingQuery(e,n,s,i){let r=ss();const o=n.path,l=new me(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||U0(F0(d),s)<=0||(i.has(d.key)||Rl(n,d))&&(r=r.insert(d.key,d.mutableCopy()))}return Y.resolve(r)}getAllFromCollectionGroup(e,n,s,i){ye()}Mr(e,n){return Y.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new iC(this)}getSize(e){return Y.resolve(this.size)}}class iC extends YR{constructor(e){super(),this.ur=e}applyChanges(e){const n=[];return this.changes.forEach((s,i)=>{i.isValidDocument()?n.push(this.ur.addEntry(e,i)):this.ur.removeEntry(s)}),Y.waitFor(n)}getFromCache(e,n){return this.ur.getEntry(e,n)}getAllFromCache(e,n){return this.ur.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e){this.persistence=e,this.Or=new ur(n=>sd(n),id),this.lastRemoteSnapshotVersion=be.min(),this.highestTargetId=0,this.Nr=0,this.Lr=new cd,this.targetCount=0,this.Br=nr.Ln()}forEachTarget(e,n){return this.Or.forEach((s,i)=>n(i)),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.Nr)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.Nr&&(this.Nr=n),Y.resolve()}Qn(e){this.Or.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Br=new nr(n),this.highestTargetId=n),e.sequenceNumber>this.Nr&&(this.Nr=e.sequenceNumber)}addTargetData(e,n){return this.Qn(n),this.targetCount+=1,Y.resolve()}updateTargetData(e,n){return this.Qn(n),Y.resolve()}removeTargetData(e,n){return this.Or.delete(n.target),this.Lr.mr(n.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,n,s){let i=0;const r=[];return this.Or.forEach((o,l)=>{l.sequenceNumber<=n&&s.get(l.targetId)===null&&(this.Or.delete(o),r.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),Y.waitFor(r).next(()=>i)}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,n){const s=this.Or.get(n)||null;return Y.resolve(s)}addMatchingKeys(e,n,s){return this.Lr.Ar(n,s),Y.resolve()}removeMatchingKeys(e,n,s){this.Lr.Vr(n,s);const i=this.persistence.referenceDelegate,r=[];return i&&n.forEach(o=>{r.push(i.markPotentiallyOrphaned(e,o))}),Y.waitFor(r)}removeMatchingKeysForTargetId(e,n){return this.Lr.mr(n),Y.resolve()}getMatchingKeysForTargetId(e,n){const s=this.Lr.pr(n);return Y.resolve(s)}containsKey(e,n){return Y.resolve(this.Lr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e,n){this.kr={},this.overlays={},this.qr=new Zu(0),this.Qr=!1,this.Qr=!0,this.Kr=new tC,this.referenceDelegate=e(this),this.$r=new rC(this),this.indexManager=new WR,this.remoteDocumentCache=function(i){return new sC(i)}(s=>this.referenceDelegate.Ur(s)),this.serializer=new GR(n),this.Wr=new ZR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Qr=!1,Promise.resolve()}get started(){return this.Qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new eC,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.kr[e.toKey()];return s||(s=new nC(n,this.referenceDelegate),this.kr[e.toKey()]=s),s}getGlobalsCache(){return this.Kr}getTargetCache(){return this.$r}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Wr}runTransaction(e,n,s){se("MemoryPersistence","Starting transaction:",e);const i=new aC(this.qr.next());return this.referenceDelegate.Gr(),s(i).next(r=>this.referenceDelegate.zr(i).next(()=>r)).toPromise().then(r=>(i.raiseOnCommittedEvent(),r))}jr(e,n){return Y.or(Object.values(this.kr).map(s=>()=>s.containsKey(e,n)))}}class aC extends j0{constructor(e){super(),this.currentSequenceNumber=e}}class ud{constructor(e){this.persistence=e,this.Hr=new cd,this.Jr=null}static Yr(e){return new ud(e)}get Zr(){if(this.Jr)return this.Jr;throw ye()}addReference(e,n,s){return this.Hr.addReference(s,n),this.Zr.delete(s.toString()),Y.resolve()}removeReference(e,n,s){return this.Hr.removeReference(s,n),this.Zr.add(s.toString()),Y.resolve()}markPotentiallyOrphaned(e,n){return this.Zr.add(n.toString()),Y.resolve()}removeTarget(e,n){this.Hr.mr(n.targetId).forEach(i=>this.Zr.add(i.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(r=>this.Zr.add(r.toString()))}).next(()=>s.removeTargetData(e,n))}Gr(){this.Jr=new Set}zr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.Zr,s=>{const i=me.fromPath(s);return this.Xr(e,i).next(r=>{r||n.removeEntry(i,be.min())})}).next(()=>(this.Jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Xr(e,n).next(s=>{s?this.Zr.delete(n.toString()):this.Zr.add(n.toString())})}Ur(e){return 0}Xr(e,n){return Y.or([()=>Y.resolve(this.Hr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.jr(e,n)])}}function lC(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,n,s,i){this.targetId=e,this.fromCache=n,this.Ki=s,this.$i=i}static Ui(e,n){let s=Re(),i=Re();for(const r of n.docChanges)switch(r.type){case 0:s=s.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new dd(e,n.fromCache,s,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(){this.Wi=!1,this.Gi=!1,this.zi=100,this.ji=function(){return XI()?8:W_(ot())>0?6:4}()}initialize(e,n){this.Hi=e,this.indexManager=n,this.Wi=!0}getDocumentsMatchingQuery(e,n,s,i){const r={result:null};return this.Ji(e,n).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.Yi(e,n,i,s).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new cC;return this.Zi(e,n,o).next(l=>{if(r.result=l,this.Gi)return this.Xi(e,n,o,l.size)})}).next(()=>r.result)}Xi(e,n,s,i){return s.documentReadCount<this.zi?(Or()<=De.DEBUG&&se("QueryEngine","SDK will not create cache indexes for query:",Ni(n),"since it only creates cache indexes for collection contains","more than or equal to",this.zi,"documents"),Y.resolve()):(Or()<=De.DEBUG&&se("QueryEngine","Query:",Ni(n),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.ji*i?(Or()<=De.DEBUG&&se("QueryEngine","The SDK decides to create cache indexes for query:",Ni(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Nn(n))):Y.resolve())}Ji(e,n){if(Sm(n))return Y.resolve(null);let s=Nn(n);return this.indexManager.getIndexType(e,s).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=iu(n,null,"F"),s=Nn(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(r=>{const o=Re(...r);return this.Hi.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,s).next(c=>{const u=this.es(n,l);return this.ts(n,u,o,c.readTime)?this.Ji(e,iu(n,null,"F")):this.ns(e,u,n,c)}))})))}Yi(e,n,s,i){return Sm(n)||i.isEqual(be.min())?Y.resolve(null):this.Hi.getDocuments(e,s).next(r=>{const o=this.es(n,r);return this.ts(n,o,s,i)?Y.resolve(null):(Or()<=De.DEBUG&&se("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ni(n)),this.ns(e,o,n,$0(i,-1)).next(l=>l))})}es(e,n){let s=new It(ry(e));return n.forEach((i,r)=>{Rl(e,r)&&(s=s.add(r))}),s}ts(e,n,s,i){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const r=e.limitType==="F"?n.last():n.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Zi(e,n,s){return Or()<=De.DEBUG&&se("QueryEngine","Using full collection scan to execute query:",Ni(n)),this.Hi.getDocumentsMatchingQuery(e,n,Vs.min(),s)}ns(e,n,s,i){return this.Hi.getDocumentsMatchingQuery(e,s,i).next(r=>(n.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e,n,s,i){this.persistence=e,this.rs=n,this.serializer=i,this.ss=new Ze(Le),this.os=new ur(r=>sd(r),id),this._s=new Map,this.us=e.getRemoteDocumentCache(),this.$r=e.getTargetCache(),this.Wr=e.getBundleCache(),this.cs(s)}cs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new XR(this.us,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.us.setIndexManager(this.indexManager),this.rs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ss))}}function hC(t,e,n,s){return new dC(t,e,n,s)}async function Py(t,e){const n=ke(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let i;return n.mutationQueue.getAllMutationBatches(s).next(r=>(i=r,n.cs(e),n.mutationQueue.getAllMutationBatches(s))).next(r=>{const o=[],l=[];let c=Re();for(const u of i){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of r){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(s,c).next(u=>({ls:u,removedBatchIds:o,addedBatchIds:l}))})})}function fC(t,e){const n=ke(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const i=e.batch.keys(),r=n.us.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const m=u.batch,g=m.keys();let y=Y.resolve();return g.forEach(A=>{y=y.next(()=>d.getEntry(c,A)).next(F=>{const N=u.docVersions.get(A);$e(N!==null),F.version.compareTo(N)<0&&(m.applyToRemoteDocument(F,u),F.isValidDocument()&&(F.setReadTime(u.commitVersion),d.addEntry(F)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(n,s,e,r).next(()=>r.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(l){let c=Re();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(s,i))})}function Dy(t){const e=ke(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.$r.getLastRemoteSnapshotVersion(n))}function mC(t,e){const n=ke(t),s=e.snapshotVersion;let i=n.ss;return n.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=n.us.newChangeBuffer({trackRemovals:!0});i=n.ss;const l=[];e.targetChanges.forEach((d,m)=>{const g=i.get(m);if(!g)return;l.push(n.$r.removeMatchingKeys(r,d.removedDocuments,m).next(()=>n.$r.addMatchingKeys(r,d.addedDocuments,m)));let y=g.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(m)!==null?y=y.withResumeToken(pt.EMPTY_BYTE_STRING,be.min()).withLastLimboFreeSnapshotVersion(be.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,s)),i=i.insert(m,y),function(F,N,x){return F.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(g,y,d)&&l.push(n.$r.updateTargetData(r,y))});let c=ss(),u=Re();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(r,d))}),l.push(pC(r,o,e.documentUpdates).next(d=>{c=d.hs,u=d.Ps})),!s.isEqual(be.min())){const d=n.$r.getLastRemoteSnapshotVersion(r).next(m=>n.$r.setTargetsMetadata(r,r.currentSequenceNumber,s));l.push(d)}return Y.waitFor(l).next(()=>o.apply(r)).next(()=>n.localDocuments.getLocalViewOfDocuments(r,c,u)).next(()=>c)}).then(r=>(n.ss=i,r))}function pC(t,e,n){let s=Re(),i=Re();return n.forEach(r=>s=s.add(r)),e.getEntries(t,s).next(r=>{let o=ss();return n.forEach((l,c)=>{const u=r.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(be.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):se("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{hs:o,Ps:i}})}function gC(t,e){const n=ke(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function _C(t,e){const n=ke(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let i;return n.$r.getTargetData(s,e).next(r=>r?(i=r,Y.resolve(i)):n.$r.allocateTargetId(s).next(o=>(i=new Ts(e,o,"TargetPurposeListen",s.currentSequenceNumber),n.$r.addTargetData(s,i).next(()=>i))))}).then(s=>{const i=n.ss.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ss=n.ss.insert(s.targetId,s),n.os.set(e,s.targetId)),s})}async function lu(t,e,n){const s=ke(t),i=s.ss.get(e),r=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",r,o=>s.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Mo(o))throw o;se("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.ss=s.ss.remove(e),s.os.delete(i.target)}function Vm(t,e,n){const s=ke(t);let i=be.min(),r=Re();return s.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const m=ke(c),g=m.os.get(d);return g!==void 0?Y.resolve(m.ss.get(g)):m.$r.getTargetData(u,d)}(s,o,Nn(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,s.$r.getMatchingKeysForTargetId(o,l.targetId).next(c=>{r=c})}).next(()=>s.rs.getDocumentsMatchingQuery(o,e,n?i:be.min(),n?r:Re())).next(l=>(yC(s,lR(e),l),{documents:l,Is:r})))}function yC(t,e,n){let s=t._s.get(e)||be.min();n.forEach((i,r)=>{r.readTime.compareTo(s)>0&&(s=r.readTime)}),t._s.set(e,s)}class Lm{constructor(){this.activeTargetIds=mR()}Vs(e){this.activeTargetIds=this.activeTargetIds.add(e)}fs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Rs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vC{constructor(){this.io=new Lm,this.so={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e){return this.io.Vs(e),this.so[e]||"not-current"}updateQueryState(e,n,s){this.so[e]=n}removeLocalQueryTarget(e){this.io.fs(e)}isLocalQueryTarget(e){return this.io.activeTargetIds.has(e)}clearQueryState(e){delete this.so[e]}getAllActiveQueryTargets(){return this.io.activeTargetIds}isActiveQueryTarget(e){return this.io.activeTargetIds.has(e)}start(){return this.io=new Lm,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m{constructor(){this._o=()=>this.ao(),this.uo=()=>this.co(),this.lo=[],this.ho()}oo(e){this.lo.push(e)}shutdown(){window.removeEventListener("online",this._o),window.removeEventListener("offline",this.uo)}ho(){window.addEventListener("online",this._o),window.addEventListener("offline",this.uo)}ao(){se("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.lo)e(0)}co(){se("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.lo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fa=null;function Ac(){return fa===null?fa=function(){return 268435456+Math.round(2147483648*Math.random())}():fa++,"0x"+fa.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(e){this.Po=e.Po,this.Io=e.Io}To(e){this.Eo=e}Ao(e){this.Ro=e}Vo(e){this.mo=e}onMessage(e){this.fo=e}close(){this.Io()}send(e){this.Po(e)}po(){this.Eo()}yo(){this.Ro()}wo(e){this.mo(e)}So(e){this.fo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pt="WebChannelConnection";class wC extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const s=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.bo=s+"://"+n.host,this.Do=`projects/${i}/databases/${r}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${r}`}get vo(){return!1}Fo(n,s,i,r,o){const l=Ac(),c=this.Mo(n,s.toUriEncodedString());se("RestConnection",`Sending RPC '${n}' ${l}:`,c,i);const u={"google-cloud-resource-prefix":this.Do,"x-goog-request-params":this.Co};return this.xo(u,r,o),this.Oo(n,c,u,i).then(d=>(se("RestConnection",`Received RPC '${n}' ${l}: `,d),d),d=>{throw gi("RestConnection",`RPC '${n}' ${l} failed with error: `,d,"url: ",c,"request:",i),d})}No(n,s,i,r,o,l){return this.Fo(n,s,i,r,o)}xo(n,s,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+cr}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach((r,o)=>n[o]=r),i&&i.headers.forEach((r,o)=>n[o]=r)}Mo(n,s){const i=EC[n];return`${this.bo}/v1/${s}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Oo(e,n,s,i){const r=Ac();return new Promise((o,l)=>{const c=new U_;c.setWithCredentials(!0),c.listenOnce(j_.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Ia.NO_ERROR:const d=c.getResponseJson();se(Pt,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(d)),o(d);break;case Ia.TIMEOUT:se(Pt,`RPC '${e}' ${r} timed out`),l(new ue(J.DEADLINE_EXCEEDED,"Request time out"));break;case Ia.HTTP_ERROR:const m=c.getStatus();if(se(Pt,`RPC '${e}' ${r} failed with status:`,m,"response text:",c.getResponseText()),m>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const y=g==null?void 0:g.error;if(y&&y.status&&y.message){const A=function(N){const x=N.toLowerCase().replace(/_/g,"-");return Object.values(J).indexOf(x)>=0?x:J.UNKNOWN}(y.status);l(new ue(A,y.message))}else l(new ue(J.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ue(J.UNAVAILABLE,"Connection failed."));break;default:ye()}}finally{se(Pt,`RPC '${e}' ${r} completed.`)}});const u=JSON.stringify(i);se(Pt,`RPC '${e}' ${r} sending request:`,i),c.send(n,"POST",u,s,15)})}Lo(e,n,s){const i=Ac(),r=[this.bo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=K_(),l=q_(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new B_({})),this.xo(c.initMessageHeaders,n,s),c.encodeInitMessageHeaders=!0;const d=r.join("");se(Pt,`Creating RPC '${e}' stream ${i}: ${d}`,c);const m=o.createWebChannel(d,c);let g=!1,y=!1;const A=new kC({Po:N=>{y?se(Pt,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(g||(se(Pt,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),se(Pt,`RPC '${e}' stream ${i} sending:`,N),m.send(N))},Io:()=>m.close()}),F=(N,x,V)=>{N.listen(x,R=>{try{V(R)}catch(D){setTimeout(()=>{throw D},0)}})};return F(m,Lr.EventType.OPEN,()=>{y||(se(Pt,`RPC '${e}' stream ${i} transport opened.`),A.po())}),F(m,Lr.EventType.CLOSE,()=>{y||(y=!0,se(Pt,`RPC '${e}' stream ${i} transport closed`),A.wo())}),F(m,Lr.EventType.ERROR,N=>{y||(y=!0,gi(Pt,`RPC '${e}' stream ${i} transport errored:`,N),A.wo(new ue(J.UNAVAILABLE,"The operation could not be completed")))}),F(m,Lr.EventType.MESSAGE,N=>{var x;if(!y){const V=N.data[0];$e(!!V);const R=V,D=R.error||((x=R[0])===null||x===void 0?void 0:x.error);if(D){se(Pt,`RPC '${e}' stream ${i} received error:`,D);const P=D.status;let H=function(E){const S=st[E];if(S!==void 0)return vy(S)}(P),k=D.message;H===void 0&&(H=J.INTERNAL,k="Unknown error status: "+P+" with message "+D.message),y=!0,A.wo(new ue(H,k)),m.close()}else se(Pt,`RPC '${e}' stream ${i} received:`,V),A.So(V)}}),F(l,H_.STAT_EVENT,N=>{N.stat===Zc.PROXY?se(Pt,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Zc.NOPROXY&&se(Pt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{A.yo()},0),A}}function Rc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nl(t){return new OR(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(e,n,s=1e3,i=1.5,r=6e4){this.ai=e,this.timerId=n,this.Bo=s,this.ko=i,this.qo=r,this.Qo=0,this.Ko=null,this.$o=Date.now(),this.reset()}reset(){this.Qo=0}Uo(){this.Qo=this.qo}Wo(e){this.cancel();const n=Math.floor(this.Qo+this.Go()),s=Math.max(0,Date.now()-this.$o),i=Math.max(0,n-s);i>0&&se("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Qo} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.Ko=this.ai.enqueueAfterDelay(this.timerId,i,()=>(this.$o=Date.now(),e())),this.Qo*=this.ko,this.Qo<this.Bo&&(this.Qo=this.Bo),this.Qo>this.qo&&(this.Qo=this.qo)}zo(){this.Ko!==null&&(this.Ko.skipDelay(),this.Ko=null)}cancel(){this.Ko!==null&&(this.Ko.cancel(),this.Ko=null)}Go(){return(Math.random()-.5)*this.Qo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e,n,s,i,r,o,l,c){this.ai=e,this.jo=s,this.Ho=i,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Jo=0,this.Yo=null,this.Zo=null,this.stream=null,this.Xo=0,this.e_=new hd(e,n)}t_(){return this.state===1||this.state===5||this.n_()}n_(){return this.state===2||this.state===3}start(){this.Xo=0,this.state!==4?this.auth():this.r_()}async stop(){this.t_()&&await this.close(0)}i_(){this.state=0,this.e_.reset()}s_(){this.n_()&&this.Yo===null&&(this.Yo=this.ai.enqueueAfterDelay(this.jo,6e4,()=>this.o_()))}__(e){this.a_(),this.stream.send(e)}async o_(){if(this.n_())return this.close(0)}a_(){this.Yo&&(this.Yo.cancel(),this.Yo=null)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}async close(e,n){this.a_(),this.u_(),this.e_.cancel(),this.Jo++,e!==4?this.e_.reset():n&&n.code===J.RESOURCE_EXHAUSTED?(Mn(n.toString()),Mn("Using maximum backoff delay to prevent overloading the backend."),this.e_.Uo()):n&&n.code===J.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.c_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Vo(n)}c_(){}auth(){this.state=1;const e=this.l_(this.Jo),n=this.Jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,i])=>{this.Jo===n&&this.h_(s,i)},s=>{e(()=>{const i=new ue(J.UNKNOWN,"Fetching auth token failed: "+s.message);return this.P_(i)})})}h_(e,n){const s=this.l_(this.Jo);this.stream=this.I_(e,n),this.stream.To(()=>{s(()=>this.listener.To())}),this.stream.Ao(()=>{s(()=>(this.state=2,this.Zo=this.ai.enqueueAfterDelay(this.Ho,1e4,()=>(this.n_()&&(this.state=3),Promise.resolve())),this.listener.Ao()))}),this.stream.Vo(i=>{s(()=>this.P_(i))}),this.stream.onMessage(i=>{s(()=>++this.Xo==1?this.T_(i):this.onNext(i))})}r_(){this.state=5,this.e_.Wo(async()=>{this.state=0,this.start()})}P_(e){return se("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}l_(e){return n=>{this.ai.enqueueAndForget(()=>this.Jo===e?n():(se("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class IC extends Oy{constructor(e,n,s,i,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,i,o),this.serializer=r}I_(e,n){return this.connection.Lo("Listen",e,n)}T_(e){return this.onNext(e)}onNext(e){this.e_.reset();const n=VR(this.serializer,e),s=function(r){if(!("targetChange"in r))return be.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?be.min():o.readTime?tn(o.readTime):be.min()}(e);return this.listener.E_(n,s)}d_(e){const n={};n.database=au(this.serializer),n.addTarget=function(r,o){let l;const c=o.target;if(l=su(c)?{documents:$R(r,c)}:{query:FR(r,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=ky(r,o.resumeToken);const u=ru(r,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(be.min())>0){l.readTime=Ja(r,o.snapshotVersion.toTimestamp());const u=ru(r,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const s=BR(this.serializer,e);s&&(n.labels=s),this.__(n)}A_(e){const n={};n.database=au(this.serializer),n.removeTarget=e,this.__(n)}}class SC extends Oy{constructor(e,n,s,i,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,i,o),this.serializer=r}get R_(){return this.Xo>0}start(){this.lastStreamToken=void 0,super.start()}c_(){this.R_&&this.V_([])}I_(e,n){return this.connection.Lo("Write",e,n)}T_(e){return $e(!!e.streamToken),this.lastStreamToken=e.streamToken,$e(!e.writeResults||e.writeResults.length===0),this.listener.m_()}onNext(e){$e(!!e.streamToken),this.lastStreamToken=e.streamToken,this.e_.reset();const n=LR(e.writeResults,e.commitTime),s=tn(e.commitTime);return this.listener.f_(s,n)}g_(){const e={};e.database=au(this.serializer),this.__(e)}V_(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>Ty(this.serializer,s))};this.__(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC extends class{}{constructor(e,n,s,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=i,this.p_=!1}y_(){if(this.p_)throw new ue(J.FAILED_PRECONDITION,"The client has already been terminated.")}Fo(e,n,s,i){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.Fo(e,ou(n,s),i,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new ue(J.UNKNOWN,r.toString())})}No(e,n,s,i,r){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.No(e,ou(n,s),i,o,l,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===J.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ue(J.UNKNOWN,o.toString())})}terminate(){this.p_=!0,this.connection.terminate()}}class AC{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.w_=0,this.S_=null,this.b_=!0}D_(){this.w_===0&&(this.C_("Unknown"),this.S_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.S_=null,this.v_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}F_(e){this.state==="Online"?this.C_("Unknown"):(this.w_++,this.w_>=1&&(this.M_(),this.v_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.M_(),this.w_=0,e==="Online"&&(this.b_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}v_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.b_?(Mn(n),this.b_=!1):se("OnlineStateTracker",n)}M_(){this.S_!==null&&(this.S_.cancel(),this.S_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,n,s,i,r){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.x_=[],this.O_=new Map,this.N_=new Set,this.L_=[],this.B_=r,this.B_.oo(o=>{s.enqueueAndForget(async()=>{ki(this)&&(se("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=ke(c);u.N_.add(4),await dr(u),u.k_.set("Unknown"),u.N_.delete(4),await $o(u)}(this))})}),this.k_=new AC(s,i)}}async function $o(t){if(ki(t))for(const e of t.L_)await e(!0)}async function dr(t){for(const e of t.L_)await e(!1)}function Ny(t,e){const n=ke(t);n.O_.has(e.targetId)||(n.O_.set(e.targetId,e),gd(n)?pd(n):hr(n).n_()&&md(n,e))}function fd(t,e){const n=ke(t),s=hr(n);n.O_.delete(e),s.n_()&&My(n,e),n.O_.size===0&&(s.n_()?s.s_():ki(n)&&n.k_.set("Unknown"))}function md(t,e){if(t.q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(be.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}hr(t).d_(e)}function My(t,e){t.q_.xe(e),hr(t).A_(e)}function pd(t){t.q_=new RR({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.O_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),hr(t).start(),t.k_.D_()}function gd(t){return ki(t)&&!hr(t).t_()&&t.O_.size>0}function ki(t){return ke(t).N_.size===0}function xy(t){t.q_=void 0}async function CC(t){t.k_.set("Online")}async function PC(t){t.O_.forEach((e,n)=>{md(t,e)})}async function DC(t,e){xy(t),gd(t)?(t.k_.F_(e),pd(t)):t.k_.set("Unknown")}async function OC(t,e,n){if(t.k_.set("Online"),e instanceof Ey&&e.state===2&&e.cause)try{await async function(i,r){const o=r.cause;for(const l of r.targetIds)i.O_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.O_.delete(l),i.q_.removeTarget(l))}(t,e)}catch(s){se("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Za(t,s)}else if(e instanceof Aa?t.q_.Ke(e):e instanceof by?t.q_.He(e):t.q_.We(e),!n.isEqual(be.min()))try{const s=await Dy(t.localStore);n.compareTo(s)>=0&&await function(r,o){const l=r.q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=r.O_.get(u);d&&r.O_.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=r.O_.get(c);if(!d)return;r.O_.set(c,d.withResumeToken(pt.EMPTY_BYTE_STRING,d.snapshotVersion)),My(r,c);const m=new Ts(d.target,c,u,d.sequenceNumber);md(r,m)}),r.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(s){se("RemoteStore","Failed to raise snapshot:",s),await Za(t,s)}}async function Za(t,e,n){if(!Mo(e))throw e;t.N_.add(1),await dr(t),t.k_.set("Offline"),n||(n=()=>Dy(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{se("RemoteStore","Retrying IndexedDB access"),await n(),t.N_.delete(1),await $o(t)})}function Vy(t,e){return e().catch(n=>Za(t,n,e))}async function Ml(t){const e=ke(t),n=$s(e);let s=e.x_.length>0?e.x_[e.x_.length-1].batchId:-1;for(;NC(e);)try{const i=await gC(e.localStore,s);if(i===null){e.x_.length===0&&n.s_();break}s=i.batchId,MC(e,i)}catch(i){await Za(e,i)}Ly(e)&&$y(e)}function NC(t){return ki(t)&&t.x_.length<10}function MC(t,e){t.x_.push(e);const n=$s(t);n.n_()&&n.R_&&n.V_(e.mutations)}function Ly(t){return ki(t)&&!$s(t).t_()&&t.x_.length>0}function $y(t){$s(t).start()}async function xC(t){$s(t).g_()}async function VC(t){const e=$s(t);for(const n of t.x_)e.V_(n.mutations)}async function LC(t,e,n){const s=t.x_.shift(),i=od.from(s,e,n);await Vy(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ml(t)}async function $C(t,e){e&&$s(t).R_&&await async function(s,i){if(function(o){return yy(o)&&o!==J.ABORTED}(i.code)){const r=s.x_.shift();$s(s).i_(),await Vy(s,()=>s.remoteSyncer.rejectFailedWrite(r.batchId,i)),await Ml(s)}}(t,e),Ly(t)&&$y(t)}async function Fm(t,e){const n=ke(t);n.asyncQueue.verifyOperationInProgress(),se("RemoteStore","RemoteStore received new credentials");const s=ki(n);n.N_.add(3),await dr(n),s&&n.k_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.N_.delete(3),await $o(n)}async function FC(t,e){const n=ke(t);e?(n.N_.delete(2),await $o(n)):e||(n.N_.add(2),await dr(n),n.k_.set("Unknown"))}function hr(t){return t.Q_||(t.Q_=function(n,s,i){const r=ke(n);return r.y_(),new IC(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(t.datastore,t.asyncQueue,{To:CC.bind(null,t),Ao:PC.bind(null,t),Vo:DC.bind(null,t),E_:OC.bind(null,t)}),t.L_.push(async e=>{e?(t.Q_.i_(),gd(t)?pd(t):t.k_.set("Unknown")):(await t.Q_.stop(),xy(t))})),t.Q_}function $s(t){return t.K_||(t.K_=function(n,s,i){const r=ke(n);return r.y_(),new SC(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(t.datastore,t.asyncQueue,{To:()=>Promise.resolve(),Ao:xC.bind(null,t),Vo:$C.bind(null,t),m_:VC.bind(null,t),f_:LC.bind(null,t)}),t.L_.push(async e=>{e?(t.K_.i_(),await Ml(t)):(await t.K_.stop(),t.x_.length>0&&(se("RemoteStore",`Stopping write stream with ${t.x_.length} pending writes`),t.x_=[]))})),t.K_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,n,s,i,r){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=i,this.removalCallback=r,this.deferred=new pn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,i,r){const o=Date.now()+s,l=new _d(e,n,o,i,r);return l.start(s),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(J.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yd(t,e){if(Mn("AsyncQueue",`${e}: ${t}`),Mo(t))return new ue(J.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this.comparator=e?(n,s)=>e(n,s)||me.comparator(n.key,s.key):(n,s)=>me.comparator(n.key,s.key),this.keyedMap=$r(),this.sortedSet=new Ze(this.comparator)}static emptySet(e){return new qi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof qi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,r=s.getNext().key;if(!i.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new qi;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(){this.U_=new Ze(me.comparator)}track(e){const n=e.doc.key,s=this.U_.get(n);s?e.type!==0&&s.type===3?this.U_=this.U_.insert(n,e):e.type===3&&s.type!==1?this.U_=this.U_.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.U_=this.U_.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.U_=this.U_.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.U_=this.U_.remove(n):e.type===1&&s.type===2?this.U_=this.U_.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.U_=this.U_.insert(n,{type:2,doc:e.doc}):ye():this.U_=this.U_.insert(n,e)}W_(){const e=[];return this.U_.inorderTraversal((n,s)=>{e.push(s)}),e}}class sr{constructor(e,n,s,i,r,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,s,i,r){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new sr(e,n,qi.emptySet(n),o,s,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Al(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==s[i].type||!n[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(){this.G_=void 0,this.z_=[]}j_(){return this.z_.some(e=>e.H_())}}class BC{constructor(){this.queries=Bm(),this.onlineState="Unknown",this.J_=new Set}terminate(){(function(n,s){const i=ke(n),r=i.queries;i.queries=Bm(),r.forEach((o,l)=>{for(const c of l.z_)c.onError(s)})})(this,new ue(J.ABORTED,"Firestore shutting down"))}}function Bm(){return new ur(t=>iy(t),Al)}async function jC(t,e){const n=ke(t);let s=3;const i=e.query;let r=n.queries.get(i);r?!r.j_()&&e.H_()&&(s=2):(r=new UC,s=e.H_()?0:1);try{switch(s){case 0:r.G_=await n.onListen(i,!0);break;case 1:r.G_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const l=yd(o,`Initialization of query '${Ni(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,r),r.z_.push(e),e.Y_(n.onlineState),r.G_&&e.Z_(r.G_)&&vd(n)}async function HC(t,e){const n=ke(t),s=e.query;let i=3;const r=n.queries.get(s);if(r){const o=r.z_.indexOf(e);o>=0&&(r.z_.splice(o,1),r.z_.length===0?i=e.H_()?0:1:!r.j_()&&e.H_()&&(i=2))}switch(i){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function qC(t,e){const n=ke(t);let s=!1;for(const i of e){const r=i.query,o=n.queries.get(r);if(o){for(const l of o.z_)l.Z_(i)&&(s=!0);o.G_=i}}s&&vd(n)}function KC(t,e,n){const s=ke(t),i=s.queries.get(e);if(i)for(const r of i.z_)r.onError(n);s.queries.delete(e)}function vd(t){t.J_.forEach(e=>{e.next()})}var cu,jm;(jm=cu||(cu={})).X_="default",jm.Cache="cache";class GC{constructor(e,n,s){this.query=e,this.ea=n,this.ta=!1,this.na=null,this.onlineState="Unknown",this.options=s||{}}Z_(e){if(!this.options.includeMetadataChanges){const s=[];for(const i of e.docChanges)i.type!==3&&s.push(i);e=new sr(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.ta?this.ra(e)&&(this.ea.next(e),n=!0):this.ia(e,this.onlineState)&&(this.sa(e),n=!0),this.na=e,n}onError(e){this.ea.error(e)}Y_(e){this.onlineState=e;let n=!1;return this.na&&!this.ta&&this.ia(this.na,e)&&(this.sa(this.na),n=!0),n}ia(e,n){if(!e.fromCache||!this.H_())return!0;const s=n!=="Offline";return(!this.options.oa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ra(e){if(e.docChanges.length>0)return!0;const n=this.na&&this.na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}sa(e){e=sr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ta=!0,this.ea.next(e)}H_(){return this.options.source!==cu.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e){this.key=e}}class Uy{constructor(e){this.key=e}}class zC{constructor(e,n){this.query=e,this.Ia=n,this.Ta=null,this.hasCachedResults=!1,this.current=!1,this.Ea=Re(),this.mutatedKeys=Re(),this.da=ry(e),this.Aa=new qi(this.da)}get Ra(){return this.Ia}Va(e,n){const s=n?n.ma:new Um,i=n?n.Aa:this.Aa;let r=n?n.mutatedKeys:this.mutatedKeys,o=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,m)=>{const g=i.get(d),y=Rl(this.query,m)?m:null,A=!!g&&this.mutatedKeys.has(g.key),F=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let N=!1;g&&y?g.data.isEqual(y.data)?A!==F&&(s.track({type:3,doc:y}),N=!0):this.fa(g,y)||(s.track({type:2,doc:y}),N=!0,(c&&this.da(y,c)>0||u&&this.da(y,u)<0)&&(l=!0)):!g&&y?(s.track({type:0,doc:y}),N=!0):g&&!y&&(s.track({type:1,doc:g}),N=!0,(c||u)&&(l=!0)),N&&(y?(o=o.add(y),r=F?r.add(d):r.delete(d)):(o=o.delete(d),r=r.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),r=r.delete(d.key),s.track({type:1,doc:d})}return{Aa:o,ma:s,ts:l,mutatedKeys:r}}fa(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,i){const r=this.Aa;this.Aa=e.Aa,this.mutatedKeys=e.mutatedKeys;const o=e.ma.W_();o.sort((d,m)=>function(y,A){const F=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ye()}};return F(y)-F(A)}(d.type,m.type)||this.da(d.doc,m.doc)),this.ga(s),i=i!=null&&i;const l=n&&!i?this.pa():[],c=this.Ea.size===0&&this.current&&!i?1:0,u=c!==this.Ta;return this.Ta=c,o.length!==0||u?{snapshot:new sr(this.query,e.Aa,r,o,e.mutatedKeys,c===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),ya:l}:{ya:l}}Y_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Aa:this.Aa,ma:new Um,mutatedKeys:this.mutatedKeys,ts:!1},!1)):{ya:[]}}wa(e){return!this.Ia.has(e)&&!!this.Aa.has(e)&&!this.Aa.get(e).hasLocalMutations}ga(e){e&&(e.addedDocuments.forEach(n=>this.Ia=this.Ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ia=this.Ia.delete(n)),this.current=e.current)}pa(){if(!this.current)return[];const e=this.Ea;this.Ea=Re(),this.Aa.forEach(s=>{this.wa(s.key)&&(this.Ea=this.Ea.add(s.key))});const n=[];return e.forEach(s=>{this.Ea.has(s)||n.push(new Uy(s))}),this.Ea.forEach(s=>{e.has(s)||n.push(new Fy(s))}),n}Sa(e){this.Ia=e.Is,this.Ea=Re();const n=this.Va(e.documents);return this.applyChanges(n,!0)}ba(){return sr.fromInitialDocuments(this.query,this.Aa,this.mutatedKeys,this.Ta===0,this.hasCachedResults)}}class WC{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class QC{constructor(e){this.key=e,this.Da=!1}}class YC{constructor(e,n,s,i,r,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Ca={},this.va=new ur(l=>iy(l),Al),this.Fa=new Map,this.Ma=new Set,this.xa=new Ze(me.comparator),this.Oa=new Map,this.Na=new cd,this.La={},this.Ba=new Map,this.ka=nr.Bn(),this.onlineState="Unknown",this.qa=void 0}get isPrimaryClient(){return this.qa===!0}}async function JC(t,e,n=!0){const s=Gy(t);let i;const r=s.va.get(e);return r?(s.sharedClientState.addLocalQueryTarget(r.targetId),i=r.view.ba()):i=await By(s,e,n,!0),i}async function XC(t,e){const n=Gy(t);await By(n,e,!0,!1)}async function By(t,e,n,s){const i=await _C(t.localStore,Nn(e)),r=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(r):"not-current";let l;return s&&(l=await ZC(t,e,r,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Ny(t.remoteStore,i),l}async function ZC(t,e,n,s,i){t.Qa=(m,g,y)=>async function(F,N,x,V){let R=N.view.Va(x);R.ts&&(R=await Vm(F.localStore,N.query,!1).then(({documents:k})=>N.view.Va(k,R)));const D=V&&V.targetChanges.get(N.targetId),P=V&&V.targetMismatches.get(N.targetId)!=null,H=N.view.applyChanges(R,F.isPrimaryClient,D,P);return qm(F,N.targetId,H.ya),H.snapshot}(t,m,g,y);const r=await Vm(t.localStore,e,!0),o=new zC(e,r.Is),l=o.Va(r.documents),c=Lo.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",i),u=o.applyChanges(l,t.isPrimaryClient,c);qm(t,n,u.ya);const d=new WC(e,n,o);return t.va.set(e,d),t.Fa.has(n)?t.Fa.get(n).push(e):t.Fa.set(n,[e]),u.snapshot}async function e1(t,e,n){const s=ke(t),i=s.va.get(e),r=s.Fa.get(i.targetId);if(r.length>1)return s.Fa.set(i.targetId,r.filter(o=>!Al(o,e))),void s.va.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await lu(s.localStore,i.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(i.targetId),n&&fd(s.remoteStore,i.targetId),uu(s,i.targetId)}).catch(No)):(uu(s,i.targetId),await lu(s.localStore,i.targetId,!0))}async function t1(t,e){const n=ke(t),s=n.va.get(e),i=n.Fa.get(s.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),fd(n.remoteStore,s.targetId))}async function n1(t,e,n){const s=c1(t);try{const i=await function(o,l){const c=ke(o),u=rt.now(),d=l.reduce((y,A)=>y.add(A.key),Re());let m,g;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let A=ss(),F=Re();return c.us.getEntries(y,d).next(N=>{A=N,A.forEach((x,V)=>{V.isValidDocument()||(F=F.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,A)).next(N=>{m=N;const x=[];for(const V of l){const R=kR(V,m.get(V.key).overlayedDocument);R!=null&&x.push(new js(V.key,R,J_(R.value.mapValue),wt.exists(!0)))}return c.mutationQueue.addMutationBatch(y,u,x,l)}).next(N=>{g=N;const x=N.applyToLocalDocumentSet(m,F);return c.documentOverlayCache.saveOverlays(y,N.batchId,x)})}).then(()=>({batchId:g.batchId,changes:ay(m)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(i.batchId),function(o,l,c){let u=o.La[o.currentUser.toKey()];u||(u=new Ze(Le)),u=u.insert(l,c),o.La[o.currentUser.toKey()]=u}(s,i.batchId,n),await Fo(s,i.changes),await Ml(s.remoteStore)}catch(i){const r=yd(i,"Failed to persist write");n.reject(r)}}async function jy(t,e){const n=ke(t);try{const s=await mC(n.localStore,e);e.targetChanges.forEach((i,r)=>{const o=n.Oa.get(r);o&&($e(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Da=!0:i.modifiedDocuments.size>0?$e(o.Da):i.removedDocuments.size>0&&($e(o.Da),o.Da=!1))}),await Fo(n,s,e)}catch(s){await No(s)}}function Hm(t,e,n){const s=ke(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const i=[];s.va.forEach((r,o)=>{const l=o.view.Y_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const c=ke(o);c.onlineState=l;let u=!1;c.queries.forEach((d,m)=>{for(const g of m.z_)g.Y_(l)&&(u=!0)}),u&&vd(c)}(s.eventManager,e),i.length&&s.Ca.E_(i),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function s1(t,e,n){const s=ke(t);s.sharedClientState.updateQueryState(e,"rejected",n);const i=s.Oa.get(e),r=i&&i.key;if(r){let o=new Ze(me.comparator);o=o.insert(r,ht.newNoDocument(r,be.min()));const l=Re().add(r),c=new Ol(be.min(),new Map,new Ze(Le),o,l);await jy(s,c),s.xa=s.xa.remove(r),s.Oa.delete(e),bd(s)}else await lu(s.localStore,e,!1).then(()=>uu(s,e,n)).catch(No)}async function i1(t,e){const n=ke(t),s=e.batch.batchId;try{const i=await fC(n.localStore,e);qy(n,s,null),Hy(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Fo(n,i)}catch(i){await No(i)}}async function r1(t,e,n){const s=ke(t);try{const i=await function(o,l){const c=ke(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(m=>($e(m!==null),d=m.keys(),c.mutationQueue.removeMutationBatch(u,m))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(s.localStore,e);qy(s,e,n),Hy(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Fo(s,i)}catch(i){await No(i)}}function Hy(t,e){(t.Ba.get(e)||[]).forEach(n=>{n.resolve()}),t.Ba.delete(e)}function qy(t,e,n){const s=ke(t);let i=s.La[s.currentUser.toKey()];if(i){const r=i.get(e);r&&(n?r.reject(n):r.resolve(),i=i.remove(e)),s.La[s.currentUser.toKey()]=i}}function uu(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Fa.get(e))t.va.delete(s),n&&t.Ca.Ka(s,n);t.Fa.delete(e),t.isPrimaryClient&&t.Na.mr(e).forEach(s=>{t.Na.containsKey(s)||Ky(t,s)})}function Ky(t,e){t.Ma.delete(e.path.canonicalString());const n=t.xa.get(e);n!==null&&(fd(t.remoteStore,n),t.xa=t.xa.remove(e),t.Oa.delete(n),bd(t))}function qm(t,e,n){for(const s of n)s instanceof Fy?(t.Na.addReference(s.key,e),o1(t,s)):s instanceof Uy?(se("SyncEngine","Document no longer in limbo: "+s.key),t.Na.removeReference(s.key,e),t.Na.containsKey(s.key)||Ky(t,s.key)):ye()}function o1(t,e){const n=e.key,s=n.path.canonicalString();t.xa.get(n)||t.Ma.has(s)||(se("SyncEngine","New document in limbo: "+n),t.Ma.add(s),bd(t))}function bd(t){for(;t.Ma.size>0&&t.xa.size<t.maxConcurrentLimboResolutions;){const e=t.Ma.values().next().value;t.Ma.delete(e);const n=new me(Je.fromString(e)),s=t.ka.next();t.Oa.set(s,new QC(n)),t.xa=t.xa.insert(n,s),Ny(t.remoteStore,new Ts(Nn(rd(n.path)),s,"TargetPurposeLimboResolution",Zu.oe))}}async function Fo(t,e,n){const s=ke(t),i=[],r=[],o=[];s.va.isEmpty()||(s.va.forEach((l,c)=>{o.push(s.Qa(c,e,n).then(u=>{var d;if((u||n)&&s.isPrimaryClient){const m=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;s.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(u){i.push(u);const m=dd.Ui(c.targetId,u);r.push(m)}}))}),await Promise.all(o),s.Ca.E_(i),await async function(c,u){const d=ke(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Y.forEach(u,g=>Y.forEach(g.Ki,y=>d.persistence.referenceDelegate.addReference(m,g.targetId,y)).next(()=>Y.forEach(g.$i,y=>d.persistence.referenceDelegate.removeReference(m,g.targetId,y)))))}catch(m){if(!Mo(m))throw m;se("LocalStore","Failed to update sequence numbers: "+m)}for(const m of u){const g=m.targetId;if(!m.fromCache){const y=d.ss.get(g),A=y.snapshotVersion,F=y.withLastLimboFreeSnapshotVersion(A);d.ss=d.ss.insert(g,F)}}}(s.localStore,r))}async function a1(t,e){const n=ke(t);if(!n.currentUser.isEqual(e)){se("SyncEngine","User change. New user:",e.toKey());const s=await Py(n.localStore,e);n.currentUser=e,function(r,o){r.Ba.forEach(l=>{l.forEach(c=>{c.reject(new ue(J.CANCELLED,o))})}),r.Ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Fo(n,s.ls)}}function l1(t,e){const n=ke(t),s=n.Oa.get(e);if(s&&s.Da)return Re().add(s.key);{let i=Re();const r=n.Fa.get(e);if(!r)return i;for(const o of r){const l=n.va.get(o);i=i.unionWith(l.view.Ra)}return i}}function Gy(t){const e=ke(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=jy.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=l1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=s1.bind(null,e),e.Ca.E_=qC.bind(null,e.eventManager),e.Ca.Ka=KC.bind(null,e.eventManager),e}function c1(t){const e=ke(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=i1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=r1.bind(null,e),e}class Km{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Nl(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return hC(this.persistence,new uC,e.initialUser,this.serializer)}createPersistence(e){return new oC(ud.Yr,this.serializer)}createSharedClientState(e){return new vC}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class u1{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Hm(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=a1.bind(null,this.syncEngine),await FC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new BC}()}createDatastore(e){const n=Nl(e.databaseInfo.databaseId),s=function(r){return new wC(r)}(e.databaseInfo);return function(r,o,l,c){return new TC(r,o,l,c)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return function(s,i,r,o,l){return new RC(s,i,r,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Hm(this.syncEngine,n,0),function(){return $m.D()?new $m:new bC}())}createSyncEngine(e,n){return function(i,r,o,l,c,u,d){const m=new YC(i,r,o,l,c,u);return d&&(m.qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const r=ke(i);se("RemoteStore","RemoteStore shutting down."),r.N_.add(5),await dr(r),r.B_.shutdown(),r.k_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Wa(this.observer.next,e)}error(e){this.observer.error?this.Wa(this.observer.error,e):Mn("Uncaught Error in snapshot listener:",e.toString())}Ga(){this.muted=!0}Wa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ue(J.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(i,r){const o=ke(i),l={documents:r.map(m=>Xa(o.serializer,m))},c=await o.No("BatchGetDocuments",o.serializer.databaseId,Je.emptyPath(),l,r.length),u=new Map;c.forEach(m=>{const g=xR(o.serializer,m);u.set(g.key.toString(),g)});const d=[];return r.forEach(m=>{const g=u.get(m.toString());$e(!!g),d.push(g)}),d}(this.datastore,e);return n.forEach(s=>this.recordVersion(s)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastTransactionError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new Dl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,s)=>{const i=me.fromPath(s);this.mutations.push(new _y(i,this.precondition(i)))}),await async function(s,i){const r=ke(s),o={writes:i.map(l=>Ty(r.serializer,l))};await r.Fo("Commit",r.serializer.databaseId,Je.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw ye();n=be.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!n.isEqual(s))throw new ue(J.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(be.min())?wt.exists(!1):wt.updateTime(n):wt.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(be.min()))throw new ue(J.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return wt.updateTime(n)}return wt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1{constructor(e,n,s,i,r){this.asyncQueue=e,this.datastore=n,this.options=s,this.updateFunction=i,this.deferred=r,this.tu=s.maxAttempts,this.e_=new hd(this.asyncQueue,"transaction_retry")}nu(){this.tu-=1,this.ru()}ru(){this.e_.Wo(async()=>{const e=new h1(this.datastore),n=this.iu(e);n&&n.then(s=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(s)}).catch(i=>{this.su(i)}))}).catch(s=>{this.su(s)})})}iu(e){try{const n=this.updateFunction(e);return!xo(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}su(e){this.tu>0&&this.ou(e)?(this.tu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ru(),Promise.resolve()))):this.deferred.reject(e)}ou(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!yy(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e,n,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=i,this.user=Nt.UNAUTHENTICATED,this.clientId=Yu.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(s,async r=>{se("FirestoreClient","Received user=",r.uid),await this.authCredentialListener(r),this.user=r}),this.appCheckCredentials.start(s,r=>(se("FirestoreClient","Received new app check token=",r),this.appCheckCredentialListener(r,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new ue(J.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new pn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=yd(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function Cc(t,e){t.asyncQueue.verifyOperationInProgress(),se("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async i=>{s.isEqual(i)||(await Py(e.localStore,i),s=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Gm(t,e){t.asyncQueue.verifyOperationInProgress();const n=await zy(t);se("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(s=>Fm(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>Fm(e.remoteStore,i)),t._onlineComponents=e}function p1(t){return t.name==="FirebaseError"?t.code===J.FAILED_PRECONDITION||t.code===J.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function zy(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){se("FirestoreClient","Using user provided OfflineComponentProvider");try{await Cc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!p1(n))throw n;gi("Error using user provided cache. Falling back to memory cache: "+n),await Cc(t,new Km)}}else se("FirestoreClient","Using default OfflineComponentProvider"),await Cc(t,new Km);return t._offlineComponents}async function xl(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(se("FirestoreClient","Using user provided OnlineComponentProvider"),await Gm(t,t._uninitializedComponentsProvider._online)):(se("FirestoreClient","Using default OnlineComponentProvider"),await Gm(t,new u1))),t._onlineComponents}function Wy(t){return zy(t).then(e=>e.persistence)}function Qy(t){return xl(t).then(e=>e.remoteStore)}function g1(t){return xl(t).then(e=>e.syncEngine)}function _1(t){return xl(t).then(e=>e.datastore)}async function y1(t){const e=await xl(t),n=e.eventManager;return n.onListen=JC.bind(null,e.syncEngine),n.onUnlisten=e1.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=XC.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=t1.bind(null,e.syncEngine),n}function v1(t){return t.asyncQueue.enqueue(async()=>{const e=await Wy(t),n=await Qy(t);return e.setNetworkEnabled(!0),function(i){const r=ke(i);return r.N_.delete(0),$o(r)}(n)})}function b1(t){return t.asyncQueue.enqueue(async()=>{const e=await Wy(t),n=await Qy(t);return e.setNetworkEnabled(!1),async function(i){const r=ke(i);r.N_.add(0),await dr(r),r.k_.set("Offline")}(n)})}function E1(t,e,n={}){const s=new pn;return t.asyncQueue.enqueueAndForget(async()=>function(r,o,l,c,u){const d=new d1({next:g=>{o.enqueueAndForget(()=>HC(r,m));const y=g.docs.has(l);!y&&g.fromCache?u.reject(new ue(J.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&c&&c.source==="server"?u.reject(new ue(J.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new GC(rd(l.path),d,{includeMetadataChanges:!0,oa:!0});return jC(r,m)}(await y1(t),t.asyncQueue,e,n,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yy(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k1(t,e,n){if(!n)throw new ue(J.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Jy(t,e,n,s){if(e===!0&&s===!0)throw new ue(J.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Wm(t){if(!me.isDocumentKey(t))throw new ue(J.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ed(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ye()}function Ln(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ue(J.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ed(t);throw new ue(J.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e){var n,s;if(e.host===void 0){if(e.ssl!==void 0)throw new ue(J.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ue(J.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Jy("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Yy((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ue(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ue(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ue(J.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,i){return s.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kd{constructor(e,n,s,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qm({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new ue(J.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new ue(J.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qm(e),e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new z_;switch(s.type){case"firstParty":return new N0(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new ue(J.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const s=zm.get(n);s&&(se("ComponentProvider","Removing Datastore"),zm.delete(n),s.terminate())}(this),Promise.resolve()}}function Xy(t,e,n,s={}){var i;const r=(t=Ln(t,kd))._getSettings(),o=`${e}:${n}`;if(r.host!=="firestore.googleapis.com"&&r.host!==o&&gi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},r),{host:o,ssl:!1})),s.mockUserToken){let l,c;if(typeof s.mockUserToken=="string")l=s.mockUserToken,c=Nt.MOCK_USER;else{l=GI(s.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=s.mockUserToken.sub||s.mockUserToken.user_id;if(!u)throw new ue(J.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Nt(u)}t._authCredentials=new P0(new G_(l,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Vl(this.firestore,e,this._query)}}class Qt{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ir(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Qt(this.firestore,e,this._key)}}class ir extends Vl{constructor(e,n,s){super(e,n,rd(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Qt(this.firestore,null,new me(e))}withConverter(e){return new ir(this.firestore,e,this._path)}}function vi(t,e,...n){if(t=St(t),arguments.length===1&&(e=Yu.newId()),k1("doc","path",e),t instanceof kd){const s=Je.fromString(e,...n);return Wm(s),new Qt(t,null,new me(s))}{if(!(t instanceof Qt||t instanceof ir))throw new ue(J.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Je.fromString(e,...n));return Wm(s),new Qt(t.firestore,t instanceof ir?t.converter:null,new me(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(){this._u=Promise.resolve(),this.au=[],this.uu=!1,this.cu=[],this.lu=null,this.hu=!1,this.Pu=!1,this.Iu=[],this.e_=new hd(this,"async_queue_retry"),this.Tu=()=>{const n=Rc();n&&se("AsyncQueue","Visibility state changed to "+n.visibilityState),this.e_.zo()};const e=Rc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Tu)}get isShuttingDown(){return this.uu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Eu(),this.du(e)}enterRestrictedMode(e){if(!this.uu){this.uu=!0,this.Pu=e||!1;const n=Rc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Tu)}}enqueue(e){if(this.Eu(),this.uu)return new Promise(()=>{});const n=new pn;return this.du(()=>this.uu&&this.Pu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.au.push(e),this.Au()))}async Au(){if(this.au.length!==0){try{await this.au[0](),this.au.shift(),this.e_.reset()}catch(e){if(!Mo(e))throw e;se("AsyncQueue","Operation failed with retryable error: "+e)}this.au.length>0&&this.e_.Wo(()=>this.Au())}}du(e){const n=this._u.then(()=>(this.hu=!0,e().catch(s=>{this.lu=s,this.hu=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(s);throw Mn("INTERNAL UNHANDLED ERROR: ",i),s}).then(s=>(this.hu=!1,s))));return this._u=n,n}enqueueAfterDelay(e,n,s){this.Eu(),this.Iu.indexOf(e)>-1&&(n=0);const i=_d.createAndSchedule(this,e,n,s,r=>this.Ru(r));return this.cu.push(i),i}Eu(){this.lu&&ye()}verifyOperationInProgress(){}async Vu(){let e;do e=this._u,await e;while(e!==this._u)}mu(e){for(const n of this.cu)if(n.timerId===e)return!0;return!1}fu(e){return this.Vu().then(()=>{this.cu.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.cu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Vu()})}gu(e){this.Iu.push(e)}Ru(e){const n=this.cu.indexOf(e);this.cu.splice(n,1)}}class Hs extends kd{constructor(e,n,s,i){super(e,n,s,i),this.type="firestore",this._queue=function(){return new w1}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Zy(this),this._firestoreClient.terminate()}}function wd(t,e){const n=typeof t=="object"?t:n_(),s=typeof t=="string"?t:"(default)",i=El(n,"firestore").getImmediate({identifier:s});if(!i._initialized){const r=qI("firestore");r&&Xy(i,...r)}return i}function wi(t){return t._firestoreClient||Zy(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Zy(t){var e,n,s;const i=t._freezeSettings(),r=function(l,c,u,d){return new z0(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Yy(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new m1(t._authCredentials,t._appCheckCredentials,t._queue,r),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((s=i.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function ev(t){if(t._initialized&&!t._terminated)throw new ue(J.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new pn;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(s){if(!ai.D())return Promise.resolve();const i=s+"main";await ai.delete(i)}(lC(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function du(t){return v1(wi(t=Ln(t,Hs)))}function tv(t){return b1(wi(t=Ln(t,Hs)))}function nv(t){return nT(t.app,"firestore",t._databaseId.database),t._delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fs(pt.fromBase64String(e))}catch(n){throw new ue(J.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Fs(pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ue(J.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ue(J.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ue(J.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I1=/^__.*__$/;class S1{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new js(e,this.data,this.fieldMask,n,this.fieldTransforms):new Vo(e,this.data,n,this.fieldTransforms)}}class sv{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new js(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function iv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ye()}}class Id{constructor(e,n,s,i,r,o){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=i,r===void 0&&this.pu(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get yu(){return this.settings.yu}wu(e){return new Id(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Su(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.wu({path:s,bu:!1});return i.Du(e),i}Cu(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.wu({path:s,bu:!1});return i.pu(),i}vu(e){return this.wu({path:void 0,bu:!0})}Fu(e){return el(e,this.settings.methodName,this.settings.Mu||!1,this.path,this.settings.xu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Du(this.path.get(e))}Du(e){if(e.length===0)throw this.Fu("Document fields must not be empty");if(iv(this.yu)&&I1.test(e))throw this.Fu('Document fields cannot begin and end with "__"')}}class T1{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||Nl(e)}Ou(e,n,s,i=!1){return new Id({yu:e,methodName:n,xu:s,path:mt.emptyPath(),bu:!1,Mu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Sd(t){const e=t._freezeSettings(),n=Nl(t._databaseId);return new T1(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Td(t,e,n,s,i,r={}){const o=t.Ou(r.merge||r.mergeFields?2:0,e,n,i);Rd("Data must be an object, but it was:",o,s);const l=av(s,o);let c,u;if(r.merge)c=new en(o.fieldMask),u=o.fieldTransforms;else if(r.mergeFields){const d=[];for(const m of r.mergeFields){const g=hu(e,m,n);if(!o.contains(g))throw new ue(J.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);cv(d,g)||d.push(g)}c=new en(d),u=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,u=o.fieldTransforms;return new S1(new Bt(l),c,u)}class $l extends Uo{_toFieldTransform(e){if(e.yu!==2)throw e.yu===1?e.Fu(`${this._methodName}() can only appear at the top level of your update data`):e.Fu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof $l}}class Ad extends Uo{_toFieldTransform(e){return new yR(e.path,new bo)}isEqual(e){return e instanceof Ad}}function rv(t,e,n,s){const i=t.Ou(1,e,n);Rd("Data must be an object, but it was:",i,s);const r=[],o=Bt.empty();Ei(s,(c,u)=>{const d=Cd(e,c,n);u=St(u);const m=i.Cu(d);if(u instanceof $l)r.push(d);else{const g=Fl(u,m);g!=null&&(r.push(d),o.set(d,g))}});const l=new en(r);return new sv(o,l,i.fieldTransforms)}function ov(t,e,n,s,i,r){const o=t.Ou(1,e,n),l=[hu(e,s,n)],c=[i];if(r.length%2!=0)throw new ue(J.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<r.length;g+=2)l.push(hu(e,r[g])),c.push(r[g+1]);const u=[],d=Bt.empty();for(let g=l.length-1;g>=0;--g)if(!cv(u,l[g])){const y=l[g];let A=c[g];A=St(A);const F=o.Cu(y);if(A instanceof $l)u.push(y);else{const N=Fl(A,F);N!=null&&(u.push(y),d.set(y,N))}}const m=new en(u);return new sv(d,m,o.fieldTransforms)}function Fl(t,e){if(lv(t=St(t)))return Rd("Unsupported field value:",e,t),av(t,e);if(t instanceof Uo)return function(s,i){if(!iv(i.yu))throw i.Fu(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Fu(`${s._methodName}() is not currently supported inside arrays`);const r=s._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.bu&&e.yu!==4)throw e.Fu("Nested arrays are not supported");return function(s,i){const r=[];let o=0;for(const l of s){let c=Fl(l,i.vu(o));c==null&&(c={nullValue:"NULL_VALUE"}),r.push(c),o++}return{arrayValue:{values:r}}}(t,e)}return function(s,i){if((s=St(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return pR(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const r=rt.fromDate(s);return{timestampValue:Ja(i.serializer,r)}}if(s instanceof rt){const r=new rt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Ja(i.serializer,r)}}if(s instanceof Ll)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Fs)return{bytesValue:ky(i.serializer,s._byteString)};if(s instanceof Qt){const r=i.databaseId,o=s.firestore._databaseId;if(!o.isEqual(r))throw i.Fu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:ld(s.firestore._databaseId||i.databaseId,s._key.path)}}throw i.Fu(`Unsupported field value: ${Ed(s)}`)}(t,e)}function av(t,e){const n={};return Q_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ei(t,(s,i)=>{const r=Fl(i,e.Su(s));r!=null&&(n[s]=r)}),{mapValue:{fields:n}}}function lv(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof rt||t instanceof Ll||t instanceof Fs||t instanceof Qt||t instanceof Uo)}function Rd(t,e,n){if(!lv(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const s=Ed(n);throw s==="an object"?e.Fu(t+" a custom object"):e.Fu(t+" "+s)}}function hu(t,e,n){if((e=St(e))instanceof fr)return e._internalPath;if(typeof e=="string")return Cd(t,e);throw el("Field path arguments must be of type string or ",t,!1,void 0,n)}const A1=new RegExp("[~\\*/\\[\\]]");function Cd(t,e,n){if(e.search(A1)>=0)throw el(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fr(...e.split("."))._internalPath}catch{throw el(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function el(t,e,n,s,i){const r=s&&!s.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${s}`),o&&(c+=` in document ${i}`),c+=")"),new ue(J.INVALID_ARGUMENT,l+t+c)}function cv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,n,s,i,r){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Qt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new R1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(uv("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class R1 extends tl{data(){return super.data()}}function uv(t,e){return typeof e=="string"?Cd(t,e):e instanceof fr?e._internalPath:e._delegate._internalPath}class Pd{convertValue(e,n="none"){switch(yi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return it(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(_i(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw ye()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return Ei(e,(i,r)=>{s[i]=this.convertValue(r,n)}),s}convertGeoPoint(e){return new Ll(it(e.latitude),it(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=td(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(yo(e));default:return null}}convertTimestamp(e){const n=Ls(e);return new rt(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=Je.fromString(e);$e(Cy(s));const i=new Zi(s.get(1),s.get(3)),r=new me(s.popFirst(5));return i.isEqual(n)||Mn(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class C1 extends Pd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Qt(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ul extends tl{constructor(e,n,s,i,r,o){super(e,n,s,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new dv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(uv("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}}class dv extends Ul{data(e={}){return super.data(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(t){t=Ln(t,Qt);const e=Ln(t.firestore,Hs);return E1(wi(e),t._key).then(n=>P1(e,t,n))}class hv extends Pd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Qt(this.firestore,null,n)}}function fv(t,e,n){t=Ln(t,Qt);const s=Ln(t.firestore,Hs),i=Dd(t.converter,e,n);return Md(s,[Td(Sd(s),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,wt.none())])}function Md(t,e){return function(s,i){const r=new pn;return s.asyncQueue.enqueueAndForget(async()=>n1(await g1(s),i,r)),r.promise}(wi(t),e)}function P1(t,e,n){const s=n.docs.get(e._key),i=new hv(t);return new Ul(t,i,e._key,s,new Od(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Sd(e)}set(e,n,s){this._verifyNotCommitted();const i=Ss(e,this._firestore),r=Dd(i.converter,n,s),o=Td(this._dataReader,"WriteBatch.set",i._key,r,i.converter!==null,s);return this._mutations.push(o.toMutation(i._key,wt.none())),this}update(e,n,s,...i){this._verifyNotCommitted();const r=Ss(e,this._firestore);let o;return o=typeof(n=St(n))=="string"||n instanceof fr?ov(this._dataReader,"WriteBatch.update",r._key,n,s,i):rv(this._dataReader,"WriteBatch.update",r._key,n),this._mutations.push(o.toMutation(r._key,wt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Ss(e,this._firestore);return this._mutations=this._mutations.concat(new Dl(n._key,wt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ue(J.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ss(t,e){if((t=St(t)).firestore!==e)throw new ue(J.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv extends class{constructor(n,s){this._firestore=n,this._transaction=s,this._dataReader=Sd(n)}get(n){const s=Ss(n,this._firestore),i=new C1(this._firestore);return this._transaction.lookup([s._key]).then(r=>{if(!r||r.length!==1)return ye();const o=r[0];if(o.isFoundDocument())return new tl(this._firestore,i,o.key,o,s.converter);if(o.isNoDocument())return new tl(this._firestore,i,s._key,null,s.converter);throw ye()})}set(n,s,i){const r=Ss(n,this._firestore),o=Dd(r.converter,s,i),l=Td(this._dataReader,"Transaction.set",r._key,o,r.converter!==null,i);return this._transaction.set(r._key,l),this}update(n,s,i,...r){const o=Ss(n,this._firestore);let l;return l=typeof(s=St(s))=="string"||s instanceof fr?ov(this._dataReader,"Transaction.update",o._key,s,i,r):rv(this._dataReader,"Transaction.update",o._key,s),this._transaction.update(o._key,l),this}delete(n){const s=Ss(n,this._firestore);return this._transaction.delete(s._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Ss(e,this._firestore),s=new hv(this._firestore);return super.get(e).then(i=>new Ul(this._firestore,s,n._key,i._document,new Od(!1,!1),n.converter))}}function gv(t,e,n){t=Ln(t,Hs);const s=Object.assign(Object.assign({},D1),n);return function(r){if(r.maxAttempts<1)throw new ue(J.INVALID_ARGUMENT,"Max attempts must be at least 1")}(s),function(r,o,l){const c=new pn;return r.asyncQueue.enqueueAndForget(async()=>{const u=await _1(r);new f1(r.asyncQueue,u,l,o,c).nu()}),c.promise}(wi(t),i=>e(new pv(t,i)),s)}function As(){return new Ad("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(t){return wi(t=Ln(t,Hs)),new mv(t,e=>Md(t,e))}(function(e,n=!0){(function(i){cr=i})(ar),Ji(new di("firestore",(s,{instanceIdentifier:i,options:r})=>{const o=s.getProvider("app").getImmediate(),l=new Hs(new D0(s.getProvider("auth-internal")),new x0(s.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ue(J.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zi(u.options.projectId,d)}(o,i),o);return r=Object.assign({useFetchStreams:n},r),l._setSettings(r),l},"PUBLIC").setMultipleInstances(!0)),Os(pm,"4.6.5",e),Os(pm,"4.6.5","esm2017")})();const yv=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Pd,Bytes:Fs,CollectionReference:ir,DocumentReference:Qt,DocumentSnapshot:Ul,FieldPath:fr,FieldValue:Uo,Firestore:Hs,FirestoreError:ue,GeoPoint:Ll,Query:Vl,QueryDocumentSnapshot:dv,SnapshotMetadata:Od,Timestamp:rt,Transaction:pv,WriteBatch:mv,_AutoId:Yu,_ByteString:pt,_DatabaseId:Zi,_DocumentKey:me,_EmptyAuthCredentialsProvider:z_,_FieldPath:mt,_cast:Ln,_logWarn:gi,_validateIsNotUsedTogether:Jy,clearIndexedDbPersistence:ev,connectFirestoreEmulator:Xy,disableNetwork:tv,doc:vi,enableNetwork:du,ensureFirestoreConfigured:wi,executeWrite:Md,getDoc:Nd,getFirestore:wd,runTransaction:gv,serverTimestamp:As,setDoc:fv,terminate:nv,writeBatch:_v},Symbol.toStringTag,{value:"Module"}));var O1="firebase",N1="10.12.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Os(O1,N1,"app");const fu={apiKey:"AIzaSyBhZvHQT5Omr8L_O9sn-BFrni6GzPu4pqU",authDomain:"sinaik-pwa.firebaseapp.com",projectId:"sinaik-pwa",storageBucket:"sinaik-pwa.firebasestorage.app",messagingSenderId:"801751969697",appId:"1:801751969697:web:1461a75e437828126265e0",measurementId:"G-JHY41YCETE"},M1=()=>{const e=["apiKey","authDomain","projectId"].filter(n=>!fu[n]);if(e.length>0)throw console.error("❌ Missing Firebase configuration:",e),new Error(`Missing Firebase configuration: ${e.join(", ")}`);console.log("✅ Firebase configuration validated"),console.log("🔧 Project ID:",fu.projectId)};M1();const Bo=t_(fu);$_(Bo);const zt=wd(Bo);let li=!1,si=0;const nl=3,xd=async()=>{try{await du(zt),console.log("✅ Firestore network enabled successfully"),li=!0,si=0}catch(t){if(console.error("❌ Firestore initialization failed:",t),t.code==="failed-precondition"&&si<nl){console.log(`🔄 Retrying Firestore initialization (${si+1}/${nl})`),si++;try{await tv(zt),await new Promise(e=>setTimeout(e,1e3)),await xd()}catch(e){console.error("❌ Firestore retry failed:",e)}}else if(t.message.includes("INTERNAL ASSERTION FAILED")){console.log("🔧 Handling Firestore internal assertion error...");try{await nv(zt),await new Promise(e=>setTimeout(e,2e3));try{await ev(zt),console.log("✅ Cleared Firestore persistence cache")}catch{console.log("ℹ️ Could not clear persistence cache (may not be enabled)")}await du(zt),console.log("✅ Firestore recovered from internal assertion error"),li=!0}catch(e){console.error("❌ Firestore recovery failed:",e),li=!1}}}},x1=()=>{setTimeout(async()=>{var e;try{await xd();const{doc:n,getDoc:s}=await Gi(async()=>{const{doc:l,getDoc:c}=await Promise.resolve().then(()=>yv);return{doc:l,getDoc:c}},void 0),i=n(zt,"test","connection"),r=s(i),o=new Promise((l,c)=>setTimeout(()=>c(new Error("Connection test timeout")),1e4));await Promise.race([r,o]),console.log("✅ Firestore connection test successful")}catch(n){console.error("❌ Firestore connection test failed:",n),console.log("🔍 Error details:",{code:n.code,message:n.message,name:n.name,stack:(e=n.stack)==null?void 0:e.substring(0,200)}),n.code==="unavailable"?(console.log("💡 Troubleshooting: Firestore service unavailable"),console.log("   - Check internet connection"),console.log("   - Verify Firebase project is active"),console.log("   - Check if Firestore is enabled in Firebase Console")):n.code==="permission-denied"?(console.log("💡 Troubleshooting: Permission denied"),console.log("   - Check Firestore security rules"),console.log("   - Verify user authentication")):n.message.includes("offline")?(console.log("💡 Troubleshooting: Client detected as offline"),console.log("   - This may be a CORS or network configuration issue"),console.log("   - Check browser network tab for failed requests"),console.log("   - Verify API key permissions in Firebase Console")):n.message.includes("INTERNAL ASSERTION FAILED")?(console.log("💡 Troubleshooting: Firestore internal assertion error"),console.log("   - This is a known issue with Firestore v10.12.5"),console.log("   - The app will continue to function with fallback mechanisms"),console.log("   - Consider upgrading Firebase SDK when available")):n.message.includes("timeout")&&(console.log("💡 Troubleshooting: Connection timeout"),console.log("   - Network may be slow or unstable"),console.log("   - Firestore will retry automatically")),li=!1}},1e3)};x1();const jo=()=>li,bi=async()=>(console.log("🔄 Manually retrying Firestore connection..."),si=0,await xd(),li),vv=()=>({initialized:li,retryCount:si,maxRetries:nl,canRetry:si<nl});console.log("ℹ️ Firebase AI not available in v10.12.5, using direct Gemini API");console.log("🚀 Firebase initialized successfully");const V1=Object.freeze(Object.defineProperty({__proto__:null,db:zt,default:Bo,getFirestoreStatus:vv,isFirestoreHealthy:jo,retryFirestoreConnection:bi},Symbol.toStringTag,{value:"Module"})),Bl=$_(Bo),L1=wd(Bo),$1=async(t,e,n)=>{const i=(await fA(Bl,t,e)).user;return await fv(vi(L1,"users",i.uid),{namaUsaha:n}),i},F1=async(t,e)=>(await mA(Bl,t,e)).user,U1=async()=>{await _A(Bl)},B1=async t=>{try{return await hA(Bl,t),console.log("✅ Password reset email sent successfully"),!0}catch(e){throw console.error("❌ Error sending password reset email:",e),e}};let Ki=0,sl=null;const mu=3,bv=t=>(Ki++,sl={message:t.message,code:t.code,timestamp:new Date().toISOString()},console.log(`🚨 Firebase error #${Ki}:`,t.message),Ki>=mu&&(console.error("🚨 Too many Firebase errors, consider switching to fallback mode"),console.error("🚨 Last error:",sl)),t.message.includes("INTERNAL ASSERTION FAILED")?(console.error("🚨 CRITICAL: Firebase internal assertion error detected"),!0):!1),Ev=async t=>{if(!jo()&&(console.log("⚠️ Firestore not healthy, attempting to reconnect..."),!await bi()))return console.log("🔧 Firestore reconnection failed, using fallback mode"),null;try{console.log("🔍 DEBUG: Attempting to get user document for:",t);const e=vi(zt,"users",t),n=Nd(e),s=new Promise((r,o)=>setTimeout(()=>o(new Error("Firestore operation timeout")),15e3)),i=await Promise.race([n,s]);return i.exists()?(console.log("✅ User document retrieved successfully from Firestore"),i.data()):(console.log("ℹ️ User document does not exist in Firestore"),null)}catch(e){if(console.error("❌ Firestore getUserDocument error:",e),e.message.includes("INTERNAL ASSERTION FAILED")){console.log("🔧 Handling Firestore internal assertion error in getUserDocument");try{await bi(),console.log("✅ Firestore connection recovered, operation will continue with fallback")}catch(n){console.error("❌ Firestore recovery failed:",n)}}return bv(e),console.log("🔧 Critical error or fallback mode - continuing without Firestore"),null}},no=async(t,e)=>{if(!jo()&&(console.log("⚠️ Firestore not healthy, attempting to reconnect..."),!await bi()))return console.log("🔧 Firestore reconnection failed, skipping update"),!1;const n=3;let s=null;for(let i=1;i<=n;i++)try{console.log(`🔍 DEBUG: Attempting to update user document for ${t} (attempt ${i}/${n})`);const r=vi(zt,"users",t);if(await gv(zt,async l=>((await l.get(r)).exists()?(console.log("📝 User document exists, updating with transaction"),l.update(r,{...e,updatedAt:As()})):(console.log("📄 User document does not exist, creating new document"),l.set(r,{...e,createdAt:As(),updatedAt:As(),uid:t})),!0)))return console.log("✅ User document updated successfully in Firestore with transaction"),!0}catch(r){if(s=r,console.error(`❌ Firestore updateUserDocument error (attempt ${i}):`,r),r.message.includes("INTERNAL ASSERTION FAILED")){if(console.error("🚨 Firebase internal assertion error during update"),i<n){console.log("🔄 Attempting recovery from internal assertion error...");try{await bi();const o=Math.min(1e3*Math.pow(2,i-1),5e3);console.log(`⏳ Waiting ${o}ms before retry...`),await new Promise(l=>setTimeout(l,o));continue}catch(o){console.error("❌ Recovery attempt failed:",o)}}}else if(r.code==="aborted"){if(console.log("🔄 Transaction aborted, retrying..."),i<n){const o=Math.min(500*i,2e3);await new Promise(l=>setTimeout(l,o));continue}}else if(r.code==="unavailable"&&(console.log("🔄 Firestore unavailable, retrying..."),i<n)){const o=Math.min(1e3*i,3e3);await new Promise(l=>setTimeout(l,o));continue}if(i===n)break}return console.error(`❌ All ${n} update attempts failed. Last error:`,s==null?void 0:s.message),bv(s),console.log("🔧 Fallback mode - update failed but continuing"),!1},j1=async(t,e)=>{var n;if(!jo()&&(console.log("⚠️ Firestore not healthy for recommendation update"),!await bi()))return!1;try{console.log("📊 Updating recommendation data with optimized approach...");const{recommendations:s,businessProfile:i,analytics:r}=e;let o={businessProfile:i||{},analytics:r||{},recommendationCount:(s==null?void 0:s.length)||0,lastRecommendationUpdate:As(),updatedAt:As()};if(s&&s.length>0){const l=JSON.stringify(s).length;if(console.log(`📏 Recommendation data size: ${Math.round(l/1024)}KB`),l>5e5){console.log("📦 Large dataset detected, using batch approach...");const c=_v(zt),u=vi(zt,"users",t);c.update(u,o);const d=vi(zt,"users",t,"data","recommendations");c.set(d,{recommendations:s,updatedAt:As()}),await c.commit(),console.log("✅ Large recommendation data saved using batch approach")}else return o.recommendations=s,await no(t,o)}else return await no(t,o);return!0}catch(s){if(console.error("❌ Error updating recommendation data:",s),s.message.includes("INTERNAL ASSERTION FAILED")){console.log("🔧 Internal assertion error in recommendation update, falling back to simple update");try{const i={businessProfile:e.businessProfile||{},analytics:e.analytics||{},recommendationCount:((n=e.recommendations)==null?void 0:n.length)||0,lastUpdateAttempt:new Date().toISOString(),updatedAt:As()};return await no(t,i)}catch(i){return console.error("❌ Fallback update also failed:",i),!1}}return!1}},kv=()=>{const t=vv();return{errorCount:Ki,lastError:sl,maxErrors:mu,isInFallbackMode:Ki>=mu,firestoreHealth:{initialized:t.initialized,retryCount:t.retryCount,maxRetries:t.maxRetries,canRetry:t.canRetry}}},H1=()=>{Ki=0,sl=null,console.log("🔄 Firebase error count reset")},q1=async()=>{try{console.log("🧪 Testing Firestore connectivity..."),jo()||(console.log("⚠️ Firestore not healthy, attempting reconnection..."),await bi());const t=vi(zt,"test","connectivity");return await Nd(t),console.log("✅ Firestore connectivity test passed"),!0}catch(t){return console.error("❌ Firestore connectivity test failed:",t),!1}};typeof window<"u"&&(window.getFirebaseErrorStats=kv,window.testFirestoreConnectivity=q1,window.resetFirebaseErrorCount=H1,console.log("🔧 Firestore debugging functions available:"),console.log("- getFirebaseErrorStats()"),console.log("- testFirestoreConnectivity()"),console.log("- resetFirebaseErrorCount()"));const Ii=xu("auth",{state:()=>({user:null,isLoggedIn:!1,loading:!1}),getters:{businessName:t=>{var e;return((e=t.user)==null?void 0:e.namaUsaha)||"Pengguna"},userEmail:t=>{var e;return((e=t.user)==null?void 0:e.email)||""},userId:t=>{var e;return((e=t.user)==null?void 0:e.uid)||null}},actions:{setUser(t){this.user=t,this.isLoggedIn=!!t,t?localStorage.setItem("sinak_user",JSON.stringify(t)):localStorage.removeItem("sinak_user")},setLoading(t){this.loading=t},clearUser(){this.user=null,this.isLoggedIn=!1,localStorage.removeItem("sinak_user")},initializeAuth(){const t=localStorage.getItem("sinak_user");if(t)try{const e=JSON.parse(t);this.user=e,this.isLoggedIn=!0,console.log("✅ User restored from localStorage:",e.email)}catch(e){console.error("❌ Error parsing saved user data:",e),localStorage.removeItem("sinak_user")}else console.log("ℹ️ No saved user found in localStorage")},updateUserProfile(t){this.user&&(this.user={...this.user,...t},localStorage.setItem("sinak_user",JSON.stringify(this.user)),console.log("✅ User profile updated:",t))}}}),dn=[{id:"business_age",category:"basic_info",type:"number",question:"Berapa lama bisnis Anda sudah berjalan?",subtitle:"Dalam bulan (contoh: 6 bulan = 6, 2 tahun = 24)",placeholder:"Masukkan jumlah bulan",required:!0,validation:{min:0,max:600}},{id:"annual_revenue",category:"financial",type:"select",question:"Berapa perkiraan pendapatan tahunan bisnis Anda?",subtitle:"Pilih rentang yang paling mendekati",required:!0,options:[{value:25e6,label:"Di bawah Rp 50 juta"},{value:175e6,label:"Rp 50 juta - Rp 300 juta"},{value:14e8,label:"Rp 300 juta - Rp 2,5 miliar"},{value:2625e7,label:"Rp 2,5 miliar - Rp 50 miliar"},{value:75e9,label:"Di atas Rp 50 miliar"}]},{id:"employee_count",category:"organizational",type:"select",question:"Berapa jumlah karyawan (termasuk Anda) di bisnis ini?",subtitle:"Hitung semua orang yang terlibat secara aktif",required:!0,options:[{value:1,label:"Hanya saya sendiri"},{value:2,label:"2-3 orang"},{value:7,label:"4-10 orang"},{value:30,label:"11-50 orang"},{value:175,label:"51-300 orang"},{value:500,label:"Lebih dari 300 orang"}]},{id:"business_focus",category:"strategy",type:"radio",question:"Apa fokus utama bisnis Anda saat ini?",required:!0,options:[{value:"survival",label:"Bertahan hidup dan mencari pelanggan pertama",weight:{existence:3,survival:1}},{value:"break_even",label:"Mencapai titik impas (break-even)",weight:{survival:3,existence:1}},{value:"stable_profit",label:"Mempertahankan keuntungan yang stabil",weight:{success_disengagement:3,survival:1}},{value:"growth",label:"Ekspansi dan pertumbuhan bisnis",weight:{success_growth:3,success_disengagement:1}},{value:"optimization",label:"Optimalisasi dan efisiensi operasional",weight:{resource_maturity:3,success_growth:1}}]},{id:"management_style",category:"management",type:"radio",question:"Bagaimana gaya manajemen Anda saat ini?",required:!0,options:[{value:"hands_on",label:"Saya menangani hampir semua aspek bisnis sendiri",weight:{existence:3,survival:2}},{value:"some_delegation",label:"Saya mulai mendelegasikan beberapa tugas",weight:{survival:3,success_disengagement:2}},{value:"team_management",label:"Saya memiliki tim yang mengelola operasional harian",weight:{success_disengagement:3,success_growth:2}},{value:"strategic_only",label:"Saya fokus pada strategi, tim mengelola operasional",weight:{success_growth:3,resource_maturity:2}},{value:"board_governance",label:"Bisnis dikelola oleh dewan direksi/manajemen profesional",weight:{resource_maturity:3}}]},{id:"cash_flow_status",category:"financial",type:"radio",question:"Bagaimana kondisi arus kas (cash flow) bisnis Anda?",required:!0,options:[{value:"negative",label:"Sering negatif, sulit menutupi biaya operasional",weight:{existence:3,survival:1}},{value:"break_even",label:"Impas, kadang surplus kadang defisit",weight:{survival:3,existence:1}},{value:"positive_small",label:"Positif tapi masih kecil",weight:{survival:2,success_disengagement:3}},{value:"positive_stable",label:"Positif dan stabil",weight:{success_disengagement:3,success_growth:2}},{value:"strong_positive",label:"Sangat positif dengan cadangan yang kuat",weight:{success_growth:2,resource_maturity:3}}]},{id:"market_position",category:"market",type:"radio",question:"Bagaimana posisi bisnis Anda di pasar?",required:!0,options:[{value:"new_entrant",label:"Pemain baru, masih membangun reputasi",weight:{existence:3,survival:1}},{value:"established_local",label:"Sudah dikenal di area lokal/niche tertentu",weight:{survival:3,success_disengagement:2}},{value:"regional_player",label:"Pemain regional dengan pangsa pasar yang solid",weight:{success_disengagement:2,success_growth:3}},{value:"market_leader",label:"Pemimpin pasar di kategori/wilayah tertentu",weight:{success_growth:2,resource_maturity:3}},{value:"dominant_player",label:"Pemain dominan dengan pengaruh industri yang besar",weight:{resource_maturity:3}}]},{id:"systems_processes",category:"operational",type:"radio",question:"Seberapa formal sistem dan proses bisnis Anda?",required:!0,options:[{value:"informal",label:"Sebagian besar informal, bergantung pada ingatan",weight:{existence:3,survival:1}},{value:"basic_documentation",label:"Mulai ada dokumentasi dasar untuk proses penting",weight:{survival:3,success_disengagement:1}},{value:"standardized",label:"Proses sudah terstandarisasi dan terdokumentasi",weight:{success_disengagement:3,success_growth:2}},{value:"optimized",label:"Sistem terintegrasi dengan optimalisasi berkelanjutan",weight:{success_growth:3,resource_maturity:2}},{value:"enterprise_level",label:"Sistem enterprise dengan automasi tinggi",weight:{resource_maturity:3}}]}],K1=t=>{const e={existence:0,survival:0,success_disengagement:0,success_growth:0,resource_maturity:0};dn.forEach(l=>{const c=t[l.id];if(c&&l.type==="radio"){const u=l.options.find(d=>d.value===c);u&&u.weight&&Object.entries(u.weight).forEach(([d,m])=>{e[d]+=m})}});const n=t.annual_revenue||0,s=t.employee_count||1,i=t.business_age||0;n<5e7?e.existence+=2:n<3e8?e.survival+=2:n<25e8?e.success_disengagement+=2:n<5e10?e.success_growth+=2:e.resource_maturity+=2,s<=3?e.existence+=1:s<=10?e.survival+=1:s<=50?e.success_disengagement+=1:s<=300?e.success_growth+=1:e.resource_maturity+=1,i<=12?e.existence+=1:i<=36?e.survival+=1:i<=84?e.success_disengagement+=1:i<=120?e.success_growth+=1:e.resource_maturity+=1;const r=Math.max(...Object.values(e));return{stage:Object.entries(e).find(([l,c])=>c===r)[0],scores:e,confidence:r/Object.values(e).reduce((l,c)=>l+c,0)*100}},wv={EXISTENCE:{id:"existence",name:"Tahap Keberadaan (Existence)",description:"Bisnis baru yang berfokus pada mendapatkan pelanggan dan menghasilkan produk/layanan",characteristics:["Bisnis masih sangat kecil dan sederhana","Pemilik melakukan sebagian besar pekerjaan","Fokus utama adalah bertahan hidup","Sistem manajemen masih minimal"],challenges:["Mendapatkan pelanggan pertama","Menghasilkan cukup uang untuk menutupi biaya","Membangun produk/layanan yang diinginkan pasar"],keyMetrics:{revenue:{min:0,max:5e7},employees:{min:1,max:3},businessAge:{min:0,max:12}}},SURVIVAL:{id:"survival",name:"Tahap Bertahan (Survival)",description:"Bisnis telah membuktikan viabilitas dan fokus pada profitabilitas",characteristics:["Memiliki pelanggan yang cukup","Produk/layanan sudah diterima pasar","Fokus pada cash flow dan break-even","Mulai membangun sistem operasional"],challenges:["Mencapai titik impas (break-even)","Mengelola cash flow","Mempertahankan pelanggan","Meningkatkan efisiensi operasional"],keyMetrics:{revenue:{min:5e7,max:3e8},employees:{min:3,max:10},businessAge:{min:12,max:36}}},SUCCESS_DISENGAGEMENT:{id:"success_disengagement",name:"Tahap Sukses - Pelepasan (Success-Disengagement)",description:"Bisnis stabil dan menguntungkan, pemilik dapat melepas kontrol operasional",characteristics:["Bisnis menguntungkan dan stabil","Sistem manajemen yang baik","Pemilik dapat mendelegasikan tugas","Cash flow positif dan konsisten"],challenges:["Membangun tim manajemen yang kompeten","Mengembangkan sistem dan prosedur","Mempertahankan pertumbuhan yang stabil","Mengelola ekspektasi stakeholder"],keyMetrics:{revenue:{min:3e8,max:25e8},employees:{min:10,max:50},businessAge:{min:36,max:84}}},SUCCESS_GROWTH:{id:"success_growth",name:"Tahap Sukses - Pertumbuhan (Success-Growth)",description:"Bisnis berkembang pesat dengan investasi untuk ekspansi",characteristics:["Pertumbuhan yang signifikan","Investasi dalam SDM dan infrastruktur","Ekspansi pasar atau produk","Sistem manajemen yang matang"],challenges:["Mengelola pertumbuhan yang cepat","Mempertahankan kualitas saat scaling","Mengamankan pendanaan untuk ekspansi","Mengembangkan kepemimpinan"],keyMetrics:{revenue:{min:25e8,max:5e10},employees:{min:50,max:300},businessAge:{min:60,max:120}}},RESOURCE_MATURITY:{id:"resource_maturity",name:"Tahap Kedewasaan Sumber Daya (Resource Maturity)",description:"Bisnis besar dengan sumber daya yang melimpah dan sistem yang matang",characteristics:["Organisasi yang besar dan kompleks","Sumber daya finansial yang kuat","Sistem manajemen yang canggih","Posisi pasar yang dominan"],challenges:["Mempertahankan inovasi dan fleksibilitas","Menghindari birokrasi berlebihan","Menghadapi kompetisi dari startup","Mengelola kompleksitas organisasi"],keyMetrics:{revenue:{min:5e10,max:1/0},employees:{min:300,max:1/0},businessAge:{min:120,max:1/0}}}},Iv=t=>Object.values(wv).find(e=>e.id===t),jl=xu("diagnosis",{state:()=>({currentAnswers:{},currentStep:0,isCompleted:!1,currentStage:null,stageScores:{},confidence:0,diagnosisHistory:[],loading:!1,error:null}),getters:{currentQuestion:t=>dn[t.currentStep]||null,totalQuestions:()=>dn.length,progress:t=>Math.round(t.currentStep/dn.length*100),hasCurrentAnswer:t=>{const e=dn[t.currentStep];return e?!!t.currentAnswers[e.id]:!1},canProceed:t=>{const e=dn[t.currentStep];return e?!!t.currentAnswers[e.id]:!1},currentStageDetails:t=>t.currentStage?Iv(t.currentStage):null,allStages:()=>Object.values(wv),isInProgress:t=>t.currentStep>0&&!t.isCompleted,completionStatus:t=>t.isCompleted?"completed":t.currentStep>0?"in_progress":"not_started"},actions:{startDiagnosis(){this.currentAnswers={},this.currentStep=0,this.isCompleted=!1,this.currentStage=null,this.stageScores={},this.confidence=0,this.error=null,console.log("🎯 Starting new business diagnosis")},setAnswer(t,e){this.currentAnswers[t]=e,console.log(`📝 Answer set for ${t}:`,e)},nextQuestion(){this.currentStep<dn.length-1?(this.currentStep++,console.log(`➡️ Moving to question ${this.currentStep+1}/${dn.length}`)):this.completeDiagnosis()},previousQuestion(){this.currentStep>0&&(this.currentStep--,console.log(`⬅️ Moving back to question ${this.currentStep+1}/${dn.length}`))},goToQuestion(t){t>=0&&t<dn.length&&(this.currentStep=t,console.log(`🎯 Jumping to question ${t+1}/${dn.length}`))},completeDiagnosis(){this.loading=!0;try{console.log("🔄 Calculating diagnosis results...");const t=K1(this.currentAnswers);this.currentStage=t.stage,this.stageScores=t.scores,this.confidence=Math.round(t.confidence),this.isCompleted=!0;const e={id:Date.now().toString(),date:new Date().toISOString(),answers:{...this.currentAnswers},result:{stage:this.currentStage,scores:{...this.stageScores},confidence:this.confidence}};this.diagnosisHistory.unshift(e),this.diagnosisHistory.length>10&&(this.diagnosisHistory=this.diagnosisHistory.slice(0,10)),console.log("✅ Diagnosis completed:",{stage:this.currentStage,confidence:this.confidence}),this.saveDiagnosisData()}catch(t){console.error("❌ Error completing diagnosis:",t),this.error="Terjadi kesalahan saat memproses hasil diagnosis"}finally{this.loading=!1}},resetDiagnosis(){this.currentAnswers={},this.currentStep=0,this.isCompleted=!1,this.currentStage=null,this.stageScores={},this.confidence=0,this.error=null,console.log("🔄 Diagnosis reset")},loadDiagnosisData(){try{const t=localStorage.getItem("sinak_diagnosis");if(t){const e=JSON.parse(t);this.diagnosisHistory=e.history||[],e.lastDiagnosis&&e.lastDiagnosis.isCompleted&&(this.currentStage=e.lastDiagnosis.stage,this.stageScores=e.lastDiagnosis.scores,this.confidence=e.lastDiagnosis.confidence,this.isCompleted=!0),console.log("📂 Diagnosis data loaded from localStorage")}}catch(t){console.error("❌ Error loading diagnosis data:",t)}},saveDiagnosisData(){try{const t={history:this.diagnosisHistory,lastDiagnosis:this.isCompleted?{stage:this.currentStage,scores:this.stageScores,confidence:this.confidence,isCompleted:this.isCompleted,date:new Date().toISOString()}:null};localStorage.setItem("sinak_diagnosis",JSON.stringify(t)),console.log("💾 Diagnosis data saved to localStorage")}catch(t){console.error("❌ Error saving diagnosis data:",t)}},clearDiagnosisData(){this.diagnosisHistory=[],this.resetDiagnosis(),localStorage.removeItem("sinak_diagnosis"),console.log("🗑️ All diagnosis data cleared")},getDiagnosisById(t){return this.diagnosisHistory.find(e=>e.id===t)},setError(t){this.error=t},clearError(){this.error=null}}}),G1={class:"dashboard"},z1={class:"dashboard-header"},W1={class:"header-content"},Q1={class:"user-section"},Y1={class:"user-info"},J1={class:"business-name"},X1=["disabled"],Z1={class:"dashboard-main"},eP={class:"dashboard-content"},tP={class:"welcome-card"},nP={class:"quick-stats"},sP={class:"stat-item"},iP={class:"stat-number"},rP={class:"stat-description"},oP={class:"stat-item"},aP={class:"stat-number"},lP={key:0,class:"current-stage-card"},cP={class:"stage-header"},uP={class:"stage-badge"},dP={class:"stage-content"},hP={class:"stage-description"},fP={class:"stage-actions"},mP={key:1,class:"primary-action-section"},pP={class:"primary-action-card"},gP={class:"action-cards"},_P={class:"card-header"},yP={key:0,class:"card-status"},vP={class:"card-actions"},bP={class:"card-header"},EP={key:0,class:"card-status"},kP={class:"card-actions"},wP={key:1,class:"btn btn-disabled",disabled:""},IP={class:"card-header"},SP={key:0,class:"card-status"},TP={class:"card-actions"},AP=["disabled"],RP={__name:"DashboardView",setup(t){const e=Ii(),n=jl(),s=or(),i=ge(!1),r=Ie(()=>e.user),o=Ie(()=>{var m;return((m=e.user)==null?void 0:m.namaUsaha)||"Pengguna"}),l=Ie(()=>{var m;return((m=e.user)==null?void 0:m.businessStage)||n.currentStage}),c=Ie(()=>l.value?Iv(l.value):null),u=Ie(()=>{var m;return((m=e.user)==null?void 0:m.points)||0});En(async()=>{if(n.loadDiagnosisData(),r.value&&r.value.uid)try{console.log("🔄 Loading user data from Firestore...");const m=await Ev(r.value.uid);m?(e.setUser({...r.value,...m}),console.log("✅ User data loaded successfully")):console.log("ℹ️ No additional user data found in Firestore")}catch(m){console.warn("⚠️ Could not load user data from Firestore:",m)}});const d=async()=>{if(!i.value){i.value=!0;try{await U1(),e.setUser(null),s.push("/login")}catch(m){console.error("Logout error:",m)}finally{i.value=!1}}};return(m,g)=>{var A,F;const y=fl("router-link");return O(),M("div",G1,[f("header",z1,[f("div",W1,[g[1]||(g[1]=f("div",{class:"logo-section"},[f("h1",null,"SiNaik"),f("span",{class:"tagline"},"Dashboard UMKM")],-1)),f("div",Q1,[f("div",Y1,[g[0]||(g[0]=f("span",{class:"welcome-text"},"Selamat datang,",-1)),f("span",J1,j(o.value),1)]),f("button",{onClick:d,class:"logout-btn",disabled:i.value},j(i.value?"Keluar...":"Keluar"),9,X1)])])]),f("main",Z1,[f("div",eP,[f("div",tP,[g[6]||(g[6]=f("div",{class:"welcome-header"},[f("h1",{class:"welcome-title"},"Selamat Datang di SiNaik!"),f("p",{class:"welcome-subtitle"},"Sistem Intervensi Terpandu untuk membantu UMKM Anda berkembang")],-1)),f("div",nP,[f("div",sP,[f("span",iP,j(l.value?"1":"0"),1),g[2]||(g[2]=f("span",{class:"stat-label"},"Diagnosis Selesai",-1)),f("div",rP,j(l.value?"Tahap bisnis teridentifikasi":"Belum melakukan diagnosis"),1)]),g[5]||(g[5]=f("div",{class:"stat-item"},[f("span",{class:"stat-number"},"0"),f("span",{class:"stat-label"},"Rekomendasi Aktif"),f("div",{class:"stat-description"},"Saran untuk pengembangan bisnis")],-1)),f("div",oP,[f("span",aP,j(u.value),1),g[3]||(g[3]=f("span",{class:"stat-label"},"Poin Pencapaian",-1)),g[4]||(g[4]=f("div",{class:"stat-description"},"Dari menyelesaikan tantangan",-1))])])]),l.value?(O(),M("div",lP,[f("div",cP,[g[7]||(g[7]=f("h2",{class:"stage-title"},"🎯 Tahap Bisnis Anda Saat Ini",-1)),f("div",uP,j((A=c.value)==null?void 0:A.name),1)]),f("div",dP,[f("p",hP,j((F=c.value)==null?void 0:F.description),1),f("div",fP,[xe(y,{to:"/diagnosis",class:"btn btn-outline"},{default:Ht(()=>g[8]||(g[8]=[Be(" 📊 Lihat Detail Tahap ")])),_:1,__:[8]})])])])):X("",!0),l.value?X("",!0):(O(),M("div",mP,[f("div",pP,[g[10]||(g[10]=f("div",{class:"primary-icon"},"🚀",-1)),g[11]||(g[11]=f("h2",null,"Mulai Perjalanan Bisnis Anda",-1)),g[12]||(g[12]=f("p",null,"Langkah pertama untuk mengembangkan UMKM adalah memahami tahap bisnis Anda saat ini. Diagnosis ini akan membantu memberikan rekomendasi yang tepat.",-1)),xe(y,{to:"/diagnosis",class:"btn btn-primary btn-large"},{default:Ht(()=>g[9]||(g[9]=[Be(" 📊 Mulai Diagnosis Bisnis ")])),_:1,__:[9]})])])),f("div",gP,[f("div",{class:Se(["action-card",{"card-primary":!l.value}])},[f("div",_P,[g[14]||(g[14]=f("div",{class:"card-icon"},"📊",-1)),l.value?(O(),M("div",yP,g[13]||(g[13]=[f("span",{class:"status-badge status-complete"},"Selesai",-1)]))):X("",!0)]),g[15]||(g[15]=f("div",{class:"card-content"},[f("h3",null,"Diagnosis Bisnis"),f("p",null,"Tentukan tahap perkembangan bisnis Anda berdasarkan model Churchill & Lewis")],-1)),f("div",vP,[xe(y,{to:"/diagnosis",class:Se(["btn",l.value?"btn-outline":"btn-primary"])},{default:Ht(()=>[Be(j(l.value?"🔄 Perbarui Diagnosis":"🚀 Mulai Diagnosis"),1)]),_:1},8,["class"])])],2),f("div",{class:Se(["action-card",{"card-disabled":!l.value}])},[f("div",bP,[g[17]||(g[17]=f("div",{class:"card-icon"},"💡",-1)),l.value?X("",!0):(O(),M("div",EP,g[16]||(g[16]=[f("span",{class:"status-badge status-locked"},"Terkunci",-1)])))]),g[19]||(g[19]=f("div",{class:"card-content"},[f("h3",null,"Rekomendasi Bisnis"),f("p",null,"Dapatkan saran terpersonalisasi untuk mengembangkan bisnis Anda")],-1)),f("div",kP,[l.value?(O(),Wt(y,{key:0,to:"/recommendations?generate=true",class:"btn btn-primary"},{default:Ht(()=>g[18]||(g[18]=[Be(" 💡 Lihat Rekomendasi ")])),_:1,__:[18]})):(O(),M("button",wP," 🔒 Selesaikan Diagnosis Dulu "))])],2),f("div",{class:Se(["action-card",{"card-disabled":!l.value}])},[f("div",IP,[g[21]||(g[21]=f("div",{class:"card-icon"},"🎯",-1)),l.value?X("",!0):(O(),M("div",SP,g[20]||(g[20]=[f("span",{class:"status-badge status-locked"},"Terkunci",-1)])))]),g[22]||(g[22]=f("div",{class:"card-content"},[f("h3",null,"Tantangan & Gamifikasi"),f("p",null,"Raih poin dan pencapaian dengan menyelesaikan tantangan bisnis")],-1)),f("div",TP,[f("button",{class:Se(["btn",l.value?"btn-primary":"btn-disabled"]),disabled:!l.value},j(l.value?"🎯 Mulai Tantangan":"🔒 Selesaikan Diagnosis Dulu"),11,AP)])],2)])])])])}}},CP=gt(RP,[["__scopeId","data-v-1a88ef1c"]]),PP={class:"login-container"},DP={class:"login-card"},OP={key:0,class:"error-message"},NP={class:"error-text"},MP={class:"input-group"},xP={class:"input-wrapper"},VP={key:0,class:"field-error"},LP={class:"input-group"},$P={class:"input-wrapper"},FP=["type"],UP=["aria-label"],BP={key:0,class:"field-error"},jP={class:"forgot-password-section"},HP=["disabled"],qP=["disabled"],KP={key:0,class:"loading-spinner"},GP={class:"register-section"},zP={class:"register-text"},WP={class:"modal-body"},QP={class:"input-group"},YP={class:"modal-actions"},JP=["disabled"],XP=["disabled"],ZP={key:0,class:"loading-spinner"},eD={__name:"LoginView",setup(t){const e=ge(""),n=ge(""),s=ge(!1),i=ge(!1),r=ge(""),o=ge(""),l=ge(""),c=ge(!1),u=ge(""),d=ge(!1),m=Ii(),g=or(),y=Ie(()=>e.value.trim()!==""&&n.value.trim()!==""),A=()=>{s.value=!s.value},F=()=>{let D=!0;return o.value="",l.value="",r.value="",e.value.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.value)||(o.value="Format email tidak valid",D=!1):(o.value="Email harus diisi",D=!1),n.value.trim()?n.value.length<6&&(l.value="Password minimal 6 karakter",D=!1):(l.value="Password harus diisi",D=!1),D},N=async()=>{if(F()){i.value=!0,r.value="";try{console.log("🔄 Attempting login...");const D=await F1(e.value,n.value);console.log("✅ Login successful:",D),m.setUser(D),g.push("/")}catch(D){console.error("❌ Login error:",D),D.code==="auth/user-not-found"?r.value="Email tidak terdaftar. Silakan daftar terlebih dahulu.":D.code==="auth/wrong-password"?r.value="Password salah. Silakan coba lagi.":D.code==="auth/invalid-email"?r.value="Format email tidak valid.":D.code==="auth/too-many-requests"?r.value="Terlalu banyak percobaan login. Coba lagi nanti.":r.value="Terjadi kesalahan saat login. Silakan coba lagi."}finally{i.value=!1}}},x=()=>{u.value=e.value,c.value=!0},V=()=>{c.value=!1,u.value=""},R=async()=>{if(u.value.trim()){d.value=!0;try{await B1(u.value),r.value="",alert("Link reset password telah dikirim ke email Anda. Silakan cek inbox dan folder spam."),V()}catch(D){console.error("❌ Reset password error:",D),D.code==="auth/user-not-found"?alert("Email tidak terdaftar dalam sistem."):alert("Terjadi kesalahan saat mengirim email reset. Silakan coba lagi.")}finally{d.value=!1}}};return(D,P)=>{const H=fl("router-link");return O(),M("div",PP,[P[14]||(P[14]=f("div",{class:"background-pattern"},null,-1)),f("div",DP,[P[10]||(P[10]=An('<div class="login-header" data-v-957a0e24><div class="logo-section" data-v-957a0e24><h1 class="app-title" data-v-957a0e24>SiNaik</h1><p class="app-subtitle" data-v-957a0e24>Sistem Intervensi Terpandu UMKM</p></div><p class="welcome-text" data-v-957a0e24>Masuk ke akun Anda</p></div>',1)),r.value?(O(),M("div",OP,[P[4]||(P[4]=f("div",{class:"error-icon"},"⚠️",-1)),f("div",NP,j(r.value),1)])):X("",!0),f("form",{onSubmit:ts(N,["prevent"]),class:"login-form"},[f("div",MP,[P[6]||(P[6]=f("label",{for:"email",class:"input-label"},"Email",-1)),f("div",xP,[nt(f("input",{id:"email",type:"email","onUpdate:modelValue":P[0]||(P[0]=k=>e.value=k),placeholder:"Masukkan email Anda",class:Se(["form-input",{"input-error":o.value}]),required:"",autocomplete:"email"},null,2),[[qt,e.value]]),P[5]||(P[5]=f("div",{class:"input-icon"},"📧",-1))]),o.value?(O(),M("div",VP,j(o.value),1)):X("",!0)]),f("div",LP,[P[7]||(P[7]=f("label",{for:"password",class:"input-label"},"Password",-1)),f("div",$P,[nt(f("input",{id:"password",type:s.value?"text":"password","onUpdate:modelValue":P[1]||(P[1]=k=>n.value=k),placeholder:"Masukkan password Anda",class:Se(["form-input",{"input-error":l.value}]),required:"",autocomplete:"current-password"},null,10,FP),[[Rk,n.value]]),f("button",{type:"button",onClick:A,class:"password-toggle","aria-label":s.value?"Sembunyikan password":"Tampilkan password"},j(s.value?"🙈":"👁️"),9,UP)]),l.value?(O(),M("div",BP,j(l.value),1)):X("",!0)]),f("div",jP,[f("button",{type:"button",onClick:x,class:"forgot-password-link",disabled:i.value}," Lupa password? ",8,HP)]),f("button",{type:"submit",class:Se(["login-btn",{"btn-loading":i.value}]),disabled:i.value||!y.value},[i.value?(O(),M("span",KP)):X("",!0),Be(" "+j(i.value?"Memproses...":"Masuk"),1)],10,qP)],32),f("div",GP,[f("p",zP,[P[9]||(P[9]=Be(" Belum punya akun? ")),xe(H,{to:"/register",class:"register-link"},{default:Ht(()=>P[8]||(P[8]=[Be(" Daftar di sini ")])),_:1,__:[8]})])])]),c.value?(O(),M("div",{key:0,class:"modal-overlay",onClick:V},[f("div",{class:"modal-content",onClick:P[3]||(P[3]=ts(()=>{},["stop"]))},[f("div",{class:"modal-header"},[P[11]||(P[11]=f("h3",null,"Reset Password",-1)),f("button",{onClick:V,class:"modal-close"},"✕")]),f("div",WP,[P[13]||(P[13]=f("p",{class:"modal-description"}," Masukkan email Anda dan kami akan mengirimkan link untuk reset password. ",-1)),f("div",QP,[P[12]||(P[12]=f("label",{for:"reset-email",class:"input-label"},"Email",-1)),nt(f("input",{id:"reset-email",type:"email","onUpdate:modelValue":P[2]||(P[2]=k=>u.value=k),placeholder:"Masukkan email Anda",class:"form-input",required:""},null,512),[[qt,u.value]])])]),f("div",YP,[f("button",{onClick:V,class:"btn btn-secondary",disabled:d.value}," Batal ",8,JP),f("button",{onClick:R,class:"btn btn-primary",disabled:d.value||!u.value},[d.value?(O(),M("span",ZP)):X("",!0),Be(" "+j(d.value?"Mengirim...":"Kirim Link Reset"),1)],8,XP)])])])):X("",!0)])}}},tD=gt(eD,[["__scopeId","data-v-957a0e24"]]),nD={__name:"RegisterView",setup(t){const e=ge(""),n=ge(""),s=ge(""),i=or(),r=async()=>{try{await $1(n.value,s.value,e.value),i.push("/")}catch(o){console.error(o)}};return(o,l)=>(O(),M("div",null,[l[4]||(l[4]=f("h1",null,"Register",-1)),f("form",{onSubmit:ts(r,["prevent"])},[nt(f("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=c=>e.value=c),placeholder:"Nama Usaha"},null,512),[[qt,e.value]]),nt(f("input",{type:"email","onUpdate:modelValue":l[1]||(l[1]=c=>n.value=c),placeholder:"Email"},null,512),[[qt,n.value]]),nt(f("input",{type:"password","onUpdate:modelValue":l[2]||(l[2]=c=>s.value=c),placeholder:"Password"},null,512),[[qt,s.value]]),l[3]||(l[3]=f("button",{type:"submit"},"Daftar",-1))],32)]))}},sD={class:"diagnosis-container"},iD={key:0,class:"progress-section"},rD={class:"progress-info"},oD={class:"progress-bar"},aD={key:1,class:"question-section"},lD={class:"question-card"},cD={class:"question-header"},uD={key:0,class:"question-subtitle"},dD={class:"question-content"},hD={key:0,class:"input-group"},fD=["placeholder","min","max"],mD={key:1,class:"select-group"},pD=["value"],gD={key:2,class:"radio-group"},_D=["value"],yD={class:"radio-label"},vD={class:"question-navigation"},bD=["disabled"],ED=["disabled"],kD={key:2,class:"results-section"},wD={class:"results-card"},ID={class:"stage-result"},SD={class:"stage-badge"},TD={class:"confidence-score"},AD={class:"stage-description"},RD={class:"stage-characteristics"},CD={class:"stage-challenges"},PD={key:3,class:"loading-section"},DD={key:4,class:"error-section"},OD={class:"error-message"},ND={__name:"DiagnosisView",setup(t){const e=or(),n=jl(),s=Ii(),i=Ie(()=>n.currentQuestion),r=Ie(()=>n.currentStageDetails),o=Ie(()=>n.currentStep===n.totalQuestions-1),l=Ie({get(){var y;return n.currentAnswers[(y=i.value)==null?void 0:y.id]||""},set(y){i.value&&n.setAnswer(i.value.id,y)}}),c=()=>{n.nextQuestion()},u=()=>{n.previousQuestion()},d=()=>{n.startDiagnosis()},m=()=>{n.currentStage&&s.updateUserProfile({businessStage:n.currentStage,lastDiagnosisDate:new Date().toISOString()}),e.push("/recommendations?generate=true")},g=()=>{n.currentStage&&s.updateUserProfile({businessStage:n.currentStage,lastDiagnosisDate:new Date().toISOString()}),e.push("/")};return En(()=>{n.loadDiagnosisData(),!n.isCompleted&&n.currentStep===0&&n.startDiagnosis()}),Pn(()=>n.isCompleted,y=>{y&&n.saveDiagnosisData()}),(y,A)=>{var F,N,x,V,R,D;return O(),M("div",sD,[A[10]||(A[10]=f("div",{class:"diagnosis-header"},[f("h1",null,"🎯 Diagnosis Tahap Bisnis"),f("p",null,"Temukan tahap perkembangan bisnis Anda berdasarkan model Churchill & Lewis")],-1)),de(n).isCompleted?X("",!0):(O(),M("div",iD,[f("div",rD,[f("span",null,"Pertanyaan "+j(de(n).currentStep+1)+" dari "+j(de(n).totalQuestions),1),f("span",null,j(de(n).progress)+"%",1)]),f("div",oD,[f("div",{class:"progress-fill",style:fn({width:de(n).progress+"%"})},null,4)])])),!de(n).isCompleted&&i.value?(O(),M("div",aD,[f("div",lD,[f("div",cD,[f("h2",null,j(i.value.question),1),i.value.subtitle?(O(),M("p",uD,j(i.value.subtitle),1)):X("",!0)]),f("div",dD,[i.value.type==="number"?(O(),M("div",hD,[nt(f("input",{type:"number",placeholder:i.value.placeholder,min:(F=i.value.validation)==null?void 0:F.min,max:(N=i.value.validation)==null?void 0:N.max,"onUpdate:modelValue":A[0]||(A[0]=P=>l.value=P),class:"number-input"},null,8,fD),[[qt,l.value,void 0,{number:!0}]])])):i.value.type==="select"?(O(),M("div",mD,[nt(f("select",{"onUpdate:modelValue":A[1]||(A[1]=P=>l.value=P),class:"select-input"},[A[4]||(A[4]=f("option",{value:""},"Pilih salah satu...",-1)),(O(!0),M(Ae,null,ze(i.value.options,P=>(O(),M("option",{key:P.value,value:P.value},j(P.label),9,pD))),128))],512),[[ei,l.value]])])):i.value.type==="radio"?(O(),M("div",gD,[(O(!0),M(Ae,null,ze(i.value.options,P=>(O(),M("label",{key:P.value,class:"radio-option"},[nt(f("input",{type:"radio",value:P.value,"onUpdate:modelValue":A[2]||(A[2]=H=>l.value=H),class:"radio-input"},null,8,_D),[[Sg,l.value]]),f("span",yD,j(P.label),1)]))),128))])):X("",!0)]),f("div",vD,[f("button",{onClick:u,disabled:de(n).currentStep===0,class:"nav-btn secondary"}," ⬅️ Sebelumnya ",8,bD),f("button",{onClick:c,disabled:!de(n).canProceed,class:"nav-btn primary"},j(o.value?"🎯 Selesai":"Selanjutnya ➡️"),9,ED)])])])):X("",!0),de(n).isCompleted?(O(),M("div",kD,[f("div",wD,[A[7]||(A[7]=f("div",{class:"results-header"},[f("h2",null,"🎉 Hasil Diagnosis Bisnis Anda"),f("p",null,"Berdasarkan jawaban Anda, berikut adalah tahap bisnis Anda saat ini:")],-1)),f("div",ID,[f("div",SD,[f("h3",null,j((x=r.value)==null?void 0:x.name),1),f("div",TD," Tingkat Keyakinan: "+j(de(n).confidence)+"% ",1)]),f("div",AD,[f("p",null,j((V=r.value)==null?void 0:V.description),1)]),f("div",RD,[A[5]||(A[5]=f("h4",null,"Karakteristik Tahap Ini:",-1)),f("ul",null,[(O(!0),M(Ae,null,ze((R=r.value)==null?void 0:R.characteristics,P=>(O(),M("li",{key:P},j(P),1))),128))])]),f("div",CD,[A[6]||(A[6]=f("h4",null,"Tantangan Utama:",-1)),f("ul",null,[(O(!0),M(Ae,null,ze((D=r.value)==null?void 0:D.challenges,P=>(O(),M("li",{key:P},j(P),1))),128))])])]),f("div",{class:"results-actions"},[f("button",{onClick:m,class:"action-btn primary"}," 💡 Lihat Rekomendasi "),f("button",{onClick:d,class:"action-btn secondary"}," 🔄 Ulangi Diagnosis "),f("button",{onClick:g,class:"action-btn secondary"}," 🏠 Kembali ke Dashboard ")])])])):X("",!0),de(n).loading?(O(),M("div",PD,A[8]||(A[8]=[f("div",{class:"loading-spinner"},null,-1),f("p",null,"Memproses hasil diagnosis...",-1)]))):X("",!0),de(n).error?(O(),M("div",DD,[f("div",OD,[A[9]||(A[9]=f("h3",null,"❌ Terjadi Kesalahan",-1)),f("p",null,j(de(n).error),1),f("button",{onClick:A[3]||(A[3]=P=>de(n).clearError()),class:"retry-btn"}," Coba Lagi ")])])):X("",!0)])}}},MD=gt(ND,[["__scopeId","data-v-e7ad7d75"]]),Nr={EXISTENCE:"existence",SURVIVAL:"survival",SUCCESS:"success",TAKEOFF:"takeoff",RESOURCE_MATURITY:"resource_maturity"},bn={CRITICAL:"critical",HIGH:"high",MEDIUM:"medium"},Dt={PENDING:"pending",IN_PROGRESS:"in_progress",COMPLETED:"completed",SKIPPED:"skipped"},Ft={FINANCIAL_MANAGEMENT:"financial_management",MARKETING_SALES:"marketing_sales",OPERATIONS:"operations",HUMAN_RESOURCES:"human_resources",TECHNOLOGY:"technology",LEGAL_COMPLIANCE:"legal_compliance",GROWTH_STRATEGY:"growth_strategy",FINANCIAL_LITERACY:"financial_literacy"},Kt=(t={})=>({id:t.id||mr(),userId:t.userId||"",title:t.title||"",description:t.description||"",category:t.category||"",priority:t.priority||bn.MEDIUM,businessStage:t.businessStage||"",actionItems:t.actionItems||[],resources:t.resources||[],estimatedTimeframe:t.estimatedTimeframe||"",expectedImpact:t.expectedImpact||"",reasoning:t.reasoning||"",status:t.status||"pending",isCompleted:t.isCompleted||!1,isBookmarked:t.isBookmarked||!1,completedAt:t.completedAt||null,startedAt:t.startedAt||null,progress:t.progress||0,progressSteps:t.progressSteps||[],currentStep:t.currentStep||0,totalSteps:t.totalSteps||0,completionNotes:t.completionNotes||"",userRating:t.userRating||null,userFeedback:t.userFeedback||"",implementationDifficulty:t.implementationDifficulty||null,actualImpact:t.actualImpact||null,milestones:t.milestones||[],checkpoints:t.checkpoints||[],completionHistory:t.completionHistory||[],viewCount:t.viewCount||0,lastViewedAt:t.lastViewedAt||null,estimatedCompletionDate:t.estimatedCompletionDate||null,createdAt:t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt||new Date().toISOString()}),Xn=(t={})=>({id:t.id||mr(),title:t.title||"",description:t.description||"",priority:t.priority||bn.MEDIUM,estimatedHours:t.estimatedHours||0,deadline:t.deadline||null,isCompleted:t.isCompleted||!1,completedAt:t.completedAt||null,resources:t.resources||[]}),jt=(t={})=>({id:t.id||mr(),title:t.title||"",description:t.description||"",type:t.type||"article",url:t.url||"",isExternal:t.isExternal||!0,language:t.language||"id",difficulty:t.difficulty||"beginner"}),Sv=(t,e)=>({businessProfile:{name:t.businessName,category:t.businessCategory,stage:t.businessStage,employeeCount:t.employeeCount,monthlyRevenue:t.monthlyRevenue,businessAge:t.businessAge,location:t.location,challenges:t.challenges,goals:t.goals},diagnosisResults:{currentStage:e.currentStage,answers:e.answers,strengths:e.strengths||[],weaknesses:e.weaknesses||[],opportunities:e.opportunities||[]},context:{country:"Indonesia",targetAudience:"UMKM (Usaha Mikro, Kecil, dan Menengah)",language:"Indonesian",culturalContext:"Indonesian business environment",regulations:"Indonesian business regulations and compliance"}}),mr=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),so=(t={})=>({id:t.id||mr(),title:t.title||"",description:t.description||"",order:t.order||0,status:t.status||"pending",isRequired:t.isRequired||!0,estimatedDuration:t.estimatedDuration||"",resources:t.resources||[],tips:t.tips||[],completedAt:t.completedAt||null,startedAt:t.startedAt||null,notes:t.notes||"",createdAt:t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt||new Date().toISOString()}),Vd=(t={})=>({id:t.id||mr(),title:t.title||"",description:t.description||"",targetDate:t.targetDate||null,completedAt:t.completedAt||null,isCompleted:t.isCompleted||!1,requiredSteps:t.requiredSteps||[],reward:t.reward||"",icon:t.icon||"🎯",createdAt:t.createdAt||new Date().toISOString()}),hn=(t={})=>({id:t.id||mr(),stepId:t.stepId||"",title:t.title||"",description:t.description||"",isCompleted:t.isCompleted||!1,completedAt:t.completedAt||null,order:t.order||0,createdAt:t.createdAt||new Date().toISOString()}),xD=t=>({[Ft.FINANCIAL_MANAGEMENT]:"💰",[Ft.MARKETING_SALES]:"📈",[Ft.OPERATIONS]:"⚙️",[Ft.HUMAN_RESOURCES]:"👥",[Ft.TECHNOLOGY]:"💻",[Ft.LEGAL_COMPLIANCE]:"📋",[Ft.GROWTH_STRATEGY]:"🚀",[Ft.FINANCIAL_LITERACY]:"📚"})[t]||"💡",Ge={GEMINI_API_KEY:"AIzaSyD2ILgdmD_6SuI-ZxmH-dHOCwVyjbS3FcQ",GEMINI_API_URL:"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent",MODEL:"gemini-2.0-flash",MAX_TOKENS:8192,TEMPERATURE:.7,TOP_P:.8,TOP_K:40,ENABLED:!0,MAX_RETRIES:3,RETRY_DELAY:1e3,TIMEOUT:45e3,BYPASS_MODE:!0,FALLBACK_ENABLED:!0,SAFETY_SETTINGS:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"}]},VD=t=>{console.log("🔧 Creating simple test recommendations for UI testing");const e=[Kt({userId:t,title:"Optimasi Manajemen Keuangan",description:"Implementasikan sistem pencatatan keuangan yang lebih terstruktur untuk meningkatkan kontrol cash flow dan profitabilitas bisnis.",category:"financial_management",priority:"high",estimatedTimeframe:"2-3 minggu",expectedImpact:"Peningkatan kontrol keuangan dan visibilitas cash flow",reasoning:"Manajemen keuangan yang baik adalah fondasi bisnis yang sehat",actionItems:[Xn({title:"Setup sistem pencatatan",description:"Implementasikan software akuntansi atau sistem pencatatan manual yang konsisten",estimatedHours:8,deadline:null})],resources:[jt({title:"Panduan Manajemen Keuangan UMKM",description:"Panduan lengkap untuk mengelola keuangan bisnis kecil",type:"guide",url:"#"})]}),Kt({userId:t,title:"Strategi Digital Marketing",description:"Kembangkan strategi pemasaran digital yang efektif untuk menjangkau target pasar yang lebih luas dan meningkatkan brand awareness.",category:"marketing_sales",priority:"medium",estimatedTimeframe:"3-4 minggu",expectedImpact:"Peningkatan jangkauan pasar dan brand awareness",reasoning:"Digital marketing adalah kunci pertumbuhan bisnis di era digital",actionItems:[Xn({title:"Buat konten media sosial",description:"Kembangkan strategi konten untuk platform media sosial utama",estimatedHours:12,deadline:null})],resources:[jt({title:"Panduan Digital Marketing untuk UMKM",description:"Strategi pemasaran digital yang efektif untuk bisnis kecil",type:"guide",url:"#"})]}),Kt({userId:t,title:"Peningkatan Efisiensi Operasional",description:"Evaluasi dan optimasi proses operasional untuk mengurangi waste dan meningkatkan produktivitas tim.",category:"operations",priority:"medium",estimatedTimeframe:"2-4 minggu",expectedImpact:"Peningkatan efisiensi dan produktivitas operasional",reasoning:"Operasional yang efisien mengurangi biaya dan meningkatkan kepuasan pelanggan",actionItems:[Xn({title:"Audit proses operasional",description:"Lakukan evaluasi menyeluruh terhadap proses bisnis saat ini",estimatedHours:16,deadline:null})],resources:[jt({title:"Panduan Optimasi Operasional",description:"Cara meningkatkan efisiensi operasional bisnis",type:"guide",url:"#"})]})];return console.log(`✅ Created ${e.length} simple test recommendations`),e},LD=async(t,e)=>{var c;console.log("🔥 Attempting Firebase AI with Direct Gemini API...");const n=Sv(t,e),s=Tv(n);console.log("📤 Sending prompt to Gemini (length:",s.length,"chars)");const i=await fetch(Ge.GEMINI_API_URL,{method:"POST",headers:{"Content-Type":"application/json","X-goog-api-key":Ge.GEMINI_API_KEY},body:JSON.stringify({contents:[{parts:[{text:s}]}],generationConfig:{temperature:Ge.TEMPERATURE,topK:Ge.TOP_K,topP:Ge.TOP_P,maxOutputTokens:Ge.MAX_TOKENS},safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_MEDIUM_AND_ABOVE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_MEDIUM_AND_ABOVE"}]})});if(!i.ok){let u=`Gemini API error: ${i.status}`;try{const d=await i.json();(c=d.error)!=null&&c.message&&(u+=` - ${d.error.message}`)}catch{u+=` - ${i.statusText}`}throw new Error(u)}const r=await i.json();if(!r.candidates||!r.candidates[0]||!r.candidates[0].content)throw new Error("Invalid response format from Gemini API");const o=r.candidates[0].content.parts[0].text;if(!o)throw new Error("Empty response from Gemini model");console.log("📥 Received AI response (length:",o.length,"chars)");const l=jD(o,t.userId);if(l.length===0)throw new Error("No valid recommendations generated from AI response");return console.log("✅ Firebase AI successful, generated",l.length,"recommendations"),l},$D=async(t,e)=>{var r;console.log("🤖 Attempting Enhanced AI with sophisticated prompting...");const n=Sv(t,e),s=Tv(n);let i=null;for(let o=1;o<=Ge.MAX_RETRIES;o++)try{console.log(`📤 AI Attempt ${o}/${Ge.MAX_RETRIES} - Sending enhanced prompt (${s.length} chars)`);const l=new AbortController,c=setTimeout(()=>l.abort(),Ge.TIMEOUT),u=await fetch(Ge.GEMINI_API_URL,{method:"POST",headers:{"Content-Type":"application/json","X-goog-api-key":Ge.GEMINI_API_KEY},body:JSON.stringify({contents:[{parts:[{text:s}]}],generationConfig:{temperature:Ge.TEMPERATURE,topK:Ge.TOP_K,topP:Ge.TOP_P,maxOutputTokens:Ge.MAX_TOKENS,candidateCount:1},safetySettings:Ge.SAFETY_SETTINGS}),signal:l.signal});if(clearTimeout(c),!u.ok){let y=`Enhanced AI error: ${u.status}`;try{const A=await u.json();(r=A.error)!=null&&r.message&&(y+=` - ${A.error.message}`)}catch{y+=` - ${u.statusText}`}throw new Error(y)}const d=await u.json();if(!d.candidates||!d.candidates[0]||!d.candidates[0].content)throw new Error("Invalid response format from Enhanced AI");const m=d.candidates[0].content.parts[0].text;if(!m||m.trim().length===0)throw new Error("Empty response from Enhanced AI model");console.log(`📥 Enhanced AI response received (${m.length} chars)`);const g=HD(m,t.userId);if(!g||g.length===0)throw new Error("No valid recommendations generated from Enhanced AI response");return console.log(`✅ Enhanced AI successful on attempt ${o}, generated ${g.length} recommendations`),g}catch(l){if(i=l,console.error(`❌ Enhanced AI attempt ${o} failed:`,l.message),o<Ge.MAX_RETRIES){const c=Ge.RETRY_DELAY*Math.pow(2,o-1);console.log(`⏳ Retrying in ${c}ms...`),await new Promise(u=>setTimeout(u,c))}}throw new Error(`Enhanced AI failed after ${Ge.MAX_RETRIES} attempts. Last error: ${i==null?void 0:i.message}`)},Ld=async(t,e)=>{var n;try{console.log("🤖 Starting AI recommendation generation process..."),console.log("🔍 DEBUG: businessProfile:",t),console.log("🔍 DEBUG: diagnosisData:",e),console.log("🔍 DEBUG: AI_CONFIG.ENABLED:",Ge.ENABLED),console.log("🔍 DEBUG: AI_CONFIG.BYPASS_MODE:",Ge.BYPASS_MODE),console.log("🔍 DEBUG: AI_CONFIG.GEMINI_API_KEY exists:",!!Ge.GEMINI_API_KEY),console.log("🔍 DEBUG: VITE_BYPASS_JSON_PARSING:","true"),Ge.BYPASS_MODE;{console.log("🔧 BYPASS MODE: Creating simple recommendations (explicitly enabled)");const s=VD(t.userId);return console.log("🔧 BYPASS: Created recommendations:",s.length),s}if(Ge.ENABLED&&Ge.GEMINI_API_KEY){console.log("🤖 Attempting Real AI with Enhanced Gemini API...");try{const s=await $D(t,e);if(s&&s.length>0)return console.log("✅ Enhanced AI successful, returning",s.length,"recommendations"),s}catch(s){if(console.error("❌ Enhanced AI failed:",s),Ge.FALLBACK_ENABLED){console.log("🔄 Trying fallback AI method...");try{const i=await LD(t,e);if(i&&i.length>0)return console.log("✅ Fallback AI successful, returning",i.length,"recommendations"),i}catch(i){console.error("❌ Fallback AI also failed:",i)}}}}return console.warn("⚠️ All AI methods unavailable, using rule-based recommendations"),Ym(t)}catch(s){return console.error("❌ Error generating Firebase AI recommendations:",s),s.requestId&&console.error("🔍 Request ID:",s.requestId),s.message.includes("JSON")?(console.error("🔍 JSON parsing error - this may indicate prompt needs adjustment"),console.error("🔍 Error details:",{message:s.message,stack:(n=s.stack)==null?void 0:n.substring(0,300)})):s.message.includes("Empty response")?console.error("🔍 Empty response - check Gemini model availability"):s.message.includes("Firebase AI not available")?console.error("🔍 Firebase AI not initialized - check Firebase console"):s.code&&(console.error("🔍 Error code:",s.code),console.error("🔍 Error details:",s.details||s.message)),console.log("🔄 Falling back to rule-based recommendations"),Ym(t)}},Ym=t=>{console.log("📋 Generating rule-based recommendations...");const e=[],n=t.businessStage,s=t.userId;switch(n){case Nr.EXISTENCE:e.push(...qD(s));break;case Nr.SURVIVAL:e.push(...KD(s));break;case Nr.SUCCESS:e.push(...GD(s));break;case Nr.TAKEOFF:e.push(...zD(s));break;case Nr.RESOURCE_MATURITY:e.push(...WD(s));break;default:e.push(...QD(s))}return e.push(...YD(s)),console.log(`✅ Generated ${e.length} rule-based recommendations`),e},Tv=t=>{var n,s,i,r,o,l,c,u;return`Anda adalah Dr. Sari Wijaya, konsultan bisnis senior dengan 20+ tahun pengalaman khusus dalam pengembangan UMKM Indonesia. Anda memiliki:

🎓 KEAHLIAN UTAMA:
- PhD Manajemen Bisnis dengan spesialisasi UMKM Asia Tenggara
- Sertifikasi konsultan bisnis dari Kementerian Koperasi dan UKM RI
- Pengalaman mendampingi 500+ UMKM di berbagai sektor
- Pemahaman mendalam model Churchill & Lewis untuk konteks Indonesia
- Expertise dalam digitalisasi UMKM dan transformasi digital

🇮🇩 KONTEKS INDONESIA 2024:
- Regulasi terbaru: UU Cipta Kerja, PP UMKM No. 7/2021, Perpres 98/2021
- Program pemerintah: KUR (Kredit Usaha Rakyat), BPUM, PEN UMKM
- Tren pasar: E-commerce boom, digital payment adoption, sustainability focus
- Tantangan utama: Inflasi, supply chain disruption, talent shortage
- Peluang: Export digitalization, green economy, halal industry

📊 METODOLOGI ANALISIS:
- Gunakan framework Churchill & Lewis (5 tahap: Existence, Survival, Success, Take-off, Resource Maturity)
- Pertimbangkan konteks lokal: budaya kerja Indonesia, preferensi konsumen, infrastruktur
- Fokus pada solusi praktis, cost-effective, dan sustainable
- Prioritaskan quick wins dan long-term strategic moves

📋 TUGAS ANDA (${new Date().toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"})}):
Analisis mendalam profil bisnis dan data diagnosis berikut, lalu berikan 6-10 rekomendasi strategis yang:

✅ KRITERIA REKOMENDASI:
1. Spesifik untuk industri dan tahap bisnis klien
2. Actionable dengan langkah-langkah konkret dan timeline jelas
3. Relevan dengan kondisi pasar Indonesia 2024
4. Mempertimbangkan keterbatasan resource UMKM
5. Mengintegrasikan aspek digital dan tradisional
6. Sustainable dan scalable untuk jangka panjang
7. Include estimasi biaya dan ROI yang realistis

🎯 FOKUS AREA PRIORITAS:
- Revenue growth dan market expansion
- Operational efficiency dan cost optimization
- Digital transformation dan online presence
- Customer acquisition, retention, dan loyalty
- Supply chain dan inventory management
- Human capital development
- Financial management dan access to capital
- Compliance, risk management, dan sustainability

📊 ANALISIS BISNIS:

## PROFIL BISNIS:
- **Nama Bisnis**: ${t.businessProfile.name}
- **Kategori**: ${t.businessProfile.category}
- **Tahap Bisnis**: ${t.businessProfile.stage}
- **Jumlah Karyawan**: ${t.businessProfile.employeeCount} orang
- **Pendapatan Bulanan**: Rp ${((n=t.businessProfile.monthlyRevenue)==null?void 0:n.toLocaleString("id-ID"))||"Tidak disebutkan"}
- **Usia Bisnis**: ${t.businessProfile.businessAge} tahun
- **Lokasi**: ${t.businessProfile.location}
- **Tantangan Utama**: ${((s=t.businessProfile.challenges)==null?void 0:s.join(", "))||"Belum diidentifikasi"}
- **Tujuan Bisnis**: ${((i=t.businessProfile.goals)==null?void 0:i.join(", "))||"Belum ditetapkan"}

## HASIL DIAGNOSIS CHURCHILL & LEWIS:
- **Tahap Saat Ini**: ${t.diagnosisResults.currentStage}
- **Kekuatan**: ${((r=t.diagnosisResults.strengths)==null?void 0:r.join(", "))||"Sedang dianalisis"}
- **Area Pengembangan**: ${((o=t.diagnosisResults.weaknesses)==null?void 0:o.join(", "))||"Sedang dianalisis"}
- **Peluang**: ${((l=t.diagnosisResults.opportunities)==null?void 0:l.join(", "))||"Sedang diidentifikasi"}

## INSTRUKSI OUTPUT:
Berikan 6-10 rekomendasi dalam format JSON yang valid dengan struktur lengkap berikut:

\`\`\`json
{
  "recommendations": [
    {
      "title": "Judul rekomendasi yang jelas dan actionable",
      "description": "Deskripsi detail yang menjelaskan apa, mengapa, dan bagaimana (min 100 kata)",
      "category": "pilih: financial_management, marketing_sales, operations, human_resources, technology, legal_compliance, growth_strategy, customer_service",
      "priority": "pilih: critical, high, medium, low",
      "businessStage": "tahap bisnis yang paling cocok untuk rekomendasi ini",
      "estimatedTimeframe": "estimasi waktu penyelesaian (contoh: 2-4 minggu)",
      "expectedImpact": "dampak positif yang diharapkan dengan metrik spesifik",
      "reasoning": "analisis mendalam mengapa rekomendasi ini kritis untuk bisnis saat ini",
      "estimatedCost": "estimasi biaya implementasi dalam Rupiah",
      "difficultyLevel": "pilih: easy, medium, hard",
      "tags": ["tag1", "tag2", "tag3"],

      "progressSteps": [
        {
          "title": "Nama langkah implementasi",
          "description": "Detail apa yang harus dilakukan pada langkah ini",
          "order": 1,
          "isRequired": true,
          "estimatedDuration": "estimasi waktu (contoh: 3-5 hari)",
          "resources": [
            {
              "title": "Nama resource",
              "description": "Deskripsi resource",
              "type": "pilih: article, video, tool, course, template, website, guide",
              "url": "URL valid atau '#'"
            }
          ],
          "tips": ["Tip praktis 1", "Tip praktis 2"],
          "checkpoints": [
            {
              "title": "Checkpoint yang harus dicapai",
              "description": "Detail checkpoint",
              "order": 1
            }
          ]
        }
      ],

      "milestones": [
        {
          "title": "Nama milestone penting",
          "description": "Deskripsi pencapaian milestone",
          "targetDate": "estimasi tanggal target (YYYY-MM-DD)",
          "reward": "benefit atau pencapaian yang didapat",
          "icon": "emoji yang sesuai",
          "requiredSteps": [0, 1, 2]
        }
      ],

      "actionItems": [
        {
          "title": "Aksi spesifik yang dapat dilakukan",
          "description": "Detail implementasi step-by-step",
          "estimatedHours": 8,
          "deadline": "YYYY-MM-DD"
        }
      ]
    }
  ],

  "summary": {
    "totalRecommendations": 7,
    "priorityDistribution": {
      "critical": 2,
      "high": 3,
      "medium": 2,
      "low": 0
    },
    "estimatedImplementationTime": "3-6 bulan",
    "keyFocusAreas": ["area1", "area2", "area3"],
    "nextSteps": "Langkah pertama yang harus segera dilakukan"
  }
}
\`\`\`

## PANDUAN REKOMENDASI BERKUALITAS:

🎯 **KRITERIA UTAMA:**
1. **Relevansi Tahap Bisnis**: Sesuai dengan ${t.businessProfile.stage} stage Churchill & Lewis
2. **Konteks Indonesia 2024**: Pertimbangkan regulasi, budaya, dan kondisi ekonomi terkini
3. **Resource-Conscious**: Realistis untuk keterbatasan UMKM (budget, SDM, waktu)
4. **Measurable Impact**: Berikan metrik konkret dan timeline yang jelas
5. **Progressive Steps**: Buat langkah-langkah yang dapat diikuti secara bertahap
6. **Local Resources**: Prioritaskan tools, platform, dan layanan yang tersedia di Indonesia

💡 **FOKUS STRATEGIS:**
- **Quick Wins** (1-4 minggu): Solusi cepat untuk masalah mendesak
- **Medium-term Goals** (1-3 bulan): Perbaikan operasional dan efisiensi
- **Long-term Vision** (3-12 bulan): Transformasi dan pertumbuhan berkelanjutan

🔍 **AREA PRIORITAS BERDASARKAN PROFIL:**
- Tantangan utama: ${((c=t.businessProfile.challenges)==null?void 0:c.join(", "))||"Optimasi umum"}
- Tujuan bisnis: ${((u=t.businessProfile.goals)==null?void 0:u.join(", "))||"Pertumbuhan berkelanjutan"}
- Industri: ${t.businessProfile.category} - pertimbangkan tren dan regulasi spesifik
- Lokasi: ${t.businessProfile.location} - manfaatkan ekosistem lokal

✅ **VALIDASI AKHIR:**
Setiap rekomendasi harus lulus tes:
1. Apakah ini actionable dalam 30 hari pertama?
2. Apakah ROI-nya jelas dan terukur?
3. Apakah sesuai dengan kapasitas UMKM Indonesia?
4. Apakah ada dukungan ekosistem lokal?
5. Apakah compliance dengan regulasi Indonesia?

**MULAI ANALISIS DAN BERIKAN REKOMENDASI DALAM FORMAT JSON YANG DIMINTA.**

## PENTING - FORMAT OUTPUT:
1. **HANYA JSON**: Berikan output dalam format JSON yang valid
2. **TANPA MARKDOWN**: Jangan gunakan \`\`\`json atau \`\`\`
3. **TANPA TEKS TAMBAHAN**: Tidak ada penjelasan di luar JSON
4. **VALID JSON**: Pastikan semua string menggunakan double quotes
5. **NO TRAILING COMMAS**: Jangan ada koma di akhir object/array

Contoh format yang BENAR:
{
  "recommendations": [
    {
      "title": "Judul rekomendasi",
      "description": "Deskripsi lengkap",
      "category": "financial_management",
      "priority": "high",
      "actionItems": [
        {
          "title": "Aksi spesifik",
          "description": "Detail implementasi",
          "estimatedHours": 8,
          "deadline": "2024-02-15"
        }
      ],
      "resources": [
        {
          "title": "Nama resource",
          "description": "Deskripsi resource",
          "type": "article",
          "url": "https://example.com"
        }
      ],
      "estimatedTimeframe": "1-2 minggu",
      "expectedImpact": "Dampak yang diharapkan",
      "reasoning": "Alasan rekomendasi"
    }
  ]
}

MULAI JSON OUTPUT SEKARANG:`},Jm=t=>{try{let e=t;e=e.replace(/"description":\s*"([^"]*)"([^"]*)"([^"]*?)"/g,(i,r,o,l)=>`"description": "${r}\\"${o}\\"${l}"`),e=e.replace(/"title":\s*"([^"]*)"([^"]*)"([^"]*?)"/g,(i,r,o,l)=>`"title": "${r}\\"${o}\\"${l}"`),e=e.replace(/"([^"]+)":\s*"([^"]*)"([^"]*)"([^"]*?)"/g,(i,r,o,l,c)=>`"${r}": "${o}\\"${l}\\"${c}"`);const n=e.split(`
`);return n.map((i,r)=>{if(i.includes('": "')&&!i.trim().match(/[",}]$/)&&r<n.length-1){const o=n[r+1].trim();if(!o.startsWith('"')&&!o.startsWith("}")&&!o.startsWith("]"))return i+'",'}return i}).join(`
`)}catch(e){return console.warn("⚠️ Error in quote fixing, returning original:",e),t}},FD=t=>{try{let e=t.trim();const n=e.indexOf("{"),s=e.lastIndexOf("}");if(n===-1||s===-1)throw new Error("No valid JSON structure found");return e=e.substring(n,s+1),e=e.replace(/```json\n?|\n?```/g,"").replace(/```\n?|\n?```/g,"").replace(/[\x00-\x1F\x7F-\x9F]/g," ").replace(/\s+/g," ").replace(/,(\s*[}\]])/g,"$1").replace(/([{,]\s*)([a-zA-Z_][a-zA-Z0-9_]*)\s*:/g,'$1"$2":').replace(/'/g,'"').replace(/"(\s*)$/gm,'",').replace(/:\s*([a-zA-Z][a-zA-Z0-9\s]*[a-zA-Z0-9])\s*([,}])/g,': "$1"$2').replace(/"([^"]*)"([^"]*)"([^"]*?)"/g,'"$1\\"$2\\"$3"').replace(/[^\x20-\x7E"{}[\]:,]/g," ").replace(/\s+/g," ").trim(),e}catch(e){return console.warn("⚠️ Aggressive cleaning failed:",e),t}},Xm=t=>{try{console.log("☢️ Nuclear JSON rebuild initiated...");const e=[],n=/"([^"]+)":\s*"([^"]*?)"/g;let s;for(;(s=n.exec(t))!==null;){const c=s[1];let u=s[2];u=u.replace(/[\x00-\x1F\x7F-\x9F]/g," ").replace(/"/g,'\\"').replace(/\s+/g," ").trim(),e.push({key:c,value:u})}const i=[];let r={};e.forEach(({key:c,value:u})=>{c==="title"&&Object.keys(r).length>0&&(i.push(r),r={}),r[c]=u}),Object.keys(r).length>0&&i.push(r);const o={recommendations:i.map(c=>({title:c.title||"Rekomendasi Bisnis",description:c.description||"Deskripsi rekomendasi untuk bisnis Anda",category:c.category||"growth_strategy",priority:c.priority||"medium",estimatedTimeframe:c.estimatedTimeframe||"2-4 minggu",expectedImpact:c.expectedImpact||"Dampak positif pada bisnis",reasoning:c.reasoning||"Rekomendasi berdasarkan analisis AI"}))},l=JSON.stringify(o,null,2);return console.log("☢️ Nuclear rebuild successful, created",o.recommendations.length,"recommendations"),l}catch(e){throw console.error("☢️ Nuclear rebuild failed:",e),e}},Zm=(t,e)=>{console.log("🔧 Attempting manual extraction from AI response...");try{const n=[],s=[/"title":\s*"([^"]+)"/g,/title:\s*"([^"]+)"/g,/Title:\s*"([^"]+)"/g,/"judul":\s*"([^"]+)"/g],i=[/"description":\s*"([^"]+)"/g,/description:\s*"([^"]+)"/g,/Description:\s*"([^"]+)"/g,/"deskripsi":\s*"([^"]+)"/g];let r=[],o=[];s.forEach(c=>{const u=[...t.matchAll(c)];r.push(...u.map(d=>d[1]))}),i.forEach(c=>{const u=[...t.matchAll(c)];o.push(...u.map(d=>d[1]))}),console.log(`🔍 Found ${r.length} titles and ${o.length} descriptions`);const l=Math.max(r.length,o.length,1);for(let c=0;c<Math.min(l,5);c++){const u=r[c]||`Rekomendasi Bisnis ${c+1}`,d=o[c]||"Rekomendasi berdasarkan analisis AI untuk meningkatkan performa bisnis Anda.";n.push(Kt({userId:e,title:u.substring(0,100).replace(/[^\w\s-]/g,""),description:d.substring(0,500).replace(/[^\w\s.,!?-]/g,""),category:"growth_strategy",priority:"medium",estimatedTimeframe:"2-4 minggu",expectedImpact:"Dampak positif pada bisnis",reasoning:"Rekomendasi berdasarkan analisis AI",actionItems:[Xn({title:"Implementasi rekomendasi",description:"Terapkan rekomendasi ini sesuai dengan kondisi bisnis Anda",estimatedHours:8,deadline:null})],resources:[jt({title:"Panduan Implementasi",description:"Panduan umum untuk implementasi rekomendasi bisnis",type:"guide",url:"#"})]}))}return n.length===0&&n.push(Kt({userId:e,title:"Evaluasi dan Optimasi Bisnis",description:"Lakukan evaluasi menyeluruh terhadap operasional bisnis dan identifikasi area yang dapat dioptimalkan untuk meningkatkan efisiensi dan profitabilitas.",category:"growth_strategy",priority:"high",estimatedTimeframe:"2-4 minggu",expectedImpact:"Peningkatan efisiensi operasional dan profitabilitas",reasoning:"Rekomendasi fallback berdasarkan best practices bisnis",actionItems:[Xn({title:"Audit operasional",description:"Lakukan audit menyeluruh terhadap proses bisnis saat ini",estimatedHours:16,deadline:null})],resources:[jt({title:"Panduan Audit Bisnis",description:"Panduan lengkap untuk melakukan audit bisnis",type:"guide",url:"#"})]})),console.log(`✅ Manual extraction created ${n.length} recommendations`),n}catch(n){return console.error("❌ Manual extraction failed:",n),[Kt({userId:e,title:"Konsultasi Bisnis",description:"Konsultasikan strategi bisnis Anda dengan ahli untuk mendapatkan rekomendasi yang tepat.",category:"consultation",priority:"medium",estimatedTimeframe:"1-2 minggu",expectedImpact:"Mendapatkan insight profesional untuk bisnis",reasoning:"Fallback recommendation ketika AI parsing gagal",actionItems:[],resources:[]})]}},UD=t=>{try{return t.replace(/": "([^"]*)"([^"]*)"([^"]*)"/g,(e,n,s,i)=>`": "${n}\\"${s}\\"${i}"`)}catch{return t}},BD=t=>({recommendations:(t.match(/"title":\s*"([^"]+)"/g)||[]).map(i=>{const r=i.match(/"title":\s*"([^"]+)"/);return r?r[1]:"Rekomendasi Bisnis"}).slice(0,3).map(i=>({title:i,description:"Deskripsi detail akan tersedia setelah perbaikan sistem AI.",category:"growth_strategy",priority:"medium",actionItems:[{title:"Tindak lanjut diperlukan",description:"Detail akan diperbarui",estimatedHours:4,deadline:null}],resources:[{title:"Resource akan diperbarui",description:"Informasi akan tersedia segera",type:"article",url:"#"}],estimatedTimeframe:"1-2 minggu",expectedImpact:"Dampak positif pada pengembangan bisnis",reasoning:"Rekomendasi berdasarkan analisis AI (dalam perbaikan)"}))}),jD=(t,e)=>{var n,s;try{console.log("🔍 Raw AI response length:",t.length);let i=t.trim();i=i.replace(/```json\n?|\n?```/g,""),i=i.replace(/```\n?|\n?```/g,"");const r=i.indexOf("{");r>0&&(i=i.substring(r));const o=i.lastIndexOf("}");o>0&&o<i.length-1&&(i=i.substring(0,o+1)),i=i.replace(/,\s*}/g,"}").replace(/,\s*]/g,"]"),i=Jm(i),i=i.replace(/(\w+):/g,'"$1":').replace(/"\s*(\w+)\s*":/g,'"$1":'),console.log("🧹 Cleaned response preview:",i.substring(0,200)+"...");let l;try{l=JSON.parse(i)}catch(u){console.error("❌ JSON parse error:",u),console.log("🔍 Problematic JSON:",i.substring(Math.max(0,((n=u.message.match(/position (\d+)/))==null?void 0:n[1])-50||0),(((s=u.message.match(/position (\d+)/))==null?void 0:s[1])||0)+50)),console.log("🔄 Trying fallback strategies...");try{const d=UD(i);l=JSON.parse(d),console.log("✅ Recovered JSON using line-by-line quote fixing")}catch(d){console.log("❌ Line-by-line fixing failed:",d.message);try{const m=FD(i);l=JSON.parse(m),console.log("✅ Recovered JSON using aggressive cleaning")}catch(m){console.log("❌ Aggressive cleaning failed:",m.message);const g=i.match(/\{[\s\S]*\}/);if(g)try{const y=Jm(g[0]);l=JSON.parse(y),console.log("✅ Recovered JSON using regex extraction + quote fixing")}catch(y){console.log("❌ Regex extraction failed:",y.message);try{const A=Xm(t);l=JSON.parse(A),console.log("☢️ Nuclear JSON rebuild successful")}catch(A){console.log("☢️ Nuclear rebuild failed:",A.message);try{l=BD(i),console.log("✅ Created minimal valid response from fragments")}catch{return console.log("❌ All JSON strategies failed, trying manual extraction"),Zm(t,e)}}}else{console.log("❌ No JSON structure found, trying nuclear rebuild");try{const y=Xm(t);l=JSON.parse(y),console.log("☢️ Nuclear JSON rebuild successful (no structure)")}catch{return console.log("❌ All strategies exhausted, trying manual extraction"),Zm(t,e)}}}}}const c=[];if(l.recommendations&&Array.isArray(l.recommendations))console.log(`📋 Processing ${l.recommendations.length} recommendations`),l.recommendations.forEach((u,d)=>{var m,g,y,A;try{const F=((m=u.progressSteps)==null?void 0:m.map((V,R)=>{var P,H;return so({title:V.title||`Langkah ${R+1}`,description:V.description||"Deskripsi langkah",order:V.order||R,isRequired:V.isRequired!==!1,estimatedDuration:V.estimatedDuration||"1-2 hari",resources:((P=V.resources)==null?void 0:P.map(k=>jt({title:k.title||"Resource",description:k.description||"Deskripsi resource",type:k.type||"article",url:k.url||"#"})))||[],tips:V.tips||[],checkpoints:((H=V.checkpoints)==null?void 0:H.map((k,b)=>hn({title:k.title||`Checkpoint ${b+1}`,description:k.description||"Deskripsi checkpoint",order:k.order||b})))||[]})}))||[],N=((g=u.milestones)==null?void 0:g.map((V,R)=>Vd({title:V.title||`Milestone ${R+1}`,description:V.description||"Deskripsi milestone",targetDate:V.targetDate||null,reward:V.reward||"Pencapaian penting",icon:V.icon||"🎯",requiredSteps:V.requiredSteps||[]})))||[],x=Kt({userId:e,title:u.title||`Rekomendasi ${d+1}`,description:u.description||"Deskripsi tidak tersedia",category:u.category||"growth_strategy",priority:u.priority||"medium",businessStage:u.businessStage||"growth",estimatedTimeframe:u.estimatedTimeframe||"2-4 minggu",expectedImpact:u.expectedImpact||"Dampak positif pada bisnis",reasoning:u.reasoning||"Rekomendasi berdasarkan analisis AI",estimatedCost:u.estimatedCost||"Biaya akan ditentukan",difficultyLevel:u.difficultyLevel||"medium",tags:u.tags||[],progressSteps:F,totalSteps:F.length,milestones:N,actionItems:((y=u.actionItems)==null?void 0:y.map(V=>Xn({title:V.title||"Aksi diperlukan",description:V.description||"Detail akan ditentukan",estimatedHours:V.estimatedHours||4,deadline:V.deadline||null})))||[],resources:((A=u.resources)==null?void 0:A.map(V=>jt({title:V.title||"Resource",description:V.description||"Deskripsi resource",type:V.type||"article",url:V.url||"#"})))||[]});c.push(x)}catch(F){console.warn(`⚠️ Error processing recommendation ${d+1}:`,F)}});else throw console.warn("⚠️ No recommendations array found in parsed response"),new Error("Invalid response format: missing recommendations array");return console.log(`✅ Successfully parsed ${c.length} recommendations`),c}catch(i){throw console.error("❌ Error parsing AI response:",i),console.log("🔍 Response preview:",t.substring(0,500)),new Error(`Failed to parse AI response: ${i.message}`)}},HD=(t,e)=>{console.log("🔍 Parsing Enhanced AI response...");try{let n=t.trim();n=n.replace(/```json\s*/g,"").replace(/```\s*$/g,"");const s=n.indexOf("{"),i=n.lastIndexOf("}")+1;if(s===-1||i===0)throw new Error("No JSON structure found in AI response");n=n.substring(s,i);let r;try{r=JSON.parse(n)}catch{console.log("❌ Initial JSON parse failed, attempting recovery...");let c=n.replace(/,(\s*[}\]])/g,"$1").replace(/([{,]\s*)(\w+):/g,'$1"$2":').replace(/:\s*'([^']*)'/g,': "$1"').replace(/\\n/g,"\\\\n").replace(/\n/g," ").replace(/\t/g," ").replace(/\s+/g," ");try{r=JSON.parse(c),console.log("✅ JSON recovery successful")}catch(u){throw console.error("❌ JSON recovery failed:",u.message),new Error(`Failed to parse AI response as JSON: ${u.message}`)}}if(!r||typeof r!="object")throw new Error("Invalid response: not an object");if(!r.recommendations||!Array.isArray(r.recommendations))throw new Error("Invalid response: missing or invalid recommendations array");if(r.recommendations.length===0)throw new Error("No recommendations found in response");console.log(`📋 Processing ${r.recommendations.length} enhanced recommendations`);const o=[];if(r.recommendations.forEach((l,c)=>{var u,d,m,g;try{if(!l.title||!l.description){console.warn(`⚠️ Skipping recommendation ${c+1}: missing title or description`);return}const y=((u=l.progressSteps)==null?void 0:u.map((N,x)=>{var V,R;return N.title||console.warn(`⚠️ Step ${x+1} missing title, using default`),so({title:N.title||`Langkah ${x+1}`,description:N.description||"Deskripsi langkah akan ditentukan",order:N.order||x,isRequired:N.isRequired!==!1,estimatedDuration:N.estimatedDuration||"1-2 hari",resources:((V=N.resources)==null?void 0:V.map(D=>jt({title:D.title||"Resource",description:D.description||"Deskripsi resource",type:D.type||"article",url:D.url||"#"})))||[],tips:Array.isArray(N.tips)?N.tips:[],checkpoints:((R=N.checkpoints)==null?void 0:R.map((D,P)=>hn({title:D.title||`Checkpoint ${P+1}`,description:D.description||"Deskripsi checkpoint",order:D.order||P})))||[]})}))||[],A=((d=l.milestones)==null?void 0:d.map((N,x)=>Vd({title:N.title||`Milestone ${x+1}`,description:N.description||"Deskripsi milestone",targetDate:N.targetDate||null,reward:N.reward||"Pencapaian penting",icon:N.icon||"🎯",requiredSteps:Array.isArray(N.requiredSteps)?N.requiredSteps:[]})))||[],F=Kt({userId:e,title:l.title,description:l.description,category:l.category||"growth_strategy",priority:l.priority||"medium",businessStage:l.businessStage||"growth",estimatedTimeframe:l.estimatedTimeframe||"2-4 minggu",expectedImpact:l.expectedImpact||"Dampak positif pada bisnis",reasoning:l.reasoning||"Rekomendasi berdasarkan analisis AI",estimatedCost:l.estimatedCost||"Biaya akan ditentukan",difficultyLevel:l.difficultyLevel||"medium",tags:Array.isArray(l.tags)?l.tags:[],progressSteps:y,totalSteps:y.length,milestones:A,actionItems:((m=l.actionItems)==null?void 0:m.map(N=>Xn({title:N.title||"Aksi diperlukan",description:N.description||"Detail akan ditentukan",estimatedHours:N.estimatedHours||4,deadline:N.deadline||null})))||[],resources:((g=l.resources)==null?void 0:g.map(N=>jt({title:N.title||"Resource",description:N.description||"Deskripsi resource",type:N.type||"article",url:N.url||"#"})))||[]});o.push(F),console.log(`✅ Processed enhanced recommendation ${c+1}: ${F.title}`)}catch(y){console.error(`❌ Error processing recommendation ${c+1}:`,y)}}),o.length===0)throw new Error("No valid recommendations could be processed");return console.log(`✅ Successfully parsed ${o.length} enhanced recommendations`),o}catch(n){throw console.error("❌ Error parsing enhanced AI response:",n),console.log("🔍 Response preview:",t.substring(0,500)),new Error(`Failed to parse enhanced AI response: ${n.message}`)}},qD=t=>[Kt({userId:t,title:"Validasi Model Bisnis",description:"Pastikan produk/layanan Anda memenuhi kebutuhan pasar yang nyata melalui riset mendalam dan validasi langsung dengan calon pelanggan. Ini adalah langkah kritis untuk mengurangi risiko kegagalan bisnis.",category:Ft.GROWTH_STRATEGY,priority:bn.CRITICAL,businessStage:"existence",estimatedTimeframe:"2-4 minggu",expectedImpact:"Mengurangi risiko kegagalan bisnis hingga 60% dan meningkatkan peluang sukses jangka panjang",reasoning:"Pada tahap keberadaan, validasi pasar adalah kunci untuk memastikan bisnis dapat bertahan dan berkembang",progressSteps:[so({title:"Persiapan Riset Pasar",description:"Siapkan framework dan tools untuk melakukan riset pasar yang efektif",order:0,isRequired:!0,estimatedDuration:"2-3 hari",resources:[jt({title:"Template Riset Pasar UMKM",description:"Template lengkap untuk riset pasar khusus UMKM Indonesia",type:"template",url:"#"}),jt({title:"Panduan Wawancara Pelanggan",description:"Teknik wawancara efektif untuk mendapatkan insight pelanggan",type:"guide",url:"#"})],tips:["Fokus pada masalah yang ingin dipecahkan, bukan solusi yang ingin dijual","Siapkan pertanyaan terbuka untuk mendapatkan insight mendalam","Dokumentasikan semua feedback dengan detail"],checkpoints:[hn({title:"Daftar pertanyaan riset sudah siap",description:"Minimal 15 pertanyaan terstruktur untuk wawancara",order:0}),hn({title:"Target responden sudah ditentukan",description:"Identifikasi 25-30 calon pelanggan untuk diwawancara",order:1}),hn({title:"Tools dokumentasi sudah disiapkan",description:"Aplikasi recording, form survey, atau spreadsheet tracking",order:2})]}),so({title:"Eksekusi Wawancara Pelanggan",description:"Lakukan wawancara mendalam dengan calon pelanggan untuk memvalidasi asumsi bisnis",order:1,isRequired:!0,estimatedDuration:"1-2 minggu",resources:[jt({title:"Script Wawancara Validasi",description:"Script percakapan untuk wawancara validasi bisnis",type:"template",url:"#"})],tips:["Lakukan wawancara tatap muka atau video call untuk hasil terbaik","Jangan leading questions - biarkan responden bercerita","Catat tidak hanya jawaban, tapi juga emosi dan reaksi"],checkpoints:[hn({title:"Wawancara dengan 10 responden pertama",description:"Selesaikan wawancara dengan 10 calon pelanggan",order:0}),hn({title:"Analisis pola feedback awal",description:"Identifikasi pola dan tema umum dari feedback",order:1}),hn({title:"Wawancara dengan 15 responden tambahan",description:"Lanjutkan wawancara untuk validasi pola yang ditemukan",order:2})]}),so({title:"Analisis dan Kesimpulan",description:"Analisis hasil riset dan buat keputusan strategis berdasarkan data",order:2,isRequired:!0,estimatedDuration:"3-5 hari",resources:[jt({title:"Template Analisis Riset",description:"Framework untuk menganalisis hasil riset pasar",type:"template",url:"#"})],tips:["Kategorikan feedback menjadi: masalah, solusi, harga, dan distribusi","Hitung persentase responden yang mengkonfirmasi setiap asumsi","Identifikasi red flags yang memerlukan pivot model bisnis"],checkpoints:[hn({title:"Data wawancara sudah dikompilasi",description:"Semua hasil wawancara terdokumentasi dengan rapi",order:0}),hn({title:"Analisis pola dan insight selesai",description:"Identifikasi insight kunci dan pola feedback",order:1}),hn({title:"Rekomendasi aksi sudah dibuat",description:"Buat rekomendasi konkret berdasarkan hasil riset",order:2})]})],milestones:[Vd({title:"Riset Pasar Selesai",description:"Menyelesaikan riset komprehensif dengan minimal 25 responden",targetDate:new Date(Date.now()+21*24*60*60*1e3).toISOString().split("T")[0],reward:"Pemahaman mendalam tentang kebutuhan pasar dan validasi model bisnis",icon:"🎯",requiredSteps:[0,1,2]})],actionItems:[Xn({title:"Survei Pelanggan Potensial",description:"Lakukan wawancara dengan 25-30 calon pelanggan untuk memvalidasi kebutuhan",estimatedHours:20,deadline:new Date(Date.now()+14*24*60*60*1e3).toISOString()})],resources:[jt({title:"Template Survei Validasi Bisnis",description:"Template pertanyaan untuk validasi model bisnis",type:"template",url:"#"})]})],KD=t=>[Kt({userId:t,title:"Implementasi Sistem Keuangan Dasar",description:"Bangun sistem pencatatan keuangan yang akurat untuk kontrol kas yang lebih baik",category:Ft.FINANCIAL_MANAGEMENT,priority:bn.HIGH,estimatedTimeframe:"1-2 minggu",expectedImpact:"Meningkatkan kontrol keuangan dan membantu mencapai break-even",reasoning:"Sistem keuangan yang baik adalah fondasi untuk bertahan dan tumbuh",actionItems:[Xn({title:"Setup Aplikasi Keuangan",description:"Install dan konfigurasi aplikasi pencatatan keuangan sederhana",estimatedHours:4,deadline:new Date(Date.now()+7*24*60*60*1e3).toISOString()})]})],GD=t=>[Kt({userId:t,title:"Strategi Ekspansi Pasar",description:"Kembangkan rencana untuk memperluas jangkauan pasar atau diversifikasi produk",category:Ft.MARKETING_SALES,priority:bn.HIGH,estimatedTimeframe:"4-6 minggu",expectedImpact:"Meningkatkan pendapatan dan mengurangi risiko ketergantungan pada satu pasar",reasoning:"Pada tahap sukses, ekspansi adalah kunci untuk pertumbuhan berkelanjutan"})],zD=t=>[Kt({userId:t,title:"Pengembangan Struktur Organisasi",description:"Bangun struktur organisasi yang dapat mendukung pertumbuhan cepat",category:Ft.HUMAN_RESOURCES,priority:bn.CRITICAL,estimatedTimeframe:"6-8 minggu",expectedImpact:"Memungkinkan delegasi efektif dan skalabilitas operasional",reasoning:"Pertumbuhan cepat memerlukan struktur yang jelas untuk menghindari kekacauan"})],WD=t=>[Kt({userId:t,title:"Program Inovasi Berkelanjutan",description:"Implementasikan sistem untuk mendorong inovasi dan adaptasi pasar",category:Ft.GROWTH_STRATEGY,priority:bn.MEDIUM,estimatedTimeframe:"8-12 minggu",expectedImpact:"Mempertahankan daya saing dan relevansi di pasar",reasoning:"Bisnis matang perlu terus berinovasi untuk menghindari stagnasi"})],QD=t=>[Kt({userId:t,title:"Analisis Kompetitor",description:"Lakukan analisis mendalam terhadap pesaing untuk mengidentifikasi peluang",category:Ft.MARKETING_SALES,priority:bn.MEDIUM,estimatedTimeframe:"2-3 minggu",expectedImpact:"Memahami posisi kompetitif dan mengidentifikasi peluang diferensiasi",reasoning:"Pemahaman kompetitor penting untuk semua tahap bisnis"})],YD=t=>[Kt({userId:t,title:"Pelatihan Literasi Keuangan UMKM",description:"Ikuti program pelatihan untuk meningkatkan pemahaman keuangan bisnis",category:Ft.FINANCIAL_LITERACY,priority:bn.HIGH,estimatedTimeframe:"4-6 minggu",expectedImpact:"Meningkatkan kemampuan pengambilan keputusan keuangan yang lebih baik",reasoning:"Literasi keuangan adalah fondasi untuk semua keputusan bisnis yang sehat",resources:[jt({title:"Modul Literasi Keuangan OJK",description:"Materi pembelajaran literasi keuangan dari Otoritas Jasa Keuangan",type:"course",url:"https://sikapiuangmu.ojk.go.id"})]})],Av=async(t="warung")=>{var e,n;console.log(`🧪 Testing AI integration with ${t} profile...`);try{const{TEST_BUSINESS_PROFILES:s,TEST_DIAGNOSIS_DATA:i}=await Gi(async()=>{const{TEST_BUSINESS_PROFILES:d,TEST_DIAGNOSIS_DATA:m}=await import("./aiTesting-D6m1enCA.js");return{TEST_BUSINESS_PROFILES:d,TEST_DIAGNOSIS_DATA:m}},[]),r=s[t],o=i[t];if(!r||!o)throw new Error(`Test profile '${t}' not found`);console.log("📋 Test Profile:",r),console.log("🔍 Test Diagnosis:",o);const l=performance.now(),c=await Ld(r,o),u=performance.now();if(console.log(`✅ AI Test completed in ${Math.round(u-l)}ms`),console.log(`📊 Generated ${c.length} recommendations`),c.length>0){const d=c[0];console.log("🎯 Sample Recommendation:",{title:d.title,category:d.category,priority:d.priority,hasProgressSteps:!!(d.progressSteps&&d.progressSteps.length>0),hasMilestones:!!(d.milestones&&d.milestones.length>0),stepCount:((e=d.progressSteps)==null?void 0:e.length)||0,milestoneCount:((n=d.milestones)==null?void 0:n.length)||0})}return{success:!0,duration:u-l,recommendationCount:c.length,recommendations:c,profile:r,diagnosis:o}}catch(s){return console.error("❌ AI Test failed:",s),{success:!1,error:s.message,profile:null,diagnosis:null}}},JD=()=>(console.log("🚀 Starting Quick AI Test..."),console.log("Available test profiles: warung, fashion, tech, craft"),console.log('Usage: testAIIntegration("warung")'),Av("warung"));typeof window<"u"&&(window.testAIIntegration=Av,window.quickAITest=JD,window.generateAIRecommendations=Ld,console.log("🧪 AI Testing functions available:"),console.log("- testAIIntegration(profileType)"),console.log("- quickAITest()"),console.log("- generateAIRecommendations(profile, diagnosis)"));function $d(t,e,n={}){let s,i,r,o,l,c=0,u=!1,d=!1,m=!0;typeof n=="object"&&(u=!!n.leading,d="maxWait"in n,m="trailing"in n?!!n.trailing:m);const g=d?Math.max(+n.maxWait||0,e):0;function y(k){const b=s,E=i;return s=i=void 0,c=k,r=t.apply(E,b),r}function A(k){return c=k,o=setTimeout(x,e),u?y(k):r}function F(k){const b=k-l,E=k-c,S=e-b;return d?Math.min(S,g-E):S}function N(k){const b=k-l,E=k-c;return l===void 0||b>=e||b<0||d&&E>=g}function x(){const k=Date.now();if(N(k))return V(k);o=setTimeout(x,F(k))}function V(k){return o=void 0,m&&s?y(k):(s=i=void 0,r)}function R(){o!==void 0&&clearTimeout(o),c=0,s=l=i=o=void 0}function D(){return o===void 0?r:V(Date.now())}function P(){return o!==void 0}function H(...k){const b=Date.now(),E=N(b);if(s=k,i=this,l=b,E){if(o===void 0)return A(l);if(d)return clearTimeout(o),o=setTimeout(x,e),y(l)}return o===void 0&&(o=setTimeout(x,e)),r}return H.cancel=R,H.flush=D,H.pending=P,H}function XD(t,e,n={}){let s=!0,i=!0;return typeof n=="object"&&(s="leading"in n?!!n.leading:s,i="trailing"in n?!!n.trailing:i),$d(t,e,{leading:s,trailing:i,maxWait:e})}function ZD(t,e){let n;return function(...i){clearTimeout(n),n=setTimeout(()=>t.apply(this,i),e)}}function eO(t,e,n=!1){let s;return function(...r){const o=n&&!s;clearTimeout(s),s=setTimeout(()=>{s=null,n||t.apply(this,r)},e),o&&t.apply(this,r)}}typeof window<"u"&&(window.debounceUtils={debounce:$d,throttle:XD,simpleDebounce:ZD,debounceImmediate:eO},console.log("🔧 Debounce utilities available: window.debounceUtils"));const Hl=xu("recommendation",{state:()=>({recommendations:[],businessProfile:null,isSaving:!1,lastSaveAttempt:null,saveQueue:new Set,loading:!1,error:null,generatingRecommendations:!1,loadingState:{isLoading:!1,phase:"idle",progress:0,currentStep:0,message:"",steps:["Memuat data diagnosis","Menganalisis profil bisnis","Menghasilkan rekomendasi AI","Menyimpan hasil"]},filters:{category:"all",priority:"all",completed:"all",bookmarked:"all"},sortBy:"priority",bookmarkCollections:[{id:"default",name:"Favorit Saya",description:"Rekomendasi yang disimpan",icon:"⭐",color:"#fbbf24",createdAt:new Date().toISOString()},{id:"priority",name:"Prioritas Tinggi",description:"Rekomendasi yang harus segera dilakukan",icon:"🚨",color:"#ef4444",createdAt:new Date().toISOString()},{id:"later",name:"Untuk Nanti",description:"Rekomendasi untuk implementasi masa depan",icon:"📅",color:"#3b82f6",createdAt:new Date().toISOString()}],preferences:{autoGenerateRecommendations:!0,notificationsEnabled:!0,emailUpdates:!1},analytics:{totalRecommendations:0,completedRecommendations:0,bookmarkedRecommendations:0,lastGeneratedAt:null,averageCompletionTime:0}}),getters:{filteredRecommendations:t=>{console.log("🔍 DEBUG: filteredRecommendations getter called"),console.log("🔍 DEBUG: state.recommendations:",t.recommendations),console.log("🔍 DEBUG: state.recommendations.length:",t.recommendations.length),console.log("🔍 DEBUG: Current filters:",t.filters);let e=[...t.recommendations];if(console.log("🔍 DEBUG: Initial filtered array:",e),t.filters.category!=="all"&&(console.log("🔍 DEBUG: Filtering by category:",t.filters.category),e=e.filter(n=>n.category===t.filters.category),console.log("🔍 DEBUG: After category filter:",e.length)),t.filters.priority!=="all"&&(console.log("🔍 DEBUG: Filtering by priority:",t.filters.priority),e=e.filter(n=>n.priority===t.filters.priority),console.log("🔍 DEBUG: After priority filter:",e.length)),t.filters.completed!=="all"){console.log("🔍 DEBUG: Filtering by completion:",t.filters.completed);const n=t.filters.completed==="completed";e=e.filter(s=>s.isCompleted===n),console.log("🔍 DEBUG: After completion filter:",e.length)}return t.filters.bookmarked!=="all"&&(console.log("🔍 DEBUG: Filtering by bookmark:",t.filters.bookmarked),t.filters.bookmarked==="bookmarked"?e=e.filter(n=>n.isBookmarked):t.filters.bookmarked==="not_bookmarked"&&(e=e.filter(n=>!n.isBookmarked)),console.log("🔍 DEBUG: After bookmark filter:",e.length)),e.sort((n,s)=>{switch(t.sortBy){case"priority":const i={critical:4,high:3,medium:2,low:1};return i[s.priority]-i[n.priority];case"date":return new Date(s.createdAt)-new Date(n.createdAt);case"category":return n.category.localeCompare(s.category);default:return 0}}),console.log("🔍 DEBUG: Final filtered recommendations:",e),console.log("🔍 DEBUG: Final filtered length:",e.length),e},bookmarkedRecommendations:t=>t.recommendations.filter(e=>e.isBookmarked),recommendationsByCollection:t=>{const e={};return t.bookmarkCollections.forEach(n=>{e[n.id]={...n,recommendations:t.recommendations.filter(s=>s.isBookmarked&&s.bookmarkCollection===n.id)}}),e},bookmarkStats:t=>{const e=t.recommendations.filter(s=>s.isBookmarked),n={};return t.bookmarkCollections.forEach(s=>{n[s.id]=e.filter(i=>i.bookmarkCollection===s.id).length}),{total:e.length,byCollection:n,recentlyBookmarked:e.filter(s=>s.bookmarkedAt).sort((s,i)=>new Date(i.bookmarkedAt)-new Date(s.bookmarkedAt)).slice(0,5)}},criticalRecommendations:t=>t.recommendations.filter(e=>e.priority===bn.CRITICAL&&!e.isCompleted),highPriorityRecommendations:t=>t.recommendations.filter(e=>e.priority===bn.HIGH&&!e.isCompleted),bookmarkedRecommendations:t=>t.recommendations.filter(e=>e.isBookmarked),completedRecommendations:t=>t.recommendations.filter(e=>e.isCompleted),progressStats:t=>{const e=t.recommendations.length,n=t.recommendations.filter(i=>i.isCompleted).length,s=t.recommendations.filter(i=>{var r;return!i.isCompleted&&((r=i.actionItems)==null?void 0:r.some(o=>o.isCompleted))}).length;return{total:e,completed:n,inProgress:s,pending:e-n-s,completionRate:e>0?Math.round(n/e*100):0}},nextActions:t=>{const e=[];return t.recommendations.filter(n=>!n.isCompleted).forEach(n=>{var s;(s=n.actionItems)==null||s.forEach(i=>{i.isCompleted||e.push({...i,recommendationId:n.id,recommendationTitle:n.title,priority:n.priority})})}),e.sort((n,s)=>{const i={critical:4,high:3,medium:2,low:1},r=i[s.priority]-i[n.priority];return r!==0?r:n.deadline&&s.deadline?new Date(n.deadline)-new Date(s.deadline):0}),e.slice(0,5)}},actions:{setLoadingState(t,e=0,n=""){this.loadingState.isLoading=t!=="idle"&&t!=="complete",this.loadingState.phase=t,this.loadingState.progress=e,this.loadingState.message=n;const s={loading:0,analyzing:1,generating:2,saving:3,complete:4};this.loadingState.currentStep=s[t]||0,console.log(`🔄 Loading state: ${t} (${e}%) - ${n}`)},async generateRecommendations(t,e){console.log("🔍 DEBUG: Store generateRecommendations called"),console.log("🔍 DEBUG: businessProfile:",t),console.log("🔍 DEBUG: diagnosisData:",e),this.setLoadingState("loading",0,"Memulai proses generasi rekomendasi..."),this.generatingRecommendations=!0,this.error=null;try{console.log("🚀 Generating recommendations for user:",t.userId),this.setLoadingState("loading",10,"Memuat data diagnosis..."),await new Promise(s=>setTimeout(s,500)),this.businessProfile=t,this.setLoadingState("analyzing",30,"Menganalisis profil bisnis Anda..."),await new Promise(s=>setTimeout(s,800)),this.setLoadingState("generating",50,"Menghasilkan rekomendasi terpersonalisasi..."),console.log("🔍 DEBUG: Calling generateAIRecommendations service...");const n=await Ld(t,e);return console.log("🔍 DEBUG: Service returned recommendations:",n),this.setLoadingState("generating",80,"Memproses hasil rekomendasi..."),console.log("🔍 DEBUG: Recommendations received from service:",n),console.log("🔍 DEBUG: First recommendation structure:",n[0]),console.log("🔍 DEBUG: Recommendations length:",n.length),this.recommendations=n,console.log("🔍 DEBUG: Recommendations stored in state:",this.recommendations),console.log("🔍 DEBUG: State recommendations length:",this.recommendations.length),this.setLoadingState("saving",90,"Menyimpan rekomendasi..."),this.analytics.totalRecommendations=n.length,this.analytics.lastGeneratedAt=new Date().toISOString(),await this.safeSaveRecommendations(t.userId),this.setLoadingState("complete",100,"Rekomendasi berhasil dibuat!"),await new Promise(s=>setTimeout(s,500)),this.setLoadingState("idle",0,""),console.log(`✅ Generated ${n.length} recommendations successfully`),n}catch(n){throw console.error("❌ Error generating recommendations:",n),this.error="Gagal menghasilkan rekomendasi. Silakan coba lagi.",this.setLoadingState("idle",0,""),n}finally{this.generatingRecommendations=!1}},async loadRecommendations(t){this.loading=!0,this.error=null;try{console.log("📥 Loading recommendations for user:",t);const e=await Ev(t);e!=null&&e.recommendations?(this.recommendations=e.recommendations,this.businessProfile=e.businessProfile,this.analytics=e.analytics||this.analytics,console.log(`✅ Loaded ${this.recommendations.length} recommendations`)):(console.log("ℹ️ No recommendations found for user"),this.recommendations=[])}catch(e){console.error("❌ Error loading recommendations:",e),this.error="Gagal memuat rekomendasi."}finally{this.loading=!1}},async saveRecommendationsToFirestore(t){if(this.saveQueue.has(t)){console.log("🔄 Save already queued for user:",t);return}this.saveQueue.add(t),this.isSaving=!0,this.lastSaveAttempt=new Date().toISOString();try{console.log("💾 Saving recommendations to Firestore with enhanced method...");const e={recommendations:this.recommendations,businessProfile:this.businessProfile,analytics:this.analytics,recommendationsUpdatedAt:new Date().toISOString()};if(await j1(t,e))console.log("✅ Recommendations saved to Firestore successfully");else{console.warn("⚠️ Firestore save failed, recommendations saved locally only");try{console.log("🔄 Attempting fallback save method..."),await no(t,{businessProfile:this.businessProfile,analytics:this.analytics,recommendationCount:this.recommendations.length,lastSaveAttempt:new Date().toISOString()})&&console.log("✅ Fallback save successful (without full recommendation data)")}catch(s){console.warn("⚠️ Fallback save also failed:",s.message)}}}catch(e){console.warn("⚠️ Firestore save error:",e.message),e.message.includes("INTERNAL ASSERTION FAILED")&&(console.log("🔧 Internal assertion error detected, implementing recovery..."),setTimeout(async()=>{try{await no(t,{recommendationCount:this.recommendations.length,lastUpdateAttempt:new Date().toISOString(),errorRecoveryAttempt:!0}),console.log("✅ Recovery save attempt completed")}catch(n){console.warn("⚠️ Recovery save failed:",n.message)}},2e3))}finally{this.saveQueue.delete(t),this.isSaving=!1}},debouncedSave:null,initializeDebouncedSave(){this.debouncedSave||(this.debouncedSave=$d(async t=>{await this.saveRecommendationsToFirestore(t)},1e3))},async safeSaveRecommendations(t){if(!t){console.log("ℹ️ No user ID provided, skipping Firestore save");return}this.initializeDebouncedSave(),this.debouncedSave(t)},async completeRecommendation(t){var n;const e=this.recommendations.find(s=>s.id===t);e&&(e.isCompleted=!0,e.completedAt=new Date().toISOString(),this.analytics.completedRecommendations++,(n=this.businessProfile)!=null&&n.userId&&await this.safeSaveRecommendations(this.businessProfile.userId),console.log("✅ Recommendation marked as completed:",e.title))},async startRecommendation(t,e){var s;console.log("🚀 Starting recommendation:",t);const n=this.recommendations.find(i=>i.id===t);if(!n){console.error("❌ Recommendation not found:",t);return}Object.assign(n,{...e,status:"in_progress",startedAt:e.startedAt||new Date().toISOString(),progress:0,updatedAt:new Date().toISOString(),viewCount:(n.viewCount||0)+1,lastViewedAt:new Date().toISOString()}),n.completionHistory||(n.completionHistory=[]),n.completionHistory.push({action:"started",timestamp:new Date().toISOString(),notes:"Implementasi dimulai"}),(s=this.businessProfile)!=null&&s.userId&&await this.safeSaveRecommendations(this.businessProfile.userId),console.log("✅ Recommendation started successfully")},async updateRecommendationProgress(t,e){var s;console.log("📊 Updating recommendation progress:",t);const n=this.recommendations.find(i=>i.id===t);if(!n){console.error("❌ Recommendation not found:",t);return}Object.assign(n,{progress:e.progress,updatedAt:new Date().toISOString()}),n.completionHistory||(n.completionHistory=[]),n.completionHistory.push({action:"progress_updated",timestamp:new Date().toISOString(),progress:e.progress,notes:e.notes||`Progress diperbarui ke ${e.progress}%`}),(s=this.businessProfile)!=null&&s.userId&&await this.safeSaveRecommendations(this.businessProfile.userId),console.log("✅ Progress updated successfully")},async restartRecommendation(t,e){var s;console.log("🔄 Restarting recommendation:",t);const n=this.recommendations.find(i=>i.id===t);if(!n){console.error("❌ Recommendation not found:",t);return}Object.assign(n,{...e,status:"in_progress",isCompleted:!1,progress:0,startedAt:e.startedAt||new Date().toISOString(),completedAt:null,updatedAt:new Date().toISOString()}),n.completionHistory||(n.completionHistory=[]),n.completionHistory.push({action:"restarted",timestamp:new Date().toISOString(),notes:"Implementasi dimulai ulang"}),(s=this.businessProfile)!=null&&s.userId&&await this.safeSaveRecommendations(this.businessProfile.userId),console.log("✅ Recommendation restarted successfully")},async skipRecommendation(t,e){var s;console.log("⏭️ Skipping recommendation:",t);const n=this.recommendations.find(i=>i.id===t);if(!n){console.error("❌ Recommendation not found:",t);return}Object.assign(n,{...e,status:"skipped",updatedAt:new Date().toISOString()}),n.completionHistory||(n.completionHistory=[]),n.completionHistory.push({action:"skipped",timestamp:new Date().toISOString(),notes:"Rekomendasi dilewati"}),(s=this.businessProfile)!=null&&s.userId&&await this.safeSaveRecommendations(this.businessProfile.userId),console.log("✅ Recommendation skipped successfully")},async toggleBookmark(t,e="default"){var s;const n=this.recommendations.find(i=>i.id===t);n&&(n.isBookmarked,n.isBookmarked=!n.isBookmarked,n.isBookmarked?(n.bookmarkedAt=new Date().toISOString(),n.bookmarkCollection=e,n.completionHistory||(n.completionHistory=[]),n.completionHistory.push({action:"bookmarked",timestamp:new Date().toISOString(),collectionId:e,notes:`Disimpan ke koleksi: ${this.getCollectionName(e)}`})):(n.bookmarkedAt=null,n.bookmarkCollection=null,n.completionHistory||(n.completionHistory=[]),n.completionHistory.push({action:"unbookmarked",timestamp:new Date().toISOString(),notes:"Dihapus dari bookmark"})),n.isBookmarked?this.analytics.bookmarkedRecommendations++:this.analytics.bookmarkedRecommendations--,n.updatedAt=new Date().toISOString(),(s=this.businessProfile)!=null&&s.userId&&await this.safeSaveRecommendations(this.businessProfile.userId),console.log(`✅ Bookmark ${n.isBookmarked?"added":"removed"} for:`,n.title))},async addToBookmarkCollection(t,e){var s;const n=this.recommendations.find(i=>i.id===t);n&&(n.isBookmarked||(n.isBookmarked=!0,n.bookmarkedAt=new Date().toISOString(),this.analytics.bookmarkedRecommendations++),n.bookmarkCollection=e,n.updatedAt=new Date().toISOString(),n.completionHistory||(n.completionHistory=[]),n.completionHistory.push({action:"moved_to_collection",timestamp:new Date().toISOString(),collectionId:e,notes:`Dipindah ke koleksi: ${this.getCollectionName(e)}`}),(s=this.businessProfile)!=null&&s.userId&&await this.saveRecommendationsToFirestore(this.businessProfile.userId),console.log("✅ Recommendation moved to collection:",e))},async removeFromBookmarks(t){var n;const e=this.recommendations.find(s=>s.id===t);e&&e.isBookmarked&&(e.isBookmarked=!1,e.bookmarkedAt=null,e.bookmarkCollection=null,e.updatedAt=new Date().toISOString(),this.analytics.bookmarkedRecommendations--,e.completionHistory||(e.completionHistory=[]),e.completionHistory.push({action:"removed_from_bookmarks",timestamp:new Date().toISOString(),notes:"Dihapus dari semua bookmark"}),(n=this.businessProfile)!=null&&n.userId&&await this.saveRecommendationsToFirestore(this.businessProfile.userId),console.log("✅ Recommendation removed from bookmarks:",e.title))},createBookmarkCollection(t,e,n="📁",s="#6b7280"){const i={id:`collection_${Date.now()}`,name:t,description:e,icon:n,color:s,createdAt:new Date().toISOString()};return this.bookmarkCollections.push(i),console.log("✅ New bookmark collection created:",t),i},deleteBookmarkCollection(t){if(t==="default"){console.warn("⚠️ Cannot delete default collection");return}this.recommendations.forEach(e=>{e.bookmarkCollection===t&&(e.bookmarkCollection="default")}),this.bookmarkCollections=this.bookmarkCollections.filter(e=>e.id!==t),console.log("✅ Bookmark collection deleted:",t)},getCollectionName(t){const e=this.bookmarkCollections.find(n=>n.id===t);return e?e.name:"Favorit Saya"},async startProgressStep(t,e){var r;console.log("🚀 Starting progress step:",e);const n=this.recommendations.find(o=>o.id===t);if(!n||!n.progressSteps){console.error("❌ Recommendation or progress steps not found");return}const s=n.progressSteps.find(o=>o.id===e);if(!s){console.error("❌ Step not found:",e);return}s.status="in_progress",s.startedAt=new Date().toISOString(),s.updatedAt=new Date().toISOString();const i=n.progressSteps.findIndex(o=>o.id===e);n.currentStep=i,n.completionHistory||(n.completionHistory=[]),n.completionHistory.push({action:"step_started",timestamp:new Date().toISOString(),stepId:e,stepTitle:s.title,notes:`Langkah "${s.title}" dimulai`}),n.updatedAt=new Date().toISOString(),(r=this.businessProfile)!=null&&r.userId&&await this.safeSaveRecommendations(this.businessProfile.userId),console.log("✅ Progress step started successfully")},async completeProgressStep(t,e,n=""){var u;console.log("✅ Completing progress step:",e);const s=this.recommendations.find(d=>d.id===t);if(!s||!s.progressSteps){console.error("❌ Recommendation or progress steps not found");return}const i=s.progressSteps.find(d=>d.id===e);if(!i){console.error("❌ Step not found:",e);return}i.status="completed",i.completedAt=new Date().toISOString(),i.notes=n,i.updatedAt=new Date().toISOString();const r=s.progressSteps.filter(d=>d.status==="completed").length,o=s.progressSteps.length;s.progress=Math.round(r/o*100);const c=s.progressSteps.findIndex(d=>d.id===e)+1;c<s.progressSteps.length?s.currentStep=c:s.progress===100&&(s.status="completed",s.isCompleted=!0,s.completedAt=new Date().toISOString()),await this.checkMilestones(t),s.completionHistory||(s.completionHistory=[]),s.completionHistory.push({action:"step_completed",timestamp:new Date().toISOString(),stepId:e,stepTitle:i.title,notes:n||`Langkah "${i.title}" selesai`}),s.updatedAt=new Date().toISOString(),(u=this.businessProfile)!=null&&u.userId&&await this.saveRecommendationsToFirestore(this.businessProfile.userId),console.log("✅ Progress step completed successfully")},async skipProgressStep(t,e){var c;console.log("⏭️ Skipping progress step:",e);const n=this.recommendations.find(u=>u.id===t);if(!n||!n.progressSteps){console.error("❌ Recommendation or progress steps not found");return}const s=n.progressSteps.find(u=>u.id===e);if(!s){console.error("❌ Step not found:",e);return}if(s.isRequired){console.warn("⚠️ Cannot skip required step");return}s.status="skipped",s.updatedAt=new Date().toISOString();const r=n.progressSteps.findIndex(u=>u.id===e)+1;r<n.progressSteps.length&&(n.currentStep=r),n.progressSteps.filter(u=>u.status==="completed").length;const o=n.progressSteps.filter(u=>u.isRequired).length,l=n.progressSteps.filter(u=>u.status==="completed"&&u.isRequired).length;n.progress=Math.round(l/o*100),n.completionHistory||(n.completionHistory=[]),n.completionHistory.push({action:"step_skipped",timestamp:new Date().toISOString(),stepId:e,stepTitle:s.title,notes:`Langkah "${s.title}" dilewati`}),n.updatedAt=new Date().toISOString(),(c=this.businessProfile)!=null&&c.userId&&await this.saveRecommendationsToFirestore(this.businessProfile.userId),console.log("✅ Progress step skipped successfully")},async toggleStepCheckpoint(t,e,n){var c;console.log("📋 Toggling step checkpoint:",n);const s=this.recommendations.find(u=>u.id===t);if(!s||!s.progressSteps){console.error("❌ Recommendation or progress steps not found");return}const i=s.progressSteps.find(u=>u.id===e);if(!i||!i.checkpoints){console.error("❌ Step or checkpoints not found");return}const r=i.checkpoints.find(u=>u.id===n);if(!r){console.error("❌ Checkpoint not found:",n);return}r.isCompleted=!r.isCompleted,r.completedAt=r.isCompleted?new Date().toISOString():null;const o=i.checkpoints.filter(u=>u.isCompleted).length,l=i.checkpoints.length;i.checkpointProgress=Math.round(o/l*100),s.updatedAt=new Date().toISOString(),(c=this.businessProfile)!=null&&c.userId&&await this.saveRecommendationsToFirestore(this.businessProfile.userId),console.log("✅ Checkpoint toggled successfully")},async saveStepNotes(t,e,n){var r;console.log("📝 Saving step notes:",e);const s=this.recommendations.find(o=>o.id===t);if(!s||!s.progressSteps){console.error("❌ Recommendation or progress steps not found");return}const i=s.progressSteps.find(o=>o.id===e);if(!i){console.error("❌ Step not found:",e);return}i.notes=n,i.updatedAt=new Date().toISOString(),s.updatedAt=new Date().toISOString(),(r=this.businessProfile)!=null&&r.userId&&await this.saveRecommendationsToFirestore(this.businessProfile.userId),console.log("✅ Step notes saved successfully")},async checkMilestones(t){console.log("🎯 Checking milestones for:",t);const e=this.recommendations.find(n=>n.id===t);!e||!e.milestones||e.milestones.forEach(n=>{if(n.isCompleted)return;n.requiredSteps.every(i=>{const r=e.progressSteps.find(o=>o.id===i);return r&&r.status==="completed"})&&(n.isCompleted=!0,n.completedAt=new Date().toISOString(),e.completionHistory||(e.completionHistory=[]),e.completionHistory.push({action:"milestone_achieved",timestamp:new Date().toISOString(),milestoneId:n.id,milestoneTitle:n.title,notes:`Milestone "${n.title}" tercapai! ${n.reward}`}),console.log("🎉 Milestone achieved:",n.title))})},async completeActionItem(t,e){var s,i;const n=this.recommendations.find(r=>r.id===t);if(n){const r=(s=n.actionItems)==null?void 0:s.find(o=>o.id===e);r&&(r.isCompleted=!0,r.completedAt=new Date().toISOString(),n.actionItems.every(l=>l.isCompleted)&&!n.isCompleted&&await this.completeRecommendation(t),(i=this.businessProfile)!=null&&i.userId&&await this.saveRecommendationsToFirestore(this.businessProfile.userId),console.log("✅ Action item completed:",r.title))}},setFilter(t,e){this.filters[t]=e},setSortBy(t){this.sortBy=t},clearRecommendations(){this.recommendations=[],this.businessProfile=null,this.error=null,this.analytics={totalRecommendations:0,completedRecommendations:0,bookmarkedRecommendations:0,lastGeneratedAt:null,averageCompletionTime:0}},async refreshRecommendations(){this.businessProfile&&await this.generateRecommendations(this.businessProfile,{currentStage:this.businessProfile.businessStage,answers:{},strengths:[],weaknesses:[],opportunities:[]})}}}),tO={class:"completion-tracker"},nO={class:"status-section"},sO={class:"status-icon"},iO={class:"status-text"},rO={key:0,class:"progress-section"},oO={class:"progress-bar"},aO={class:"progress-text"},lO={class:"action-buttons"},cO={key:0,class:"completion-info"},uO={class:"completion-date"},dO={key:0,class:"user-rating"},hO={key:1,class:"completion-notes"},fO={class:"modal-header"},mO={class:"modal-body"},pO={class:"progress-input"},gO={for:"progress-slider"},_O={class:"notes-input"},yO={class:"modal-footer"},vO={class:"modal-header"},bO={class:"modal-body"},EO={class:"rating-section"},kO={class:"star-rating"},wO=["onClick"],IO={class:"difficulty-section"},SO={class:"difficulty-buttons"},TO=["onClick"],AO={class:"notes-input"},RO={class:"modal-footer"},CO={__name:"CompletionTracker",props:{recommendation:{type:Object,required:!0}},emits:["start","update-progress","complete","restart","skip"],setup(t,{emit:e}){const n=t,s=e,i=ge(!1),r=ge(!1),o=ge(n.recommendation.progress||0),l=ge(""),c=ge(0),u=ge(null),d=ge(""),m={1:"Sangat Mudah",2:"Mudah",3:"Sedang",4:"Sulit",5:"Sangat Sulit"},g=P=>({[Dt.PENDING]:"⏳",[Dt.IN_PROGRESS]:"🔄",[Dt.COMPLETED]:"✅",[Dt.SKIPPED]:"⏭️"})[P]||"⏳",y=P=>({[Dt.PENDING]:"Belum Dimulai",[Dt.IN_PROGRESS]:"Sedang Dikerjakan",[Dt.COMPLETED]:"Selesai",[Dt.SKIPPED]:"Dilewati"})[P]||"Belum Dimulai",A=P=>new Date(P).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),F=()=>{s("start",{id:n.recommendation.id,startedAt:new Date().toISOString(),status:Dt.IN_PROGRESS})},N=()=>{s("update-progress",{id:n.recommendation.id,progress:o.value,notes:l.value,updatedAt:new Date().toISOString()}),i.value=!1,l.value=""},x=()=>{s("complete",{id:n.recommendation.id,status:Dt.COMPLETED,progress:100,completedAt:new Date().toISOString(),userRating:c.value,implementationDifficulty:u.value,completionNotes:d.value,updatedAt:new Date().toISOString()}),r.value=!1,D()},V=()=>{s("restart",{id:n.recommendation.id,status:Dt.IN_PROGRESS,progress:0,startedAt:new Date().toISOString(),updatedAt:new Date().toISOString()})},R=()=>{s("skip",{id:n.recommendation.id,status:Dt.SKIPPED,updatedAt:new Date().toISOString()})},D=()=>{o.value=0,l.value="",c.value=0,u.value=null,d.value=""};return(P,H)=>(O(),M("div",tO,[f("div",nO,[f("div",{class:Se(["status-badge",`status-${t.recommendation.status}`])},[f("span",sO,j(g(t.recommendation.status)),1),f("span",iO,j(y(t.recommendation.status)),1)],2),t.recommendation.status==="in_progress"?(O(),M("div",rO,[f("div",oO,[f("div",{class:"progress-fill",style:fn({width:`${t.recommendation.progress}%`})},null,4)]),f("span",aO,j(t.recommendation.progress)+"% selesai",1)])):X("",!0)]),f("div",lO,[t.recommendation.status==="pending"?(O(),M("button",{key:0,onClick:F,class:"action-btn start-btn hover-lift"},H[13]||(H[13]=[f("span",{class:"btn-icon"},"🚀",-1),Be(" Mulai Implementasi ")]))):t.recommendation.status==="in_progress"?(O(),M("button",{key:1,onClick:H[0]||(H[0]=k=>i.value=!0),class:"action-btn progress-btn hover-lift"},H[14]||(H[14]=[f("span",{class:"btn-icon"},"📊",-1),Be(" Update Progress ")]))):X("",!0),t.recommendation.status==="in_progress"?(O(),M("button",{key:2,onClick:H[1]||(H[1]=k=>r.value=!0),class:"action-btn complete-btn hover-lift"},H[15]||(H[15]=[f("span",{class:"btn-icon"},"✅",-1),Be(" Tandai Selesai ")]))):t.recommendation.status==="completed"?(O(),M("button",{key:3,onClick:V,class:"action-btn restart-btn hover-lift"},H[16]||(H[16]=[f("span",{class:"btn-icon"},"🔄",-1),Be(" Implementasi Ulang ")]))):X("",!0),t.recommendation.status==="pending"||t.recommendation.status==="in_progress"?(O(),M("button",{key:4,onClick:R,class:"action-btn skip-btn hover-lift"},H[17]||(H[17]=[f("span",{class:"btn-icon"},"⏭️",-1),Be(" Lewati ")]))):X("",!0)]),t.recommendation.status==="completed"?(O(),M("div",cO,[f("div",uO,[H[18]||(H[18]=f("span",{class:"info-icon"},"📅",-1)),Be(" Selesai: "+j(A(t.recommendation.completedAt)),1)]),t.recommendation.userRating?(O(),M("div",dO,[H[19]||(H[19]=f("span",{class:"info-icon"},"⭐",-1)),Be(" Rating: "+j("★".repeat(t.recommendation.userRating))+j("☆".repeat(5-t.recommendation.userRating)),1)])):X("",!0),t.recommendation.completionNotes?(O(),M("div",hO,[H[20]||(H[20]=f("span",{class:"info-icon"},"📝",-1)),f("p",null,j(t.recommendation.completionNotes),1)])):X("",!0)])):X("",!0),i.value?(O(),M("div",{key:1,class:"modal-overlay",onClick:H[7]||(H[7]=k=>i.value=!1)},[f("div",{class:"modal-content",onClick:H[6]||(H[6]=ts(()=>{},["stop"]))},[f("div",fO,[H[21]||(H[21]=f("h3",null,"Update Progress",-1)),f("button",{onClick:H[2]||(H[2]=k=>i.value=!1),class:"close-btn"},"×")]),f("div",mO,[f("div",pO,[f("label",gO,"Progress: "+j(o.value)+"%",1),nt(f("input",{id:"progress-slider","onUpdate:modelValue":H[3]||(H[3]=k=>o.value=k),type:"range",min:"0",max:"100",step:"5",class:"progress-slider"},null,512),[[qt,o.value]])]),f("div",_O,[H[22]||(H[22]=f("label",{for:"progress-notes"},"Catatan Progress (opsional):",-1)),nt(f("textarea",{id:"progress-notes","onUpdate:modelValue":H[4]||(H[4]=k=>l.value=k),placeholder:"Apa yang sudah Anda lakukan?",class:"notes-textarea"},null,512),[[qt,l.value]])])]),f("div",yO,[f("button",{onClick:H[5]||(H[5]=k=>i.value=!1),class:"btn-secondary"},"Batal"),f("button",{onClick:N,class:"btn-primary"},"Simpan Progress")])])])):X("",!0),r.value?(O(),M("div",{key:2,class:"modal-overlay",onClick:H[12]||(H[12]=k=>r.value=!1)},[f("div",{class:"modal-content",onClick:H[11]||(H[11]=ts(()=>{},["stop"]))},[f("div",vO,[H[23]||(H[23]=f("h3",null,"🎉 Selamat! Tandai Sebagai Selesai",-1)),f("button",{onClick:H[8]||(H[8]=k=>r.value=!1),class:"close-btn"},"×")]),f("div",bO,[f("div",EO,[H[24]||(H[24]=f("label",null,"Seberapa bermanfaat rekomendasi ini?",-1)),f("div",kO,[(O(),M(Ae,null,ze(5,k=>f("button",{key:k,onClick:b=>c.value=k,class:Se(["star-btn",{active:k<=c.value}])},j(k<=c.value?"★":"☆"),11,wO)),64))])]),f("div",IO,[H[25]||(H[25]=f("label",null,"Seberapa sulit implementasinya?",-1)),f("div",SO,[(O(),M(Ae,null,ze(m,(k,b)=>f("button",{key:b,onClick:E=>u.value=parseInt(b),class:Se(["difficulty-btn",{active:u.value===parseInt(b)}])},j(k),11,TO)),64))])]),f("div",AO,[H[26]||(H[26]=f("label",{for:"completion-notes"},"Catatan dan Hasil (opsional):",-1)),nt(f("textarea",{id:"completion-notes","onUpdate:modelValue":H[9]||(H[9]=k=>d.value=k),placeholder:"Bagaimana hasilnya? Apa yang Anda pelajari?",class:"notes-textarea"},null,512),[[qt,d.value]])])]),f("div",RO,[f("button",{onClick:H[10]||(H[10]=k=>r.value=!1),class:"btn-secondary"},"Batal"),f("button",{onClick:x,class:"btn-primary"},"Tandai Selesai")])])])):X("",!0)]))}},PO=gt(CO,[["__scopeId","data-v-d5ddfc5a"]]),DO={class:"bookmark-manager"},OO={class:"bookmark-button-container"},NO={class:"bookmark-icon"},MO={class:"bookmark-text"},xO={class:"menu-header"},VO={class:"menu-content"},LO={key:0,class:"quick-actions"},$O={class:"collections-section"},FO={class:"collections-list"},UO=["onClick"],BO={class:"collection-info"},jO={class:"collection-details"},HO={class:"collection-name"},qO={class:"collection-count"},KO={class:"collection-status"},GO={key:0,class:"status-icon"},zO={class:"create-collection-section"},WO={key:1,class:"create-form"},QO={key:1,class:"remove-section"},YO={key:0,class:"bookmark-info"},JO={class:"bookmark-collection"},XO={class:"bookmark-date"},ZO={__name:"BookmarkManager",props:{recommendation:{type:Object,required:!0}},emits:["bookmark-toggled","collection-changed","bookmark-removed"],setup(t,{emit:e}){const n=t,s=e,i=Hl(),r=ge(!1),o=ge(!1),l=ge(""),c=ge("default"),u=Ie(()=>i.bookmarkCollections),d=Ie(()=>i.bookmarkStats),m=async R=>{await i.toggleBookmark(n.recommendation.id,R),s("bookmark-toggled",{recommendationId:n.recommendation.id,isBookmarked:!0,collectionId:R}),r.value=!1},g=async R=>{n.recommendation.isBookmarked?n.recommendation.bookmarkCollection===R?(await i.removeFromBookmarks(n.recommendation.id),s("bookmark-removed",{recommendationId:n.recommendation.id})):(await i.addToBookmarkCollection(n.recommendation.id,R),s("collection-changed",{recommendationId:n.recommendation.id,newCollectionId:R})):(await i.toggleBookmark(n.recommendation.id,R),s("bookmark-toggled",{recommendationId:n.recommendation.id,isBookmarked:!0,collectionId:R})),r.value=!1},y=async()=>{await i.removeFromBookmarks(n.recommendation.id),s("bookmark-removed",{recommendationId:n.recommendation.id}),r.value=!1},A=async()=>{if(l.value.trim()){const R=i.createBookmarkCollection(l.value.trim(),"Koleksi kustom");n.recommendation.isBookmarked?(await i.addToBookmarkCollection(n.recommendation.id,R.id),s("collection-changed",{recommendationId:n.recommendation.id,newCollectionId:R.id})):(await i.toggleBookmark(n.recommendation.id,R.id),s("bookmark-toggled",{recommendationId:n.recommendation.id,isBookmarked:!0,collectionId:R.id})),F(),r.value=!1}},F=()=>{o.value=!1,l.value=""},N=R=>d.value.byCollection[R]||0,x=R=>{const D=u.value.find(P=>P.id===R);return D?D.name:"Favorit Saya"},V=R=>{if(!R)return"";const D=new Date(R),H=Math.abs(new Date-D),k=Math.ceil(H/(1e3*60*60*24));return k===1?"Kemarin":k<7?`${k} hari lalu`:D.toLocaleDateString("id-ID",{day:"numeric",month:"short"})};return(R,D)=>(O(),M("div",DO,[f("div",OO,[f("button",{onClick:D[0]||(D[0]=P=>r.value=!r.value),class:Se(["bookmark-btn",{bookmarked:t.recommendation.isBookmarked,active:r.value}])},[f("span",NO,j(t.recommendation.isBookmarked?"🔖":"📌"),1),f("span",MO,j(t.recommendation.isBookmarked?"Tersimpan":"Simpan"),1),D[7]||(D[7]=f("span",{class:"dropdown-arrow"},"▼",-1))],2),r.value?(O(),M("div",{key:0,class:"bookmark-menu",onClick:D[5]||(D[5]=ts(()=>{},["stop"]))},[f("div",xO,[f("h4",null,j(t.recommendation.isBookmarked?"Kelola Bookmark":"Simpan ke Koleksi"),1),f("button",{onClick:D[1]||(D[1]=P=>r.value=!1),class:"close-btn"},"×")]),f("div",VO,[t.recommendation.isBookmarked?X("",!0):(O(),M("div",LO,[f("button",{onClick:D[2]||(D[2]=P=>m("default")),class:"quick-action-btn primary"},D[8]||(D[8]=[f("span",{class:"action-icon"},"⭐",-1),Be(" Simpan ke Favorit ")]))])),f("div",$O,[D[9]||(D[9]=f("h5",null,"Pilih Koleksi:",-1)),f("div",FO,[(O(!0),M(Ae,null,ze(u.value,P=>(O(),M("button",{key:P.id,onClick:H=>g(P.id),class:Se(["collection-item",{active:t.recommendation.bookmarkCollection===P.id,disabled:!t.recommendation.isBookmarked&&P.id!==c.value}])},[f("div",BO,[f("span",{class:"collection-icon",style:fn({color:P.color})},j(P.icon),5),f("div",jO,[f("span",HO,j(P.name),1),f("span",qO,j(N(P.id))+" item ",1)])]),f("div",KO,[t.recommendation.bookmarkCollection===P.id?(O(),M("span",GO,"✓")):X("",!0)])],10,UO))),128))])]),f("div",zO,[o.value?(O(),M("div",WO,[nt(f("input",{"onUpdate:modelValue":D[4]||(D[4]=P=>l.value=P),placeholder:"Nama koleksi...",class:"collection-name-input",onKeyup:Ag(A,["enter"])},null,544),[[qt,l.value]]),f("div",{class:"form-actions"},[f("button",{onClick:A,class:"btn-primary"},"Buat"),f("button",{onClick:F,class:"btn-secondary"},"Batal")])])):(O(),M("button",{key:0,onClick:D[3]||(D[3]=P=>o.value=!0),class:"create-collection-btn"},D[10]||(D[10]=[f("span",{class:"action-icon"},"➕",-1),Be(" Buat Koleksi Baru ")])))]),t.recommendation.isBookmarked?(O(),M("div",QO,[f("button",{onClick:y,class:"remove-btn"},D[11]||(D[11]=[f("span",{class:"action-icon"},"🗑️",-1),Be(" Hapus dari Bookmark ")]))])):X("",!0)])])):X("",!0)]),t.recommendation.isBookmarked?(O(),M("div",YO,[f("span",JO,j(x(t.recommendation.bookmarkCollection)),1),f("span",XO,j(V(t.recommendation.bookmarkedAt)),1)])):X("",!0),r.value?(O(),M("div",{key:1,class:"menu-overlay",onClick:D[6]||(D[6]=P=>r.value=!1)})):X("",!0)]))}},Rv=gt(ZO,[["__scopeId","data-v-4930512e"]]),eN={class:"progress-header"},tN={class:"progress-title"},nN={class:"progress-percentage"},sN={class:"overall-progress-bar"},iN={class:"progress-stats"},rN={class:"stat-item"},oN={key:0,class:"stat-item"},aN={key:1,class:"stat-item"},lN={key:0,class:"progress-steps"},cN={key:0,class:"step-connector"},uN={class:"step-icon"},dN={key:0,class:"status-icon completed"},hN={key:1,class:"status-icon skipped"},fN={key:2,class:"status-icon in-progress"},mN={key:3,class:"status-icon pending"},pN={class:"step-content"},gN={class:"step-header"},_N={class:"step-title"},yN={class:"step-meta"},vN={key:0,class:"duration"},bN={key:1,class:"required-badge"},EN={class:"step-description"},kN={class:"step-actions"},wN=["onClick"],IN=["onClick"],SN=["onClick"],TN=["onClick"],AN={key:0,class:"step-progress"},RN={class:"checkpoints"},CN=["checked","onChange"],PN={class:"checkpoint-label"},DN={key:1,class:"completion-info"},ON={class:"completion-date"},NN={key:0,class:"completion-notes"},MN={key:1,class:"milestones-section"},xN={class:"milestones"},VN={class:"milestone-icon"},LN={class:"milestone-content"},$N={class:"milestone-title"},FN={class:"milestone-description"},UN={class:"milestone-meta"},BN={key:0,class:"target-date"},jN={key:1,class:"reward"},HN={class:"milestone-status"},qN={key:0,class:"status-completed"},KN={key:1,class:"status-pending"},GN={key:2,class:"compact-steps"},zN={class:"step-indicators"},WN=["onClick"],QN={class:"current-step-info"},YN={class:"current-step-title"},JN={__name:"ProgressIndicator",props:{progressSteps:{type:Array,default:()=>[]},milestones:{type:Array,default:()=>[]},currentStepIndex:{type:Number,default:0},title:{type:String,default:""},compact:{type:Boolean,default:!1}},emits:["start-step","complete-step","skip-step","toggle-checkpoint","show-step-details"],setup(t,{emit:e}){const n=t,s=e,i=Ie(()=>n.progressSteps.length),r=Ie(()=>n.progressSteps.filter(x=>x.status==="completed").length),o=Ie(()=>i.value===0?0:r.value/i.value*100),l=Ie(()=>n.progressSteps[n.currentStepIndex]||null),c=Ie(()=>n.milestones.find(x=>!x.isCompleted)||null),u=Ie(()=>{const V=n.progressSteps.slice(n.currentStepIndex).length*2;return V<24?`~${V} jam`:`~${Math.ceil(V/8)} hari`}),d=x=>{s("start-step",x)},m=x=>{s("complete-step",x)},g=x=>{s("skip-step",x)},y=(x,V)=>{s("toggle-checkpoint",{stepId:x,checkpointId:V})},A=x=>{s("show-step-details",x)},F=x=>x?new Date(x).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"",N=x=>{if(!x.requiredSteps||x.requiredSteps.length===0)return 0;const V=x.requiredSteps.filter(R=>{const D=n.progressSteps.find(P=>P.id===R);return D&&D.status==="completed"}).length;return Math.round(V/x.requiredSteps.length*100)};return(x,V)=>(O(),M("div",{class:Se(["progress-indicator",{compact:t.compact}])},[f("div",eN,[f("div",tN,[f("h4",null,j(t.title||"Progress Implementasi"),1),f("span",nN,j(Math.round(o.value))+"%",1)]),f("div",sN,[f("div",{class:"progress-fill",style:fn({width:`${o.value}%`})},null,4)]),f("div",iN,[f("span",rN,[V[0]||(V[0]=f("span",{class:"stat-icon"},"✅",-1)),Be(" "+j(r.value)+"/"+j(i.value)+" Langkah ",1)]),u.value?(O(),M("span",oN,[V[1]||(V[1]=f("span",{class:"stat-icon"},"⏱️",-1)),Be(" "+j(u.value),1)])):X("",!0),c.value?(O(),M("span",aN,[V[2]||(V[2]=f("span",{class:"stat-icon"},"🎯",-1)),Be(" "+j(c.value.title),1)])):X("",!0)])]),t.compact?X("",!0):(O(),M("div",lN,[(O(!0),M(Ae,null,ze(t.progressSteps,(R,D)=>(O(),M("div",{key:R.id,class:Se(["progress-step",{completed:R.status==="completed","in-progress":R.status==="in_progress",current:D===t.currentStepIndex,skipped:R.status==="skipped"}])},[D>0?(O(),M("div",cN)):X("",!0),f("div",uN,[R.status==="completed"?(O(),M("span",dN,"✓")):R.status==="skipped"?(O(),M("span",hN,"⏭")):R.status==="in_progress"?(O(),M("span",fN,V[3]||(V[3]=[f("div",{class:"spinner"},null,-1)]))):(O(),M("span",mN,j(D+1),1))]),f("div",pN,[f("div",gN,[f("h5",_N,j(R.title),1),f("div",yN,[R.estimatedDuration?(O(),M("span",vN," ⏱️ "+j(R.estimatedDuration),1)):X("",!0),R.isRequired?(O(),M("span",bN,"Wajib")):X("",!0)])]),f("p",EN,j(R.description),1),f("div",kN,[R.status==="pending"&&D===t.currentStepIndex?(O(),M("button",{key:0,onClick:P=>d(R.id),class:"step-btn start-btn"}," 🚀 Mulai Langkah ",8,wN)):R.status==="in_progress"?(O(),M("button",{key:1,onClick:P=>m(R.id),class:"step-btn complete-btn"}," ✅ Tandai Selesai ",8,IN)):X("",!0),R.status==="in_progress"||R.status==="pending"&&D===t.currentStepIndex?(O(),M("button",{key:2,onClick:P=>A(R),class:"step-btn details-btn"}," 📋 Detail ",8,SN)):X("",!0),R.status==="pending"&&!R.isRequired&&D===t.currentStepIndex?(O(),M("button",{key:3,onClick:P=>g(R.id),class:"step-btn skip-btn"}," ⏭️ Lewati ",8,TN)):X("",!0)]),R.status==="in_progress"&&R.checkpoints?(O(),M("div",AN,[f("div",RN,[(O(!0),M(Ae,null,ze(R.checkpoints,P=>(O(),M("div",{key:P.id,class:Se(["checkpoint",{completed:P.isCompleted}])},[f("input",{type:"checkbox",checked:P.isCompleted,onChange:H=>y(R.id,P.id),class:"checkpoint-checkbox"},null,40,CN),f("label",PN,j(P.title),1)],2))),128))])])):X("",!0),R.status==="completed"?(O(),M("div",DN,[f("span",ON," ✅ Selesai: "+j(F(R.completedAt)),1),R.notes?(O(),M("p",NN,j(R.notes),1)):X("",!0)])):X("",!0)])],2))),128))])),t.milestones.length>0&&!t.compact?(O(),M("div",MN,[V[4]||(V[4]=f("h5",{class:"section-title"},"🎯 Milestone",-1)),f("div",xN,[(O(!0),M(Ae,null,ze(t.milestones,R=>(O(),M("div",{key:R.id,class:Se(["milestone",{completed:R.isCompleted}])},[f("div",VN,j(R.icon),1),f("div",LN,[f("h6",$N,j(R.title),1),f("p",FN,j(R.description),1),f("div",UN,[R.targetDate?(O(),M("span",BN," 📅 Target: "+j(F(R.targetDate)),1)):X("",!0),R.reward?(O(),M("span",jN," 🏆 "+j(R.reward),1)):X("",!0)])]),f("div",HN,[R.isCompleted?(O(),M("span",qN,"✓")):(O(),M("span",KN,j(N(R))+"%",1))])],2))),128))])])):X("",!0),t.compact?(O(),M("div",GN,[f("div",zN,[(O(!0),M(Ae,null,ze(t.progressSteps,(R,D)=>(O(),M("div",{key:R.id,class:Se(["step-dot",{completed:R.status==="completed",current:D===t.currentStepIndex,skipped:R.status==="skipped"}]),onClick:P=>A(R)},null,10,WN))),128))]),f("div",QN,[f("span",YN,j(l.value?l.value.title:"Semua langkah selesai"),1)])])):X("",!0)],2))}},XN=gt(JN,[["__scopeId","data-v-7d3b9a03"]]),ZN={class:"card-header"},eM={class:"header-left"},tM={class:"category-icon"},nM={class:"header-text"},sM={class:"recommendation-title"},iM={class:"category-label"},rM={class:"header-right"},oM=["aria-label"],aM={class:"card-content"},lM={class:"recommendation-description"},cM={key:0,class:"reasoning-section"},uM={class:"reasoning-text"},dM={key:1,class:"impact-section"},hM={class:"impact-text"},fM={key:2,class:"action-items-section"},mM={class:"action-items-list"},pM={class:"action-item-content"},gM={class:"action-item-header"},_M={class:"action-item-title"},yM={class:"action-item-meta"},vM={key:0,class:"estimated-time"},bM={key:1,class:"deadline"},EM={key:0,class:"action-item-description"},kM=["onClick"],wM={key:1,class:"completed-indicator"},IM={key:3,class:"resources-section"},SM={class:"resources-list"},TM=["href","target","rel"],AM={class:"resource-icon"},RM={class:"resource-content"},CM={class:"resource-title"},PM={key:0,class:"resource-description"},DM={class:"resource-type"},OM={key:0,class:"external-icon"},NM={class:"card-footer"},MM={class:"footer-left"},xM={key:0,class:"timeframe"},VM={class:"created-date"},LM={class:"footer-right"},$M={__name:"RecommendationCard",props:{recommendation:{type:Object,required:!0}},emits:["complete","toggle-bookmark","complete-action","start-recommendation","update-progress","restart-recommendation","skip-recommendation","start-step","complete-step","skip-step","toggle-checkpoint","show-step-details","save-step-notes"],setup(t,{emit:e}){const n=e,s=P=>({critical:"Kritis",high:"Tinggi",medium:"Sedang",low:"Rendah"})[P]||"Sedang",i=P=>({financial_management:"Manajemen Keuangan",marketing_sales:"Marketing & Penjualan",operations:"Operasional",human_resources:"Sumber Daya Manusia",technology:"Teknologi",legal_compliance:"Legal & Kepatuhan",growth_strategy:"Strategi Pertumbuhan",financial_literacy:"Literasi Keuangan"})[P]||"Umum",r=P=>({article:"📄",video:"🎥",tool:"🛠️",course:"🎓",template:"📋"})[P]||"📄",o=P=>({article:"Artikel",video:"Video",tool:"Alat",course:"Kursus",template:"Template"})[P]||"Artikel",l=P=>new Date(P).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),c=P=>{n("start-recommendation",P)},u=P=>{n("update-progress",P)},d=P=>{n("complete",P)},m=P=>{n("restart-recommendation",P)},g=P=>{n("skip-recommendation",P)},y=P=>{n("toggle-bookmark",P.recommendationId)},A=P=>{console.log("Collection changed:",P)},F=P=>{n("toggle-bookmark",P.recommendationId)},N=P=>{n("start-step",{recommendationId:props.recommendation.id,stepId:P})},x=P=>{n("complete-step",{recommendationId:props.recommendation.id,stepId:P.stepId||P,notes:P.notes||""})},V=P=>{n("skip-step",{recommendationId:props.recommendation.id,stepId:P})},R=P=>{n("toggle-checkpoint",{recommendationId:props.recommendation.id,stepId:P.stepId,checkpointId:P.checkpointId})},D=P=>{n("show-step-details",{recommendationId:props.recommendation.id,step:P})};return(P,H)=>(O(),M("div",{class:Se(["recommendation-card",[`priority-${t.recommendation.priority}`,{completed:t.recommendation.isCompleted}]])},[f("div",ZN,[f("div",eM,[f("div",tM,j(de(xD)(t.recommendation.category)),1),f("div",nM,[f("h3",sM,j(t.recommendation.title),1),f("span",iM,j(i(t.recommendation.category)),1)])]),f("div",rM,[f("span",{class:Se(["priority-badge",`priority-${t.recommendation.priority}`])},j(s(t.recommendation.priority)),3),f("button",{onClick:H[0]||(H[0]=k=>P.$emit("toggle-bookmark",t.recommendation.id)),class:Se(["bookmark-btn",{bookmarked:t.recommendation.isBookmarked}]),"aria-label":t.recommendation.isBookmarked?"Hapus bookmark":"Tambah bookmark"},j(t.recommendation.isBookmarked?"🔖":"📌"),11,oM)])]),f("div",aM,[f("p",lM,j(t.recommendation.description),1),t.recommendation.reasoning?(O(),M("div",cM,[H[1]||(H[1]=f("h4",{class:"reasoning-title"},"💡 Mengapa ini penting?",-1)),f("p",uM,j(t.recommendation.reasoning),1)])):X("",!0),t.recommendation.expectedImpact?(O(),M("div",dM,[H[2]||(H[2]=f("h4",{class:"impact-title"},"🎯 Dampak yang Diharapkan",-1)),f("p",hM,j(t.recommendation.expectedImpact),1)])):X("",!0),t.recommendation.actionItems&&t.recommendation.actionItems.length>0?(O(),M("div",fM,[H[3]||(H[3]=f("h4",{class:"action-items-title"},"📋 Langkah-langkah Aksi",-1)),f("div",mM,[(O(!0),M(Ae,null,ze(t.recommendation.actionItems,k=>(O(),M("div",{key:k.id,class:Se(["action-item",{completed:k.isCompleted}])},[f("div",pM,[f("div",gM,[f("h5",_M,j(k.title),1),f("div",yM,[k.estimatedHours?(O(),M("span",vM," ⏱️ "+j(k.estimatedHours)+"h ",1)):X("",!0),k.deadline?(O(),M("span",bM," 📅 "+j(l(k.deadline)),1)):X("",!0)])]),k.description?(O(),M("p",EM,j(k.description),1)):X("",!0)]),k.isCompleted?(O(),M("span",wM,"✅")):(O(),M("button",{key:0,onClick:b=>P.$emit("complete-action",t.recommendation.id,k.id),class:"complete-action-btn"}," ✅ ",8,kM))],2))),128))])])):X("",!0),t.recommendation.resources&&t.recommendation.resources.length>0?(O(),M("div",IM,[H[4]||(H[4]=f("h4",{class:"resources-title"},"📚 Sumber Daya",-1)),f("div",SM,[(O(!0),M(Ae,null,ze(t.recommendation.resources,k=>(O(),M("a",{key:k.id,href:k.url,target:k.isExternal?"_blank":"_self",rel:k.isExternal?"noopener noreferrer":"",class:"resource-item"},[f("div",AM,j(r(k.type)),1),f("div",RM,[f("h5",CM,j(k.title),1),k.description?(O(),M("p",PM,j(k.description),1)):X("",!0),f("span",DM,j(o(k.type)),1)]),k.isExternal?(O(),M("div",OM,"🔗")):X("",!0)],8,TM))),128))])])):X("",!0)]),t.recommendation.progressSteps&&t.recommendation.progressSteps.length>0?(O(),Wt(XN,{key:0,"progress-steps":t.recommendation.progressSteps,milestones:t.recommendation.milestones||[],"current-step-index":t.recommendation.currentStep||0,compact:!0,onStartStep:N,onCompleteStep:x,onSkipStep:V,onToggleCheckpoint:R,onShowStepDetails:D},null,8,["progress-steps","milestones","current-step-index"])):(O(),Wt(PO,{key:1,recommendation:t.recommendation,onStart:c,onUpdateProgress:u,onComplete:d,onRestart:m,onSkip:g},null,8,["recommendation"])),f("div",NM,[f("div",MM,[t.recommendation.estimatedTimeframe?(O(),M("span",xM," ⏰ "+j(t.recommendation.estimatedTimeframe),1)):X("",!0),f("span",VM," 📅 "+j(l(t.recommendation.createdAt)),1)]),f("div",LM,[xe(Rv,{recommendation:t.recommendation,onBookmarkToggled:y,onCollectionChanged:A,onBookmarkRemoved:F},null,8,["recommendation"])])])],2))}},FM=gt($M,[["__scopeId","data-v-cab794ae"]]),UM={key:0,class:"skeleton-card"},BM={key:1,class:"skeleton-list-item"},jM={key:2,class:"skeleton-text"},HM={key:4,class:"skeleton-stats"},qM={__name:"SkeletonLoader",props:{type:{type:String,default:"card",validator:t=>["card","list-item","text","button","stats"].includes(t)},animate:{type:Boolean,default:!0},lines:{type:Number,default:3},variant:{type:String,default:"primary"}},setup(t){const e=n=>{const s=["long","medium","short"];return s[(n-1)%s.length]};return(n,s)=>(O(),M("div",{class:Se(["skeleton-loader",{animate:t.animate}])},[t.type==="card"?(O(),M("div",UM,s[0]||(s[0]=[An('<div class="skeleton-header" data-v-cdc1b84e><div class="skeleton-icon" data-v-cdc1b84e></div><div class="skeleton-title-group" data-v-cdc1b84e><div class="skeleton-title" data-v-cdc1b84e></div><div class="skeleton-subtitle" data-v-cdc1b84e></div></div><div class="skeleton-badge" data-v-cdc1b84e></div></div><div class="skeleton-content" data-v-cdc1b84e><div class="skeleton-line long" data-v-cdc1b84e></div><div class="skeleton-line medium" data-v-cdc1b84e></div><div class="skeleton-line short" data-v-cdc1b84e></div></div><div class="skeleton-actions" data-v-cdc1b84e><div class="skeleton-button primary" data-v-cdc1b84e></div><div class="skeleton-button secondary" data-v-cdc1b84e></div></div>',3)]))):t.type==="list-item"?(O(),M("div",BM,s[1]||(s[1]=[An('<div class="skeleton-avatar" data-v-cdc1b84e></div><div class="skeleton-content" data-v-cdc1b84e><div class="skeleton-line medium" data-v-cdc1b84e></div><div class="skeleton-line short" data-v-cdc1b84e></div></div><div class="skeleton-action" data-v-cdc1b84e></div>',3)]))):t.type==="text"?(O(),M("div",jM,[(O(!0),M(Ae,null,ze(t.lines,i=>(O(),M("div",{key:i,class:Se(["skeleton-line",e(i)])},null,2))),128))])):t.type==="button"?(O(),M("div",{key:3,class:Se(["skeleton-button",t.variant])},null,2)):t.type==="stats"?(O(),M("div",HM,s[2]||(s[2]=[An('<div class="skeleton-stat-item" data-v-cdc1b84e><div class="skeleton-stat-number" data-v-cdc1b84e></div><div class="skeleton-stat-label" data-v-cdc1b84e></div></div><div class="skeleton-stat-item" data-v-cdc1b84e><div class="skeleton-stat-number" data-v-cdc1b84e></div><div class="skeleton-stat-label" data-v-cdc1b84e></div></div><div class="skeleton-stat-item" data-v-cdc1b84e><div class="skeleton-stat-number" data-v-cdc1b84e></div><div class="skeleton-stat-label" data-v-cdc1b84e></div></div>',3)]))):X("",!0)],2))}},pu=gt(qM,[["__scopeId","data-v-cdc1b84e"]]),KM={key:0,class:"loading-progress"},GM={class:"loading-content"},zM={class:"loading-title"},WM={class:"loading-message"},QM={key:0,class:"progress-bar"},YM={key:1,class:"loading-steps"},JM={class:"step-icon"},XM={key:0},ZM={key:1,class:"step-spinner"},ex={key:2},tx={class:"step-text"},nx={key:1,class:"loading-simple"},sx={class:"loading-message"},ix={key:2,class:"loading-dots"},rx={class:"loading-message"},ox={key:3,class:"loading-skeleton"},ax={__name:"LoadingState",props:{type:{type:String,default:"progress",validator:t=>["progress","simple","dots","skeleton"].includes(t)},title:{type:String,default:"Memuat..."},message:{type:String,default:"Mohon tunggu sebentar"},progress:{type:Number,default:0},showProgress:{type:Boolean,default:!1},steps:{type:Array,default:()=>[]},currentStep:{type:Number,default:0},fullscreen:{type:Boolean,default:!1},skeletonCount:{type:Number,default:3},skeletonType:{type:String,default:"card"}},setup(t){const e=t,n=["Menganalisis profil bisnis Anda...","Memproses data diagnosis...","Menghasilkan rekomendasi terpersonalisasi...","Menyiapkan saran pengembangan bisnis...","Hampir selesai..."],s=ge(0),i=ge(null);return Ie(()=>e.message||n[s.value]),En(()=>{e.type==="progress"&&!e.message&&(i.value=setInterval(()=>{s.value=(s.value+1)%n.length},2e3))}),So(()=>{i.value&&clearInterval(i.value)}),(r,o)=>(O(),M("div",{class:Se(["loading-state",{fullscreen:t.fullscreen}])},[t.type==="progress"?(O(),M("div",KM,[o[0]||(o[0]=f("div",{class:"loading-icon"},[f("div",{class:"spinner"})],-1)),f("div",GM,[f("h3",zM,j(t.title),1),f("p",WM,j(t.message),1),t.showProgress?(O(),M("div",QM,[f("div",{class:"progress-fill",style:fn({width:`${t.progress}%`})},null,4)])):X("",!0),t.steps.length>0?(O(),M("div",YM,[(O(!0),M(Ae,null,ze(t.steps,(l,c)=>(O(),M("div",{key:c,class:Se(["loading-step",{active:c===t.currentStep,completed:c<t.currentStep}])},[f("div",JM,[c<t.currentStep?(O(),M("span",XM,"✓")):c===t.currentStep?(O(),M("div",ZM)):(O(),M("span",ex,j(c+1),1))]),f("span",tx,j(l),1)],2))),128))])):X("",!0)])])):t.type==="simple"?(O(),M("div",nx,[o[1]||(o[1]=f("div",{class:"spinner"},null,-1)),f("p",sx,j(t.message),1)])):t.type==="dots"?(O(),M("div",ix,[o[2]||(o[2]=f("div",{class:"dots-container"},[f("div",{class:"dot"}),f("div",{class:"dot"}),f("div",{class:"dot"})],-1)),f("p",rx,j(t.message),1)])):t.type==="skeleton"?(O(),M("div",ox,[(O(!0),M(Ae,null,ze(t.skeletonCount,l=>(O(),Wt(pu,{key:l,type:t.skeletonType,animate:!0},null,8,["type"]))),128))])):X("",!0)],2))}},lx=gt(ax,[["__scopeId","data-v-61cc777d"]]),cx={__name:"StaggeredTransition",props:{name:{type:String,default:"stagger"},tag:{type:String,default:"div"},appear:{type:Boolean,default:!0},delay:{type:Number,default:100},duration:{type:Number,default:300},maxDelay:{type:Number,default:1e3}},setup(t){const e=t,n=Ie(()=>e.name),s=o=>{o.style.opacity="0",o.style.transform="translateY(20px)"},i=(o,l)=>{const c=Math.min(o.dataset.index*e.delay,e.maxDelay);setTimeout(()=>{o.style.transition=`all ${e.duration}ms cubic-bezier(0.25, 0.46, 0.45, 0.94)`,o.style.opacity="1",o.style.transform="translateY(0)",setTimeout(l,e.duration)},c)},r=(o,l)=>{const c=Math.min(o.dataset.index*(e.delay/2),e.maxDelay/2);setTimeout(()=>{o.style.transition=`all ${e.duration/2}ms cubic-bezier(0.25, 0.46, 0.45, 0.94)`,o.style.opacity="0",o.style.transform="translateY(-20px)",setTimeout(l,e.duration/2)},c)};return(o,l)=>(O(),Wt(Ek,{name:n.value,tag:t.tag,appear:t.appear,onBeforeEnter:s,onEnter:i,onLeave:r,class:"staggered-container"},{default:Ht(()=>[Wp(o.$slots,"default",{},void 0,!0)]),_:3},8,["name","tag","appear"]))}},Cv=gt(cx,[["__scopeId","data-v-88a3020f"]]),ux={class:"modal-header"},dx={class:"header-content"},hx={class:"modal-title"},fx={class:"modal-body"},mx={class:"section"},px={class:"step-description"},gx={class:"section"},_x={class:"meta-grid"},yx={class:"meta-item"},vx={class:"meta-value"},bx={class:"meta-item"},Ex={class:"meta-value"},kx={class:"meta-item"},wx={class:"meta-value"},Ix={key:0,class:"meta-item"},Sx={class:"meta-value"},Tx={key:0,class:"section"},Ax={class:"checkpoints-list"},Rx=["checked","onChange","disabled"],Cx={class:"checkpoint-content"},Px={class:"checkpoint-title"},Dx={key:0,class:"checkpoint-description"},Ox={key:1,class:"section"},Nx={class:"resources-list"},Mx={class:"resource-icon"},xx={class:"resource-content"},Vx={class:"resource-title"},Lx={class:"resource-description"},$x=["href"],Fx={key:2,class:"section"},Ux={class:"tips-list"},Bx={class:"tip-text"},jx={key:3,class:"section"},Hx=["disabled"],qx={key:4,class:"section completion-summary"},Kx={class:"completion-info"},Gx={class:"completion-date"},zx={key:0,class:"completion-notes"},Wx={class:"notes-content"},Qx={class:"modal-footer"},Yx={class:"footer-actions"},Jx=["disabled"],Xx={__name:"StepDetailModal",props:{step:{type:Object,required:!0},isVisible:{type:Boolean,default:!1}},emits:["close","start-step","complete-step","restart-step","skip-step","toggle-checkpoint","save-notes"],setup(t,{emit:e}){const n=t,s=e,i=ge(n.step.notes||"");Pn(()=>n.step.notes,N=>{i.value=N||""});const r=Ie(()=>!n.step.checkpoints||n.step.checkpoints.length===0?!0:n.step.checkpoints.filter(x=>x.isRequired!==!1).every(x=>x.isCompleted)),o=()=>{s("close")},l=()=>{s("start-step",n.step.id),o()},c=()=>{s("complete-step",{stepId:n.step.id,notes:i.value}),o()},u=()=>{s("restart-step",n.step.id),o()},d=()=>{s("skip-step",n.step.id),o()},m=N=>{s("toggle-checkpoint",{stepId:n.step.id,checkpointId:N})},g=()=>{s("save-notes",{stepId:n.step.id,notes:i.value})},y=N=>({pending:"Belum Dimulai",in_progress:"Sedang Dikerjakan",completed:"Selesai",skipped:"Dilewati"})[N]||"Tidak Diketahui",A=N=>({article:"📄",video:"🎥",tool:"🔧",course:"🎓",template:"📋",website:"🌐",book:"📚",guide:"📖"})[N]||"📄",F=N=>N?new Date(N).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"";return(N,x)=>t.isVisible?(O(),M("div",{key:0,class:"modal-overlay",onClick:o},[f("div",{class:"modal-content",onClick:x[1]||(x[1]=ts(()=>{},["stop"]))},[f("div",ux,[f("div",dx,[f("h3",hx,j(t.step.title),1),f("div",{class:Se(["step-status-badge",`status-${t.step.status}`])},j(y(t.step.status)),3)]),f("button",{onClick:o,class:"close-btn"},"×")]),f("div",fx,[f("div",mx,[x[2]||(x[2]=f("h4",{class:"section-title"},"📋 Deskripsi",-1)),f("p",px,j(t.step.description),1)]),f("div",gx,[f("div",_x,[f("div",yx,[x[3]||(x[3]=f("span",{class:"meta-label"},"⏱️ Estimasi Waktu:",-1)),f("span",vx,j(t.step.estimatedDuration||"Tidak ditentukan"),1)]),f("div",bx,[x[4]||(x[4]=f("span",{class:"meta-label"},"📊 Status:",-1)),f("span",Ex,j(y(t.step.status)),1)]),f("div",kx,[x[5]||(x[5]=f("span",{class:"meta-label"},"🎯 Wajib:",-1)),f("span",wx,j(t.step.isRequired?"Ya":"Tidak"),1)]),t.step.startedAt?(O(),M("div",Ix,[x[6]||(x[6]=f("span",{class:"meta-label"},"🚀 Dimulai:",-1)),f("span",Sx,j(F(t.step.startedAt)),1)])):X("",!0)])]),t.step.checkpoints&&t.step.checkpoints.length>0?(O(),M("div",Tx,[x[7]||(x[7]=f("h4",{class:"section-title"},"✅ Checklist",-1)),f("div",Ax,[(O(!0),M(Ae,null,ze(t.step.checkpoints,V=>(O(),M("div",{key:V.id,class:Se(["checkpoint-item",{completed:V.isCompleted}])},[f("input",{type:"checkbox",checked:V.isCompleted,onChange:R=>m(V.id),class:"checkpoint-checkbox",disabled:t.step.status==="completed"},null,40,Rx),f("div",Cx,[f("label",Px,j(V.title),1),V.description?(O(),M("p",Dx,j(V.description),1)):X("",!0)])],2))),128))])])):X("",!0),t.step.resources&&t.step.resources.length>0?(O(),M("div",Ox,[x[8]||(x[8]=f("h4",{class:"section-title"},"📚 Sumber Daya",-1)),f("div",Nx,[(O(!0),M(Ae,null,ze(t.step.resources,V=>(O(),M("div",{key:V.id,class:"resource-item"},[f("div",Mx,j(A(V.type)),1),f("div",xx,[f("h5",Vx,j(V.title),1),f("p",Lx,j(V.description),1),V.url?(O(),M("a",{key:0,href:V.url,target:"_blank",rel:"noopener noreferrer",class:"resource-link"}," 🔗 Buka Resource ",8,$x)):X("",!0)])]))),128))])])):X("",!0),t.step.tips&&t.step.tips.length>0?(O(),M("div",Fx,[x[10]||(x[10]=f("h4",{class:"section-title"},"💡 Tips & Saran",-1)),f("div",Ux,[(O(!0),M(Ae,null,ze(t.step.tips,(V,R)=>(O(),M("div",{key:R,class:"tip-item"},[x[9]||(x[9]=f("span",{class:"tip-icon"},"💡",-1)),f("p",Bx,j(V),1)]))),128))])])):X("",!0),t.step.status==="in_progress"||t.step.status==="completed"?(O(),M("div",jx,[x[11]||(x[11]=f("h4",{class:"section-title"},"📝 Catatan Progress",-1)),nt(f("textarea",{"onUpdate:modelValue":x[0]||(x[0]=V=>i.value=V),placeholder:"Tambahkan catatan tentang progress atau hasil implementasi...",class:"notes-textarea",disabled:t.step.status==="completed"},null,8,Hx),[[qt,i.value]]),t.step.status==="in_progress"?(O(),M("button",{key:0,onClick:g,class:"save-notes-btn"}," 💾 Simpan Catatan ")):X("",!0)])):X("",!0),t.step.status==="completed"?(O(),M("div",qx,[x[14]||(x[14]=f("h4",{class:"section-title"},"🎉 Ringkasan Penyelesaian",-1)),f("div",Kx,[f("div",Gx,[x[12]||(x[12]=f("span",{class:"info-icon"},"📅",-1)),f("span",null,"Diselesaikan pada: "+j(F(t.step.completedAt)),1)]),t.step.notes?(O(),M("div",zx,[x[13]||(x[13]=f("span",{class:"info-icon"},"📝",-1)),f("div",Wx,j(t.step.notes),1)])):X("",!0)])])):X("",!0)]),f("div",Qx,[f("div",Yx,[t.step.status==="pending"?(O(),M("button",{key:0,onClick:l,class:"action-btn primary"}," 🚀 Mulai Langkah ")):X("",!0),t.step.status==="in_progress"?(O(),M("button",{key:1,onClick:c,class:"action-btn success",disabled:!r.value}," ✅ Tandai Selesai ",8,Jx)):X("",!0),t.step.status==="completed"?(O(),M("button",{key:2,onClick:u,class:"action-btn warning"}," 🔄 Mulai Ulang ")):X("",!0),t.step.status==="pending"&&!t.step.isRequired?(O(),M("button",{key:3,onClick:d,class:"action-btn secondary"}," ⏭️ Lewati Langkah ")):X("",!0),f("button",{onClick:o,class:"action-btn secondary"}," Tutup ")])])])])):X("",!0)}},Zx=gt(Xx,[["__scopeId","data-v-859f8ddb"]]),Fd={smooth:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",bounce:"cubic-bezier(0.68, -0.55, 0.265, 1.55)"},Qn={normal:300,slow:500},e2=(t,e=Qn.normal,n=0)=>new Promise(s=>{t.style.opacity="0",t.style.transition=`opacity ${e}ms ${Fd.smooth}`,setTimeout(()=>{t.style.opacity="1",setTimeout(s,e)},n)}),ep=(t,e=Qn.normal,n=0)=>new Promise(s=>{t.style.transform="translateY(20px)",t.style.opacity="0",t.style.transition=`all ${e}ms ${Fd.smooth}`,setTimeout(()=>{t.style.transform="translateY(0)",t.style.opacity="1",setTimeout(s,e)},n)}),t2=(t,e=Qn.normal,n=0)=>new Promise(s=>{t.style.transform="scale(0.9)",t.style.opacity="0",t.style.transition=`all ${e}ms ${Fd.bounce}`,setTimeout(()=>{t.style.transform="scale(1)",t.style.opacity="1",setTimeout(s,e)},n)}),n2=(t,e,n,s=Qn.slow)=>new Promise(i=>{const r=performance.now(),o=n-e,l=c=>{const u=c-r,d=Math.min(u/s,1),m=1-Math.pow(1-d,3),g=Math.round(e+o*m);t.textContent=g,d<1?requestAnimationFrame(l):(t.textContent=n,i())};requestAnimationFrame(l)}),s2=()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches,ma=t=>s2()?Math.min(t,100):t,i2=(t,e={})=>{const n={threshold:.1,rootMargin:"0px 0px -50px 0px",...e};return new IntersectionObserver(s=>{s.forEach(i=>{i.isIntersecting&&t(i.target)})},n)},r2=()=>{const t=i2(e=>{if(e.classList.contains("animate-on-scroll")){const n=e.dataset.animation||"slideUp",s=parseInt(e.dataset.delay)||0;switch(n){case"fadeIn":e2(e,ma(Qn.normal),s);break;case"slideUp":ep(e,ma(Qn.normal),s);break;case"scaleIn":t2(e,ma(Qn.normal),s);break;default:ep(e,ma(Qn.normal),s)}e.classList.remove("animate-on-scroll")}});return document.querySelectorAll(".animate-on-scroll").forEach(e=>{t.observe(e)}),t},o2={class:"recommendation-container"},a2={class:"recommendation-header"},l2={class:"header-content"},c2={class:"quick-stats"},u2={class:"stat-card hover-lift animate-bounce-in"},d2={class:"stat-number"},h2={class:"stat-card hover-lift animate-bounce-in"},f2={class:"stat-number"},m2={class:"stat-card hover-lift animate-bounce-in"},p2={class:"stat-number"},g2={key:0,class:"loading-section"},_2={key:1,class:"skeleton-section"},y2={class:"skeleton-header"},v2={class:"skeleton-content"},b2={key:2,class:"error-section"},E2={class:"error-content"},k2={key:3,class:"recommendation-main"},w2={class:"controls-section"},I2={class:"filters"},S2={class:"filter-group"},T2={class:"filter-group"},A2={class:"filter-group"},R2={class:"filter-group"},C2={class:"actions"},P2=["disabled"],D2={key:0,class:"critical-alert animate-bounce-in animate-glow"},O2={class:"alert-content"},N2={class:"alert-text"},M2={key:1,class:"next-actions-section"},x2={class:"next-actions-grid"},V2={class:"action-header"},L2={class:"action-title"},$2={class:"action-description"},F2={class:"action-meta"},U2={class:"action-time"},B2={key:0,class:"action-deadline"},j2=["onClick"],H2={class:"recommendations-section"},q2={class:"section-header"},K2={class:"sort-controls"},G2={key:0,class:"empty-state"},z2={class:"empty-content"},W2={__name:"RecommendationView",setup(t,{expose:e}){const n=Hl(),s=Ii(),i=jl(),r=or(),o=ge(!1),{recommendations:l,filteredRecommendations:c,criticalRecommendations:u,nextActions:d,progressStats:m,generatingRecommendations:g,error:y,filters:A,sortBy:F,loadingState:N}=qk(n),x=ge(null);Pn(l,B=>{console.log("🔍 DEBUG: Vue component - recommendations changed"),console.log("🔍 DEBUG: New recommendations:",B),console.log("🔍 DEBUG: New recommendations length:",B==null?void 0:B.length),x.value=kv()},{deep:!0,immediate:!0}),Pn(c,B=>{console.log("🔍 DEBUG: Vue component - filteredRecommendations changed"),console.log("🔍 DEBUG: New filtered:",B),console.log("🔍 DEBUG: New filtered length:",B==null?void 0:B.length)},{deep:!0,immediate:!0});const{loadRecommendations:V,completeRecommendation:R,toggleBookmark:D,completeActionItem:P,setFilter:H,setSortBy:k,refreshRecommendations:b,startRecommendation:E,updateRecommendationProgress:S,restartRecommendation:C,skipRecommendation:w,startProgressStep:_,completeProgressStep:Te,skipProgressStep:ae,toggleStepCheckpoint:Ce,saveStepNotes:_e}=n,le=Ie(()=>s.user),Vt=async()=>{console.log("🔄 Retrying recommendation generation..."),n.error=null,le.value&&(await V(le.value.uid),(!l.value||l.value.length===0)&&await Q())},Yt=async B=>{console.log("🚀 Starting recommendation from UI:",B),await E(B.id,B)},Gt=async B=>{console.log("📊 Updating progress from UI:",B),await S(B.id,B)},We=async B=>{console.log("✅ Completing recommendation from UI:",B),await R(B.id,B)},Qe=async B=>{console.log("🔄 Restarting recommendation from UI:",B),await C(B.id,B)},kn=async B=>{console.log("⏭️ Skipping recommendation from UI:",B),await w(B.id,B)},Tt=ge(null),ut=ge(!1),G=async B=>{console.log("🚀 Starting step from UI:",B),await _(B.recommendationId,B.stepId)},ie=async B=>{console.log("✅ Completing step from UI:",B),await Te(B.recommendationId,B.stepId,B.notes)},ne=async B=>{console.log("⏭️ Skipping step from UI:",B),await ae(B.recommendationId,B.stepId)},ce=async B=>{console.log("📋 Toggling checkpoint from UI:",B),await Ce(B.recommendationId,B.stepId,B.checkpointId)},Oe=B=>{console.log("👁️ Showing step details:",B),Tt.value=B.step,ut.value=!0},I=()=>{ut.value=!1,Tt.value=null},T=async B=>{console.log("📝 Saving step notes:",B),await _e(Tt.value.recommendationId,B.stepId,B.notes)},$=B=>({critical:"Kritis",high:"Tinggi",medium:"Sedang",low:"Rendah"})[B]||"Sedang",z=B=>new Date(B).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),Q=async()=>{console.log("🔄 Force generating recommendations..."),i.loadDiagnosisData();const B={userId:le.value.uid,businessName:le.value.namaUsaha||le.value.displayName||"Bisnis Saya",businessCategory:le.value.businessCategory||"services",businessStage:i.currentStage||le.value.businessStage||"existence",employeeCount:le.value.employeeCount||1,monthlyRevenue:le.value.monthlyRevenue||0,businessAge:le.value.businessAge||1,location:le.value.location||"Indonesia",challenges:le.value.challenges||[],goals:le.value.goals||[]},L={currentStage:i.currentStage||"existence",answers:i.currentAnswers||{},strengths:[],weaknesses:[],opportunities:[]};try{await n.generateRecommendations(B,L),console.log("✅ Force generation completed")}catch(oe){console.error("❌ Force generation failed:",oe)}},W=()=>({loading:"📥 Memuat Data",analyzing:"🔍 Menganalisis Bisnis",generating:"🤖 Menghasilkan Rekomendasi AI",saving:"💾 Menyimpan Hasil",complete:"✅ Selesai!"})[N.value.phase]||"🔄 Memproses...",te=ge(null),Z=()=>{te.value=r2(),document.querySelectorAll(".stat-number").forEach((oe,K)=>{const re=parseInt(oe.textContent)||0;setTimeout(()=>{n2(oe,0,re,Qn.slow)},K*200)}),document.querySelectorAll(".stat-card, .section-header, .action-card").forEach((oe,K)=>{oe.classList.add("animate-on-scroll"),oe.dataset.animation="slideUp",oe.dataset.delay=(K*100).toString()})};return En(async()=>{var B,L,oe,K;try{if(console.log("🔍 DEBUG: onMounted started"),!le.value){console.log("🔍 DEBUG: User not authenticated, redirecting to login"),r.push("/login");return}console.log("🔍 DEBUG: User authenticated:",le.value.uid),console.log("🔍 DEBUG: Loading diagnosis data..."),i.loadDiagnosisData(),console.log("🔍 DEBUG: After loading diagnosis, currentStage:",i.currentStage),console.log("🔍 DEBUG: After loading diagnosis, isCompleted:",i.isCompleted),console.log("🔍 DEBUG: Loading recommendations for user:",le.value.uid),await V(le.value.uid),console.log("🔍 DEBUG: After loading, recommendations.value:",l.value),console.log("🔍 DEBUG: After loading, recommendations.value.length:",(B=l.value)==null?void 0:B.length),console.log("🔍 DEBUG: Checking if should generate recommendations"),console.log("🔍 DEBUG: recommendations.value:",l.value),console.log("🔍 DEBUG: recommendations.value.length:",(L=l.value)==null?void 0:L.length),console.log("🔍 DEBUG: diagnosisStore.currentStage:",i.currentStage),console.log("🔍 DEBUG: diagnosisStore.isCompleted:",i.isCompleted);const re=(!l.value||l.value.length===0)&&(i.isCompleted||!0);if(console.log("🔍 DEBUG: shouldGenerate:",re),re){console.log("🔍 DEBUG: Generating new recommendations...");const pe={userId:le.value.uid,businessName:le.value.namaUsaha||le.value.displayName||"Bisnis Saya",businessCategory:le.value.businessCategory||"services",businessStage:i.currentStage||le.value.businessStage||"existence",employeeCount:le.value.employeeCount||1,monthlyRevenue:le.value.monthlyRevenue||0,businessAge:le.value.businessAge||1,location:le.value.location||"Indonesia",challenges:le.value.challenges||[],goals:le.value.goals||[]};console.log("🔍 DEBUG: Created business profile:",pe);const fe={currentStage:i.currentStage||"growth",answers:i.answers||{},strengths:[],weaknesses:[],opportunities:[]};try{console.log("🔍 DEBUG: Calling generateRecommendations with:",pe),console.log("🔍 DEBUG: diagnosisData:",fe);const ve=await n.generateRecommendations(pe,fe);console.log("🔍 DEBUG: generateRecommendations returned:",ve),console.log("🔍 DEBUG: After generateRecommendations, recommendations.value:",l.value),console.log("🔍 DEBUG: After generateRecommendations, recommendations.value.length:",(oe=l.value)==null?void 0:oe.length)}catch(ve){console.error("❌ Failed to generate recommendations:",ve),console.error("❌ Error details:",ve.message),console.error("❌ Error stack:",ve.stack)}}else console.log("🔍 DEBUG: Not generating recommendations - already have:",(K=l.value)==null?void 0:K.length,"recommendations");r.currentRoute.value.query.generate==="true"&&(console.log("🔍 DEBUG: Route query parameter detected, forcing generation..."),await Q()),setTimeout(()=>{Z()},100)}catch(re){console.error("❌ Critical error in onMounted:",re),console.error("❌ Error message:",re.message),console.error("❌ Error stack:",re.stack)}}),So(()=>{te.value&&te.value.disconnect()}),e({forceGenerateRecommendations:Q}),(B,L)=>{const oe=fl("router-link");return O(),M("div",o2,[f("div",a2,[f("div",l2,[L[14]||(L[14]=f("div",{class:"header-text"},[f("h1",{class:"page-title"},"🤖 Rekomendasi AI untuk Bisnis Anda"),f("p",{class:"page-subtitle"}," Rekomendasi yang dipersonalisasi berdasarkan analisis tahap bisnis dan profil UMKM Anda ")],-1)),f("div",c2,[f("div",u2,[f("div",d2,j(de(m).total),1),L[11]||(L[11]=f("div",{class:"stat-label"},"Total Rekomendasi",-1))]),f("div",h2,[f("div",f2,j(de(m).completed),1),L[12]||(L[12]=f("div",{class:"stat-label"},"Selesai",-1))]),f("div",m2,[f("div",p2,j(de(m).completionRate)+"%",1),L[13]||(L[13]=f("div",{class:"stat-label"},"Progress",-1))])])])]),de(N).isLoading||de(g)?(O(),M("div",g2,[xe(lx,{type:"progress",title:W(),message:de(N).message||"Mohon tunggu sebentar...",progress:de(N).progress,"show-progress":!0,steps:de(N).steps,"current-step":de(N).currentStep},null,8,["title","message","progress","steps","current-step"])])):o.value&&!de(l).length?(O(),M("div",_2,[f("div",y2,[xe(pu,{type:"stats"})]),f("div",v2,[(O(),M(Ae,null,ze(3,K=>xe(pu,{key:K,type:"card",animate:!0})),64))])])):de(y)?(O(),M("div",b2,[f("div",E2,[L[15]||(L[15]=f("div",{class:"error-icon"},"⚠️",-1)),L[16]||(L[16]=f("h3",null,"Terjadi Kesalahan",-1)),f("p",null,j(de(y)),1),f("button",{onClick:Vt,class:"retry-btn"}," Coba Lagi ")])])):(O(),M("div",k2,[f("div",w2,[f("div",I2,[f("div",S2,[L[18]||(L[18]=f("label",{for:"category-filter"},"Kategori:",-1)),nt(f("select",{id:"category-filter","onUpdate:modelValue":L[0]||(L[0]=K=>de(A).category=K),onChange:L[1]||(L[1]=K=>de(H)("category",K.target.value)),class:"filter-select"},L[17]||(L[17]=[An('<option value="all" data-v-149e7abb>Semua Kategori</option><option value="financial_management" data-v-149e7abb>Manajemen Keuangan</option><option value="marketing_sales" data-v-149e7abb>Marketing &amp; Penjualan</option><option value="operations" data-v-149e7abb>Operasional</option><option value="human_resources" data-v-149e7abb>SDM</option><option value="technology" data-v-149e7abb>Teknologi</option><option value="growth_strategy" data-v-149e7abb>Strategi Pertumbuhan</option><option value="financial_literacy" data-v-149e7abb>Literasi Keuangan</option>',8)]),544),[[ei,de(A).category]])]),f("div",T2,[L[20]||(L[20]=f("label",{for:"priority-filter"},"Prioritas:",-1)),nt(f("select",{id:"priority-filter","onUpdate:modelValue":L[2]||(L[2]=K=>de(A).priority=K),onChange:L[3]||(L[3]=K=>de(H)("priority",K.target.value)),class:"filter-select"},L[19]||(L[19]=[An('<option value="all" data-v-149e7abb>Semua Prioritas</option><option value="critical" data-v-149e7abb>Kritis</option><option value="high" data-v-149e7abb>Tinggi</option><option value="medium" data-v-149e7abb>Sedang</option><option value="low" data-v-149e7abb>Rendah</option>',5)]),544),[[ei,de(A).priority]])]),f("div",A2,[L[22]||(L[22]=f("label",{for:"status-filter"},"Status:",-1)),nt(f("select",{id:"status-filter","onUpdate:modelValue":L[4]||(L[4]=K=>de(A).completed=K),onChange:L[5]||(L[5]=K=>de(H)("completed",K.target.value)),class:"filter-select"},L[21]||(L[21]=[f("option",{value:"all"},"Semua Status",-1),f("option",{value:"pending"},"Belum Selesai",-1),f("option",{value:"completed"},"Selesai",-1)]),544),[[ei,de(A).completed]])]),f("div",R2,[L[24]||(L[24]=f("label",{for:"bookmark-filter"},"Bookmark:",-1)),nt(f("select",{id:"bookmark-filter","onUpdate:modelValue":L[6]||(L[6]=K=>de(A).bookmarked=K),onChange:L[7]||(L[7]=K=>de(H)("bookmarked",K.target.value)),class:"filter-select"},L[23]||(L[23]=[f("option",{value:"all"},"Semua",-1),f("option",{value:"bookmarked"},"Tersimpan",-1),f("option",{value:"not_bookmarked"},"Belum Disimpan",-1)]),544),[[ei,de(A).bookmarked]])])]),f("div",C2,[f("button",{onClick:L[8]||(L[8]=(...K)=>de(b)&&de(b)(...K)),class:"refresh-btn",disabled:o.value}," 🔄 Perbarui Rekomendasi ",8,P2)])]),de(u).length>0?(O(),M("div",D2,[f("div",O2,[L[26]||(L[26]=f("div",{class:"alert-icon animate-pulse"},"🚨",-1)),f("div",N2,[f("h4",null,"Perhatian: "+j(de(u).length)+" Rekomendasi Kritis",1),L[25]||(L[25]=f("p",null,"Ada rekomendasi dengan prioritas kritis yang memerlukan perhatian segera.",-1))])])])):X("",!0),de(d).length>0?(O(),M("div",M2,[L[27]||(L[27]=f("h3",{class:"section-title"},"🎯 Aksi Selanjutnya",-1)),f("div",x2,[(O(!0),M(Ae,null,ze(de(d),K=>(O(),M("div",{key:K.id,class:Se(["action-card",`priority-${K.priority}`])},[f("div",V2,[f("h4",L2,j(K.title),1),f("span",{class:Se(["priority-badge",`priority-${K.priority}`])},j($(K.priority)),3)]),f("p",$2,j(K.description),1),f("div",F2,[f("span",U2,"⏱️ "+j(K.estimatedHours)+"h",1),K.deadline?(O(),M("span",B2," 📅 "+j(z(K.deadline)),1)):X("",!0)]),f("button",{onClick:re=>de(P)(K.recommendationId,K.id),class:"complete-action-btn"}," ✅ Tandai Selesai ",8,j2)],2))),128))])])):X("",!0),f("div",H2,[f("div",q2,[L[30]||(L[30]=f("h3",{class:"section-title"},"📋 Semua Rekomendasi",-1)),f("div",K2,[L[29]||(L[29]=f("label",{for:"sort-select"},"Urutkan:",-1)),nt(f("select",{id:"sort-select","onUpdate:modelValue":L[9]||(L[9]=K=>Xe(F)?F.value=K:null),onChange:L[10]||(L[10]=K=>de(k)(K.target.value)),class:"sort-select"},L[28]||(L[28]=[f("option",{value:"priority"},"Prioritas",-1),f("option",{value:"date"},"Tanggal",-1),f("option",{value:"category"},"Kategori",-1)]),544),[[ei,de(F)]])])]),de(c).length===0?(O(),M("div",G2,[f("div",z2,[L[32]||(L[32]=f("div",{class:"empty-icon"},"📝",-1)),L[33]||(L[33]=f("h3",null,"Belum Ada Rekomendasi",-1)),L[34]||(L[34]=f("p",null,"Selesaikan diagnosis bisnis terlebih dahulu untuk mendapatkan rekomendasi yang dipersonalisasi.",-1)),xe(oe,{to:"/diagnosis",class:"cta-btn"},{default:Ht(()=>L[31]||(L[31]=[Be(" 📊 Mulai Diagnosis ")])),_:1,__:[31]})])])):(O(),Wt(Cv,{key:1,name:"stagger-scale",tag:"div",class:"recommendations-grid",delay:100,appear:!0},{default:Ht(()=>[(O(!0),M(Ae,null,ze(de(c),(K,re)=>(O(),Wt(FM,{key:K.id,"data-index":re,recommendation:K,class:"recommendation-card-animated hover-lift",onComplete:We,onToggleBookmark:de(D),onCompleteAction:de(P),onStartRecommendation:Yt,onUpdateProgress:Gt,onRestartRecommendation:Qe,onSkipRecommendation:kn,onStartStep:G,onCompleteStep:ie,onSkipStep:ne,onToggleCheckpoint:ce,onShowStepDetails:Oe},null,8,["data-index","recommendation","onToggleBookmark","onCompleteAction"]))),128))]),_:1}))])])),Tt.value?(O(),Wt(Zx,{key:4,step:Tt.value,"is-visible":ut.value,onClose:I,onStartStep:G,onCompleteStep:ie,onRestartStep:G,onSkipStep:ne,onToggleCheckpoint:ce,onSaveNotes:T},null,8,["step","is-visible"])):X("",!0)])}}},Q2=gt(W2,[["__scopeId","data-v-149e7abb"]]),Y2={class:"bookmark-dashboard"},J2={class:"dashboard-header"},X2={class:"bookmark-stats"},Z2={class:"stat-item"},eV={class:"stat-number"},tV={class:"stat-item"},nV={class:"stat-number"},sV={class:"stat-item"},iV={class:"stat-number"},rV={class:"collection-tabs"},oV=["onClick"],aV={class:"tab-name"},lV={class:"tab-count"},cV={class:"tab-count"},uV={class:"collection-management"},dV={key:0,class:"empty-state"},hV={class:"empty-content"},fV={key:0},mV={key:1},pV={key:1,class:"bookmarked-recommendations"},gV=["data-index"],_V={class:"bookmark-header"},yV={class:"bookmark-meta"},vV={class:"bookmark-date"},bV={class:"recommendation-content"},EV={class:"content-header"},kV={class:"recommendation-title"},wV={class:"recommendation-description"},IV={class:"recommendation-status"},SV={key:0,class:"progress-info"},TV={class:"progress-bar"},AV={class:"progress-text"},RV={class:"bookmark-actions"},CV=["onClick"],PV={class:"modal-header"},DV={class:"modal-body"},OV={class:"form-group"},NV={class:"form-group"},MV={class:"form-group"},xV={class:"icon-selector"},VV=["onClick"],LV={class:"modal-footer"},$V={class:"modal-header"},FV={class:"modal-body"},UV={class:"modal-footer"},BV={__name:"BookmarkDashboard",setup(t){const e=Hl(),n=or(),s=ge("all"),i=ge(!1),r=ge(!1),o=ge(""),l=ge(""),c=ge("📁"),u=["📁","⭐","🚨","📅","💡","🎯","📈","💰","🔧","📊"],d=Ie(()=>e.bookmarkCollections),m=Ie(()=>e.bookmarkStats),g=Ie(()=>e.recommendationsByCollection),y=Ie(()=>m.value.recentlyBookmarked),A=Ie(()=>{if(s.value==="all")return e.bookmarkedRecommendations;const w=g.value[s.value];return w?w.recommendations:[]}),F=w=>m.value.byCollection[w]||0,N=w=>{const _=d.value.find(Te=>Te.id===w);return _?_.name:"Favorit Saya"},x=w=>{const _=d.value.find(Te=>Te.id===w);return _?_.icon:"⭐"},V=w=>{const _=d.value.find(Te=>Te.id===w);return _?_.color:"#fbbf24"},R=w=>({critical:"Kritis",high:"Tinggi",medium:"Sedang",low:"Rendah"})[w]||"Sedang",D=w=>({[Dt.PENDING]:"Belum Dimulai",[Dt.IN_PROGRESS]:"Sedang Dikerjakan",[Dt.COMPLETED]:"Selesai",[Dt.SKIPPED]:"Dilewati"})[w]||"Belum Dimulai",P=w=>w?new Date(w).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"",H=()=>{o.value.trim()&&(e.createBookmarkCollection(o.value.trim(),l.value.trim()||"Koleksi kustom",c.value),o.value="",l.value="",c.value="📁",i.value=!1)},k=()=>{e.deleteBookmarkCollection(s.value),s.value="all",r.value=!1},b=async w=>{await e.startRecommendation(w.id,{startedAt:new Date().toISOString()}),n.push(`/recommendations?highlight=${w.id}`)},E=w=>{console.log("Bookmark toggled:",w)},S=w=>{console.log("Collection changed:",w)},C=w=>{console.log("Bookmark removed:",w)};return En(()=>{console.log("📚 Bookmark Dashboard mounted")}),(w,_)=>{const Te=fl("router-link");return O(),M("div",Y2,[f("div",J2,[_[16]||(_[16]=f("div",{class:"header-content"},[f("h2",{class:"dashboard-title"},"📚 Rekomendasi Tersimpan"),f("p",{class:"dashboard-subtitle"}," Kelola dan akses rekomendasi favorit Anda ")],-1)),f("div",X2,[f("div",Z2,[f("span",eV,j(m.value.total),1),_[13]||(_[13]=f("span",{class:"stat-label"},"Total Tersimpan",-1))]),f("div",tV,[f("span",nV,j(d.value.length),1),_[14]||(_[14]=f("span",{class:"stat-label"},"Koleksi",-1))]),f("div",sV,[f("span",iV,j(y.value.length),1),_[15]||(_[15]=f("span",{class:"stat-label"},"Baru Ditambah",-1))])])]),f("div",rV,[(O(!0),M(Ae,null,ze(d.value,ae=>(O(),M("button",{key:ae.id,onClick:Ce=>s.value=ae.id,class:Se(["collection-tab",{active:s.value===ae.id}])},[f("span",{class:"tab-icon",style:fn({color:ae.color})},j(ae.icon),5),f("span",aV,j(ae.name),1),f("span",lV,j(F(ae.id)),1)],10,oV))),128)),f("button",{onClick:_[0]||(_[0]=ae=>s.value="all"),class:Se(["collection-tab",{active:s.value==="all"}])},[_[17]||(_[17]=f("span",{class:"tab-icon"},"📋",-1)),_[18]||(_[18]=f("span",{class:"tab-name"},"Semua",-1)),f("span",cV,j(m.value.total),1)],2)]),f("div",uV,[f("button",{onClick:_[1]||(_[1]=ae=>i.value=!0),class:"create-collection-btn hover-lift"},_[19]||(_[19]=[f("span",{class:"btn-icon"},"➕",-1),Be(" Buat Koleksi Baru ")])),s.value!=="all"&&s.value!=="default"?(O(),M("button",{key:0,onClick:_[2]||(_[2]=ae=>r.value=!0),class:"delete-collection-btn hover-lift"},_[20]||(_[20]=[f("span",{class:"btn-icon"},"🗑️",-1),Be(" Hapus Koleksi ")]))):X("",!0)]),A.value.length===0?(O(),M("div",dV,[f("div",hV,[_[22]||(_[22]=f("div",{class:"empty-icon"},"📌",-1)),_[23]||(_[23]=f("h3",null,"Belum Ada Rekomendasi Tersimpan",-1)),s.value==="all"?(O(),M("p",fV," Mulai simpan rekomendasi yang berguna untuk bisnis Anda ")):(O(),M("p",mV,' Koleksi "'+j(N(s.value))+'" masih kosong ',1)),xe(Te,{to:"/recommendations",class:"cta-btn"},{default:Ht(()=>_[21]||(_[21]=[Be(" 📋 Lihat Semua Rekomendasi ")])),_:1,__:[21]})])])):(O(),M("div",pV,[xe(Cv,{name:"stagger-scale",tag:"div",class:"recommendations-grid",delay:100,appear:!0},{default:Ht(()=>[(O(!0),M(Ae,null,ze(A.value,(ae,Ce)=>(O(),M("div",{key:ae.id,"data-index":Ce,class:"bookmark-card hover-lift"},[f("div",_V,[f("div",yV,[f("span",{class:"collection-badge",style:fn({backgroundColor:V(ae.bookmarkCollection)})},j(x(ae.bookmarkCollection))+" "+j(N(ae.bookmarkCollection)),5),f("span",vV,j(P(ae.bookmarkedAt)),1)]),xe(Rv,{recommendation:ae,onBookmarkToggled:E,onCollectionChanged:S,onBookmarkRemoved:C},null,8,["recommendation"])]),f("div",bV,[f("div",EV,[f("h3",kV,j(ae.title),1),f("span",{class:Se(["priority-badge",`priority-${ae.priority}`])},j(R(ae.priority)),3)]),f("p",wV,j(ae.description),1),f("div",IV,[f("div",{class:Se(["status-badge",`status-${ae.status||"pending"}`])},j(D(ae.status||"pending")),3),ae.progress>0?(O(),M("div",SV,[f("div",TV,[f("div",{class:"progress-fill",style:fn({width:`${ae.progress}%`})},null,4)]),f("span",AV,j(ae.progress)+"%",1)])):X("",!0)])]),f("div",RV,[xe(Te,{to:`/recommendations?highlight=${ae.id}`,class:"action-btn primary"},{default:Ht(()=>_[24]||(_[24]=[f("span",{class:"btn-icon"},"👁️",-1),Be(" Lihat Detail ")])),_:2,__:[24]},1032,["to"]),ae.isCompleted?X("",!0):(O(),M("button",{key:0,onClick:_e=>b(ae),class:"action-btn secondary"},_[25]||(_[25]=[f("span",{class:"btn-icon"},"🚀",-1),Be(" Mulai ")]),8,CV))])],8,gV))),128))]),_:1})])),i.value?(O(),M("div",{key:2,class:"modal-overlay",onClick:_[8]||(_[8]=ae=>i.value=!1)},[f("div",{class:"modal-content",onClick:_[7]||(_[7]=ts(()=>{},["stop"]))},[f("div",PV,[_[26]||(_[26]=f("h3",null,"Buat Koleksi Baru",-1)),f("button",{onClick:_[3]||(_[3]=ae=>i.value=!1),class:"close-btn"},"×")]),f("div",DV,[f("div",OV,[_[27]||(_[27]=f("label",{for:"collection-name"},"Nama Koleksi:",-1)),nt(f("input",{id:"collection-name","onUpdate:modelValue":_[4]||(_[4]=ae=>o.value=ae),placeholder:"Masukkan nama koleksi...",class:"form-input",onKeyup:Ag(H,["enter"])},null,544),[[qt,o.value]])]),f("div",NV,[_[28]||(_[28]=f("label",{for:"collection-description"},"Deskripsi (opsional):",-1)),nt(f("textarea",{id:"collection-description","onUpdate:modelValue":_[5]||(_[5]=ae=>l.value=ae),placeholder:"Deskripsi koleksi...",class:"form-textarea"},null,512),[[qt,l.value]])]),f("div",MV,[_[29]||(_[29]=f("label",null,"Icon:",-1)),f("div",xV,[(O(),M(Ae,null,ze(u,ae=>f("button",{key:ae,onClick:Ce=>c.value=ae,class:Se(["icon-btn",{active:c.value===ae}])},j(ae),11,VV)),64))])])]),f("div",LV,[f("button",{onClick:_[6]||(_[6]=ae=>i.value=!1),class:"btn-secondary"},"Batal"),f("button",{onClick:H,class:"btn-primary"},"Buat Koleksi")])])])):X("",!0),r.value?(O(),M("div",{key:3,class:"modal-overlay",onClick:_[12]||(_[12]=ae=>r.value=!1)},[f("div",{class:"modal-content",onClick:_[11]||(_[11]=ts(()=>{},["stop"]))},[f("div",$V,[_[30]||(_[30]=f("h3",null,"Hapus Koleksi",-1)),f("button",{onClick:_[9]||(_[9]=ae=>r.value=!1),class:"close-btn"},"×")]),f("div",FV,[f("p",null,'Yakin ingin menghapus koleksi "'+j(N(s.value))+'"?',1),_[31]||(_[31]=f("p",{class:"warning-text"},' Semua rekomendasi dalam koleksi ini akan dipindah ke "Favorit Saya". ',-1))]),f("div",UV,[f("button",{onClick:_[10]||(_[10]=ae=>r.value=!1),class:"btn-secondary"},"Batal"),f("button",{onClick:k,class:"btn-danger"},"Hapus Koleksi")])])])):X("",!0)])}}},jV=gt(BV,[["__scopeId","data-v-c5027f06"]]),HV={class:"bookmark-view"},qV={__name:"BookmarkView",setup(t){const e=Hl(),n=Ii();return En(async()=>{console.log("📚 Bookmark View mounted"),n.user&&e.recommendations.length===0&&await e.loadRecommendations(n.user.uid)}),(s,i)=>(O(),M("div",HV,[xe(jV)]))}},KV=gt(qV,[["__scopeId","data-v-733a624f"]]),GV={};function zV(t,e){return O(),M("div",null,e[0]||(e[0]=[f("h1",null,"404 - Halaman tidak ditemukan",-1)]))}const WV=gt(GV,[["render",zV]]),QV=[{path:"/",name:"Dashboard",component:CP,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:tD},{path:"/register",name:"Register",component:nD},{path:"/diagnosis",name:"Diagnosis",component:MD,meta:{requiresAuth:!0}},{path:"/recommendations",name:"Recommendations",component:Q2,meta:{requiresAuth:!0}},{path:"/bookmarks",name:"Bookmarks",component:KV,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",name:"NotFound",component:WV}],Ud=Kw({history:Ew("/"),routes:QV});Ud.beforeEach((t,e,n)=>{const i=Ii().isLoggedIn;console.log(`Navigating to: ${t.path}, Requires Auth: ${t.meta.requiresAuth}, Is Authenticated: ${i}`),t.meta.requiresAuth&&!i?(console.log("Redirecting to /login"),n("/login")):n()});const Bd=xk(VI),YV=$k();Bd.use(YV);const Pv=Ii(),JV=jl();Pv.initializeAuth();JV.loadDiagnosisData();Bd.use(Ud);Ud.beforeEach((t,e,n)=>{const s=Pv.isLoggedIn,i=t.meta.requiresAuth;console.log(`🚀 Navigating to: ${t.path}`),console.log(`🔐 Requires Auth: ${i}`),console.log(`👤 Is Authenticated: ${s}`),i&&!s?(console.log("🔄 Redirecting to /login"),n("/login")):s&&(t.path==="/login"||t.path==="/register")?(console.log("🔄 Redirecting to dashboard"),n("/")):n()});Bd.mount("#app");Gi(()=>import("./systemTesting-DhZrMPu9.js"),[]).then(()=>{console.log("🧪 System testing utilities loaded"),console.log("💡 Run runSystemTests() to check system health"),console.log("🔧 Use Ctrl+Shift+D to toggle error monitor")}),Gi(()=>import("./firestoreErrorTesting-C0-abLWR.js"),[]).then(()=>{console.log("🔥 Firestore error testing utilities loaded"),console.log("💡 Run runFirestoreErrorTests() to test error resolution")});console.log("🎉 SiNaik PWA initialized successfully!");export{j1 as a,Hl as b,Sv as c,q1 as t,no as u};
